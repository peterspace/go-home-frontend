import{r as sb,g as fd,c as yr,e as dd,_ as ob}from"./index-7f456532.js";import{t as ab,e as $r,N as ou}from"./tslib.es6-0961a7d0.js";var au={},Bo={},Le={},pd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function t(f,g){var E=f>>>16&65535,I=f&65535,N=g>>>16&65535,j=g&65535;return I*j+(E*j+I*N<<16>>>0)|0}n.mul=Math.imul||t;function r(f,g){return f+g|0}n.add=r;function s(f,g){return f-g|0}n.sub=s;function a(f,g){return f<<g|f>>>32-g}n.rotl=a;function l(f,g){return f<<32-g|f>>>g}n.rotr=l;function p(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}n.isInteger=Number.isInteger||p,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(f){return n.isInteger(f)&&f>=-n.MAX_SAFE_INTEGER&&f<=n.MAX_SAFE_INTEGER}})(pd);Object.defineProperty(Le,"__esModule",{value:!0});var gd=pd;function cb(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])<<16>>16}Le.readInt16BE=cb;function ub(n,t){return t===void 0&&(t=0),(n[t+0]<<8|n[t+1])>>>0}Le.readUint16BE=ub;function hb(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])<<16>>16}Le.readInt16LE=hb;function lb(n,t){return t===void 0&&(t=0),(n[t+1]<<8|n[t])>>>0}Le.readUint16LE=lb;function vd(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>8,t[r+1]=n>>>0,t}Le.writeUint16BE=vd;Le.writeInt16BE=vd;function yd(n,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t}Le.writeUint16LE=yd;Le.writeInt16LE=yd;function zc(n,t){return t===void 0&&(t=0),n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]}Le.readInt32BE=zc;function Hc(n,t){return t===void 0&&(t=0),(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0}Le.readUint32BE=Hc;function Kc(n,t){return t===void 0&&(t=0),n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]}Le.readInt32LE=Kc;function kc(n,t){return t===void 0&&(t=0),(n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t])>>>0}Le.readUint32LE=kc;function No(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>24,t[r+1]=n>>>16,t[r+2]=n>>>8,t[r+3]=n>>>0,t}Le.writeUint32BE=No;Le.writeInt32BE=No;function Ro(n,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=n>>>0,t[r+1]=n>>>8,t[r+2]=n>>>16,t[r+3]=n>>>24,t}Le.writeUint32LE=Ro;Le.writeInt32LE=Ro;function fb(n,t){t===void 0&&(t=0);var r=zc(n,t),s=zc(n,t+4);return r*4294967296+s-(s>>31)*4294967296}Le.readInt64BE=fb;function db(n,t){t===void 0&&(t=0);var r=Hc(n,t),s=Hc(n,t+4);return r*4294967296+s}Le.readUint64BE=db;function pb(n,t){t===void 0&&(t=0);var r=Kc(n,t),s=Kc(n,t+4);return s*4294967296+r-(r>>31)*4294967296}Le.readInt64LE=pb;function gb(n,t){t===void 0&&(t=0);var r=kc(n,t),s=kc(n,t+4);return s*4294967296+r}Le.readUint64LE=gb;function _d(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),No(n/4294967296>>>0,t,r),No(n>>>0,t,r+4),t}Le.writeUint64BE=_d;Le.writeInt64BE=_d;function bd(n,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Ro(n>>>0,t,r),Ro(n/4294967296>>>0,t,r+4),t}Le.writeUint64LE=bd;Le.writeInt64LE=bd;function vb(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,a=1,l=n/8+r-1;l>=r;l--)s+=t[l]*a,a*=256;return s}Le.readUintBE=vb;function yb(n,t,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,a=1,l=r;l<r+n/8;l++)s+=t[l]*a,a*=256;return s}Le.readUintLE=yb;function _b(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!gd.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var a=1,l=n/8+s-1;l>=s;l--)r[l]=t/a&255,a*=256;return r}Le.writeUintBE=_b;function bb(n,t,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!gd.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var a=1,l=s;l<s+n/8;l++)r[l]=t/a&255,a*=256;return r}Le.writeUintLE=bb;function mb(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t)}Le.readFloat32BE=mb;function wb(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(t,!0)}Le.readFloat32LE=wb;function Eb(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t)}Le.readFloat64BE=Eb;function Db(n,t){t===void 0&&(t=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(t,!0)}Le.readFloat64LE=Db;function Sb(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n),t}Le.writeFloat32BE=Sb;function Ib(n,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat32(r,n,!0),t}Le.writeFloat32LE=Ib;function xb(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n),t}Le.writeFloat64BE=xb;function Ob(n,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(t.buffer,t.byteOffset,t.byteLength);return s.setFloat64(r,n,!0),t}Le.writeFloat64LE=Ob;var Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});function Cb(n){for(var t=0;t<n.length;t++)n[t]=0;return n}Ir.wipe=Cb;Object.defineProperty(Bo,"__esModule",{value:!0});var Qt=Le,Vc=Ir,Ab=20;function Pb(n,t,r){for(var s=1634760805,a=857760878,l=2036477234,p=1797285236,f=r[3]<<24|r[2]<<16|r[1]<<8|r[0],g=r[7]<<24|r[6]<<16|r[5]<<8|r[4],E=r[11]<<24|r[10]<<16|r[9]<<8|r[8],I=r[15]<<24|r[14]<<16|r[13]<<8|r[12],N=r[19]<<24|r[18]<<16|r[17]<<8|r[16],j=r[23]<<24|r[22]<<16|r[21]<<8|r[20],R=r[27]<<24|r[26]<<16|r[25]<<8|r[24],T=r[31]<<24|r[30]<<16|r[29]<<8|r[28],z=t[3]<<24|t[2]<<16|t[1]<<8|t[0],K=t[7]<<24|t[6]<<16|t[5]<<8|t[4],se=t[11]<<24|t[10]<<16|t[9]<<8|t[8],P=t[15]<<24|t[14]<<16|t[13]<<8|t[12],L=s,D=a,C=l,m=p,c=f,_=g,G=E,W=I,ne=N,ce=j,de=R,b=T,x=z,ee=K,X=se,k=P,V=0;V<Ab;V+=2)L=L+c|0,x^=L,x=x>>>32-16|x<<16,ne=ne+x|0,c^=ne,c=c>>>32-12|c<<12,D=D+_|0,ee^=D,ee=ee>>>32-16|ee<<16,ce=ce+ee|0,_^=ce,_=_>>>32-12|_<<12,C=C+G|0,X^=C,X=X>>>32-16|X<<16,de=de+X|0,G^=de,G=G>>>32-12|G<<12,m=m+W|0,k^=m,k=k>>>32-16|k<<16,b=b+k|0,W^=b,W=W>>>32-12|W<<12,C=C+G|0,X^=C,X=X>>>32-8|X<<8,de=de+X|0,G^=de,G=G>>>32-7|G<<7,m=m+W|0,k^=m,k=k>>>32-8|k<<8,b=b+k|0,W^=b,W=W>>>32-7|W<<7,D=D+_|0,ee^=D,ee=ee>>>32-8|ee<<8,ce=ce+ee|0,_^=ce,_=_>>>32-7|_<<7,L=L+c|0,x^=L,x=x>>>32-8|x<<8,ne=ne+x|0,c^=ne,c=c>>>32-7|c<<7,L=L+_|0,k^=L,k=k>>>32-16|k<<16,de=de+k|0,_^=de,_=_>>>32-12|_<<12,D=D+G|0,x^=D,x=x>>>32-16|x<<16,b=b+x|0,G^=b,G=G>>>32-12|G<<12,C=C+W|0,ee^=C,ee=ee>>>32-16|ee<<16,ne=ne+ee|0,W^=ne,W=W>>>32-12|W<<12,m=m+c|0,X^=m,X=X>>>32-16|X<<16,ce=ce+X|0,c^=ce,c=c>>>32-12|c<<12,C=C+W|0,ee^=C,ee=ee>>>32-8|ee<<8,ne=ne+ee|0,W^=ne,W=W>>>32-7|W<<7,m=m+c|0,X^=m,X=X>>>32-8|X<<8,ce=ce+X|0,c^=ce,c=c>>>32-7|c<<7,D=D+G|0,x^=D,x=x>>>32-8|x<<8,b=b+x|0,G^=b,G=G>>>32-7|G<<7,L=L+_|0,k^=L,k=k>>>32-8|k<<8,de=de+k|0,_^=de,_=_>>>32-7|_<<7;Qt.writeUint32LE(L+s|0,n,0),Qt.writeUint32LE(D+a|0,n,4),Qt.writeUint32LE(C+l|0,n,8),Qt.writeUint32LE(m+p|0,n,12),Qt.writeUint32LE(c+f|0,n,16),Qt.writeUint32LE(_+g|0,n,20),Qt.writeUint32LE(G+E|0,n,24),Qt.writeUint32LE(W+I|0,n,28),Qt.writeUint32LE(ne+N|0,n,32),Qt.writeUint32LE(ce+j|0,n,36),Qt.writeUint32LE(de+R|0,n,40),Qt.writeUint32LE(b+T|0,n,44),Qt.writeUint32LE(x+z|0,n,48),Qt.writeUint32LE(ee+K|0,n,52),Qt.writeUint32LE(X+se|0,n,56),Qt.writeUint32LE(k+P|0,n,60)}function md(n,t,r,s,a){if(a===void 0&&(a=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var l,p;if(a===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");l=new Uint8Array(16),p=l.length-t.length,l.set(t,p)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");l=t,p=a}for(var f=new Uint8Array(64),g=0;g<r.length;g+=64){Pb(f,l,n);for(var E=g;E<g+64&&E<r.length;E++)s[E]=r[E]^f[E-g];Nb(l,0,p)}return Vc.wipe(f),a===0&&Vc.wipe(l),s}Bo.streamXOR=md;function Tb(n,t,r,s){return s===void 0&&(s=0),Vc.wipe(r),md(n,t,r,r,s)}Bo.stream=Tb;function Nb(n,t,r){for(var s=1;r--;)s=s+(n[t]&255)|0,n[t]=s&255,s>>>=8,t++;if(s>0)throw new Error("ChaCha: counter overflow")}var wd={},Ri={};Object.defineProperty(Ri,"__esModule",{value:!0});function Rb(n,t,r){return~(n-1)&t|n-1&r}Ri.select=Rb;function Fb(n,t){return(n|0)-(t|0)-1>>>31&1}Ri.lessOrEqual=Fb;function Ed(n,t){if(n.length!==t.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^t[s];return 1&r-1>>>8}Ri.compare=Ed;function Ub(n,t){return n.length===0||t.length===0?!1:Ed(n,t)!==0}Ri.equal=Ub;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Ri,r=Ir;n.DIGEST_LENGTH=16;var s=function(){function p(f){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var g=f[0]|f[1]<<8;this._r[0]=g&8191;var E=f[2]|f[3]<<8;this._r[1]=(g>>>13|E<<3)&8191;var I=f[4]|f[5]<<8;this._r[2]=(E>>>10|I<<6)&7939;var N=f[6]|f[7]<<8;this._r[3]=(I>>>7|N<<9)&8191;var j=f[8]|f[9]<<8;this._r[4]=(N>>>4|j<<12)&255,this._r[5]=j>>>1&8190;var R=f[10]|f[11]<<8;this._r[6]=(j>>>14|R<<2)&8191;var T=f[12]|f[13]<<8;this._r[7]=(R>>>11|T<<5)&8065;var z=f[14]|f[15]<<8;this._r[8]=(T>>>8|z<<8)&8191,this._r[9]=z>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return p.prototype._blocks=function(f,g,E){for(var I=this._fin?0:2048,N=this._h[0],j=this._h[1],R=this._h[2],T=this._h[3],z=this._h[4],K=this._h[5],se=this._h[6],P=this._h[7],L=this._h[8],D=this._h[9],C=this._r[0],m=this._r[1],c=this._r[2],_=this._r[3],G=this._r[4],W=this._r[5],ne=this._r[6],ce=this._r[7],de=this._r[8],b=this._r[9];E>=16;){var x=f[g+0]|f[g+1]<<8;N+=x&8191;var ee=f[g+2]|f[g+3]<<8;j+=(x>>>13|ee<<3)&8191;var X=f[g+4]|f[g+5]<<8;R+=(ee>>>10|X<<6)&8191;var k=f[g+6]|f[g+7]<<8;T+=(X>>>7|k<<9)&8191;var V=f[g+8]|f[g+9]<<8;z+=(k>>>4|V<<12)&8191,K+=V>>>1&8191;var J=f[g+10]|f[g+11]<<8;se+=(V>>>14|J<<2)&8191;var re=f[g+12]|f[g+13]<<8;P+=(J>>>11|re<<5)&8191;var me=f[g+14]|f[g+15]<<8;L+=(re>>>8|me<<8)&8191,D+=me>>>5|I;var oe=0,we=oe;we+=N*C,we+=j*(5*b),we+=R*(5*de),we+=T*(5*ce),we+=z*(5*ne),oe=we>>>13,we&=8191,we+=K*(5*W),we+=se*(5*G),we+=P*(5*_),we+=L*(5*c),we+=D*(5*m),oe+=we>>>13,we&=8191;var le=oe;le+=N*m,le+=j*C,le+=R*(5*b),le+=T*(5*de),le+=z*(5*ce),oe=le>>>13,le&=8191,le+=K*(5*ne),le+=se*(5*W),le+=P*(5*G),le+=L*(5*_),le+=D*(5*c),oe+=le>>>13,le&=8191;var _e=oe;_e+=N*c,_e+=j*m,_e+=R*C,_e+=T*(5*b),_e+=z*(5*de),oe=_e>>>13,_e&=8191,_e+=K*(5*ce),_e+=se*(5*ne),_e+=P*(5*W),_e+=L*(5*G),_e+=D*(5*_),oe+=_e>>>13,_e&=8191;var q=oe;q+=N*_,q+=j*c,q+=R*m,q+=T*C,q+=z*(5*b),oe=q>>>13,q&=8191,q+=K*(5*de),q+=se*(5*ce),q+=P*(5*ne),q+=L*(5*W),q+=D*(5*G),oe+=q>>>13,q&=8191;var B=oe;B+=N*G,B+=j*_,B+=R*c,B+=T*m,B+=z*C,oe=B>>>13,B&=8191,B+=K*(5*b),B+=se*(5*de),B+=P*(5*ce),B+=L*(5*ne),B+=D*(5*W),oe+=B>>>13,B&=8191;var F=oe;F+=N*W,F+=j*G,F+=R*_,F+=T*c,F+=z*m,oe=F>>>13,F&=8191,F+=K*C,F+=se*(5*b),F+=P*(5*de),F+=L*(5*ce),F+=D*(5*ne),oe+=F>>>13,F&=8191;var h=oe;h+=N*ne,h+=j*W,h+=R*G,h+=T*_,h+=z*c,oe=h>>>13,h&=8191,h+=K*m,h+=se*C,h+=P*(5*b),h+=L*(5*de),h+=D*(5*ce),oe+=h>>>13,h&=8191;var O=oe;O+=N*ce,O+=j*ne,O+=R*W,O+=T*G,O+=z*_,oe=O>>>13,O&=8191,O+=K*c,O+=se*m,O+=P*C,O+=L*(5*b),O+=D*(5*de),oe+=O>>>13,O&=8191;var ae=oe;ae+=N*de,ae+=j*ce,ae+=R*ne,ae+=T*W,ae+=z*G,oe=ae>>>13,ae&=8191,ae+=K*_,ae+=se*c,ae+=P*m,ae+=L*C,ae+=D*(5*b),oe+=ae>>>13,ae&=8191;var fe=oe;fe+=N*b,fe+=j*de,fe+=R*ce,fe+=T*ne,fe+=z*W,oe=fe>>>13,fe&=8191,fe+=K*G,fe+=se*_,fe+=P*c,fe+=L*m,fe+=D*C,oe+=fe>>>13,fe&=8191,oe=(oe<<2)+oe|0,oe=oe+we|0,we=oe&8191,oe=oe>>>13,le+=oe,N=we,j=le,R=_e,T=q,z=B,K=F,se=h,P=O,L=ae,D=fe,g+=16,E-=16}this._h[0]=N,this._h[1]=j,this._h[2]=R,this._h[3]=T,this._h[4]=z,this._h[5]=K,this._h[6]=se,this._h[7]=P,this._h[8]=L,this._h[9]=D},p.prototype.finish=function(f,g){g===void 0&&(g=0);var E=new Uint16Array(10),I,N,j,R;if(this._leftover){for(R=this._leftover,this._buffer[R++]=1;R<16;R++)this._buffer[R]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(I=this._h[1]>>>13,this._h[1]&=8191,R=2;R<10;R++)this._h[R]+=I,I=this._h[R]>>>13,this._h[R]&=8191;for(this._h[0]+=I*5,I=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=I,I=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=I,E[0]=this._h[0]+5,I=E[0]>>>13,E[0]&=8191,R=1;R<10;R++)E[R]=this._h[R]+I,I=E[R]>>>13,E[R]&=8191;for(E[9]-=8192,N=(I^1)-1,R=0;R<10;R++)E[R]&=N;for(N=~N,R=0;R<10;R++)this._h[R]=this._h[R]&N|E[R];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,j=this._h[0]+this._pad[0],this._h[0]=j&65535,R=1;R<8;R++)j=(this._h[R]+this._pad[R]|0)+(j>>>16)|0,this._h[R]=j&65535;return f[g+0]=this._h[0]>>>0,f[g+1]=this._h[0]>>>8,f[g+2]=this._h[1]>>>0,f[g+3]=this._h[1]>>>8,f[g+4]=this._h[2]>>>0,f[g+5]=this._h[2]>>>8,f[g+6]=this._h[3]>>>0,f[g+7]=this._h[3]>>>8,f[g+8]=this._h[4]>>>0,f[g+9]=this._h[4]>>>8,f[g+10]=this._h[5]>>>0,f[g+11]=this._h[5]>>>8,f[g+12]=this._h[6]>>>0,f[g+13]=this._h[6]>>>8,f[g+14]=this._h[7]>>>0,f[g+15]=this._h[7]>>>8,this._finished=!0,this},p.prototype.update=function(f){var g=0,E=f.length,I;if(this._leftover){I=16-this._leftover,I>E&&(I=E);for(var N=0;N<I;N++)this._buffer[this._leftover+N]=f[g+N];if(E-=I,g+=I,this._leftover+=I,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(E>=16&&(I=E-E%16,this._blocks(f,g,I),g+=I,E-=I),E){for(var N=0;N<E;N++)this._buffer[this._leftover+N]=f[g+N];this._leftover+=E}return this},p.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},p.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},p}();n.Poly1305=s;function a(p,f){var g=new s(p);g.update(f);var E=g.digest();return g.clean(),E}n.oneTimeAuth=a;function l(p,f){return p.length!==n.DIGEST_LENGTH||f.length!==n.DIGEST_LENGTH?!1:t.equal(p,f)}n.equal=l})(wd);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Bo,r=wd,s=Ir,a=Le,l=Ri;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var p=new Uint8Array(16),f=function(){function g(E){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,E.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(E)}return g.prototype.seal=function(E,I,N,j){if(E.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var R=new Uint8Array(16);R.set(E,R.length-E.length);var T=new Uint8Array(32);t.stream(this._key,R,T,4);var z=I.length+this.tagLength,K;if(j){if(j.length!==z)throw new Error("ChaCha20Poly1305: incorrect destination length");K=j}else K=new Uint8Array(z);return t.streamXOR(this._key,R,I,K,4),this._authenticate(K.subarray(K.length-this.tagLength,K.length),T,K.subarray(0,K.length-this.tagLength),N),s.wipe(R),K},g.prototype.open=function(E,I,N,j){if(E.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(I.length<this.tagLength)return null;var R=new Uint8Array(16);R.set(E,R.length-E.length);var T=new Uint8Array(32);t.stream(this._key,R,T,4);var z=new Uint8Array(this.tagLength);if(this._authenticate(z,T,I.subarray(0,I.length-this.tagLength),N),!l.equal(z,I.subarray(I.length-this.tagLength,I.length)))return null;var K=I.length-this.tagLength,se;if(j){if(j.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");se=j}else se=new Uint8Array(K);return t.streamXOR(this._key,R,I.subarray(0,I.length-this.tagLength),se,4),s.wipe(R),se},g.prototype.clean=function(){return s.wipe(this._key),this},g.prototype._authenticate=function(E,I,N,j){var R=new r.Poly1305(I);j&&(R.update(j),j.length%16>0&&R.update(p.subarray(j.length%16))),R.update(N),N.length%16>0&&R.update(p.subarray(N.length%16));var T=new Uint8Array(8);j&&a.writeUint64LE(j.length,T),R.update(T),a.writeUint64LE(N.length,T),R.update(T);for(var z=R.digest(),K=0;K<z.length;K++)E[K]=z[K];R.clean(),s.wipe(z),s.wipe(T)},g}();n.ChaCha20Poly1305=f})(au);var Dd={},vs={},cu={};Object.defineProperty(cu,"__esModule",{value:!0});function Lb(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}cu.isSerializableHash=Lb;Object.defineProperty(vs,"__esModule",{value:!0});var ei=cu,Mb=Ri,$b=Ir,Sd=function(){function n(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var a=0;a<s.length;a++)s[a]^=54;this._inner.update(s);for(var a=0;a<s.length;a++)s[a]^=106;this._outer.update(s),ei.isSerializableHash(this._inner)&&ei.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),$b.wipe(s)}return n.prototype.reset=function(){if(!ei.isSerializableHash(this._inner)||!ei.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){ei.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ei.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(t){return this._inner.update(t),this},n.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},n.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},n.prototype.saveState=function(){if(!ei.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(t){if(!ei.isSerializableHash(this._inner)||!ei.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(t){if(!ei.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},n}();vs.HMAC=Sd;function jb(n,t,r){var s=new Sd(n,t);s.update(r);var a=s.digest();return s.clean(),a}vs.hmac=jb;vs.equal=Mb.equal;Object.defineProperty(Dd,"__esModule",{value:!0});var Pl=vs,Tl=Ir,Bb=function(){function n(t,r,s,a){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=a;var l=Pl.hmac(this._hash,s,r);this._hmac=new Pl.HMAC(t,l),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(t){for(var r=new Uint8Array(t),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),Tl.wipe(this._buffer),Tl.wipe(this._counter),this._bufpos=0},n}(),qb=Dd.HKDF=Bb,Tn={},qo={},zo={};Object.defineProperty(zo,"__esModule",{value:!0});zo.BrowserRandomSource=void 0;const Nl=65536;class zb{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let s=0;s<r.length;s+=Nl)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,Nl)));return r}}zo.BrowserRandomSource=zb;function Hb(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ho={};Object.defineProperty(Ho,"__esModule",{value:!0});Ho.NodeRandomSource=void 0;const Kb=Ir;class kb{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Hb<"u"){const t=sb;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(t);for(let a=0;a<s.length;a++)s[a]=r[a];return(0,Kb.wipe)(r),s}}Ho.NodeRandomSource=kb;Object.defineProperty(qo,"__esModule",{value:!0});qo.SystemRandomSource=void 0;const Vb=zo,Gb=Ho;class Wb{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Vb.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Gb.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}qo.SystemRandomSource=Wb;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const t=qo,r=Le,s=Ir;n.defaultRandomSource=new t.SystemRandomSource;function a(E,I=n.defaultRandomSource){return I.randomBytes(E)}n.randomBytes=a;function l(E=n.defaultRandomSource){const I=a(4,E),N=(0,r.readUint32LE)(I);return(0,s.wipe)(I),N}n.randomUint32=l;const p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(E,I=p,N=n.defaultRandomSource){if(I.length<2)throw new Error("randomString charset is too short");if(I.length>256)throw new Error("randomString charset is too long");let j="";const R=I.length,T=256-256%R;for(;E>0;){const z=a(Math.ceil(E*256/T),N);for(let K=0;K<z.length&&E>0;K++){const se=z[K];se<T&&(j+=I.charAt(se%R),E--)}(0,s.wipe)(z)}return j}n.randomString=f;function g(E,I=p,N=n.defaultRandomSource){const j=Math.ceil(E/(Math.log(I.length)/Math.LN2));return f(j,I,N)}n.randomStringForEntropy=g})(Tn);var Ko={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Le,r=Ir;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},f.prototype.update=function(g,E){if(E===void 0&&(E=g.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var I=0;if(this._bytesHashed+=E,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&E>0;)this._buffer[this._bufferLength++]=g[I++],E--;this._bufferLength===this.blockSize&&(l(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(E>=this.blockSize&&(I=l(this._temp,this._state,g,I,E),E%=this.blockSize);E>0;)this._buffer[this._bufferLength++]=g[I++],E--;return this},f.prototype.finish=function(g){if(!this._finished){var E=this._bytesHashed,I=this._bufferLength,N=E/536870912|0,j=E<<3,R=E%64<56?64:128;this._buffer[I]=128;for(var T=I+1;T<R-8;T++)this._buffer[T]=0;t.writeUint32BE(N,this._buffer,R-8),t.writeUint32BE(j,this._buffer,R-4),l(this._temp,this._state,this._buffer,0,R),this._finished=!0}for(var T=0;T<this.digestLength/4;T++)t.writeUint32BE(this._state[T],g,T*4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._state.set(g.state),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){r.wipe(g.state),g.buffer&&r.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();n.SHA256=s;var a=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function l(f,g,E,I,N){for(;N>=64;){for(var j=g[0],R=g[1],T=g[2],z=g[3],K=g[4],se=g[5],P=g[6],L=g[7],D=0;D<16;D++){var C=I+D*4;f[D]=t.readUint32BE(E,C)}for(var D=16;D<64;D++){var m=f[D-2],c=(m>>>17|m<<32-17)^(m>>>19|m<<32-19)^m>>>10;m=f[D-15];var _=(m>>>7|m<<32-7)^(m>>>18|m<<32-18)^m>>>3;f[D]=(c+f[D-7]|0)+(_+f[D-16]|0)}for(var D=0;D<64;D++){var c=(((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(K&se^~K&P)|0)+(L+(a[D]+f[D]|0)|0)|0,_=((j>>>2|j<<32-2)^(j>>>13|j<<32-13)^(j>>>22|j<<32-22))+(j&R^j&T^R&T)|0;L=P,P=se,se=K,K=z+c|0,z=T,T=R,R=j,j=c+_|0}g[0]+=j,g[1]+=R,g[2]+=T,g[3]+=z,g[4]+=K,g[5]+=se,g[6]+=P,g[7]+=L,I+=64,N-=64}return I}function p(f){var g=new s;g.update(f);var E=g.digest();return g.clean(),E}n.hash=p})(Ko);var uu={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const t=Tn,r=Ir;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(D){const C=new Float64Array(16);if(D)for(let m=0;m<D.length;m++)C[m]=D[m];return C}const a=new Uint8Array(32);a[0]=9;const l=s([56129,1]);function p(D){let C=1;for(let m=0;m<16;m++){let c=D[m]+C+65535;C=Math.floor(c/65536),D[m]=c-C*65536}D[0]+=C-1+37*(C-1)}function f(D,C,m){const c=~(m-1);for(let _=0;_<16;_++){const G=c&(D[_]^C[_]);D[_]^=G,C[_]^=G}}function g(D,C){const m=s(),c=s();for(let _=0;_<16;_++)c[_]=C[_];p(c),p(c),p(c);for(let _=0;_<2;_++){m[0]=c[0]-65517;for(let W=1;W<15;W++)m[W]=c[W]-65535-(m[W-1]>>16&1),m[W-1]&=65535;m[15]=c[15]-32767-(m[14]>>16&1);const G=m[15]>>16&1;m[14]&=65535,f(c,m,1-G)}for(let _=0;_<16;_++)D[2*_]=c[_]&255,D[2*_+1]=c[_]>>8}function E(D,C){for(let m=0;m<16;m++)D[m]=C[2*m]+(C[2*m+1]<<8);D[15]&=32767}function I(D,C,m){for(let c=0;c<16;c++)D[c]=C[c]+m[c]}function N(D,C,m){for(let c=0;c<16;c++)D[c]=C[c]-m[c]}function j(D,C,m){let c,_,G=0,W=0,ne=0,ce=0,de=0,b=0,x=0,ee=0,X=0,k=0,V=0,J=0,re=0,me=0,oe=0,we=0,le=0,_e=0,q=0,B=0,F=0,h=0,O=0,ae=0,fe=0,Ie=0,ze=0,ke=0,Me=0,pt=0,gt=0,je=m[0],xe=m[1],Re=m[2],Fe=m[3],Be=m[4],Ce=m[5],Ue=m[6],Se=m[7],Ae=m[8],He=m[9],Oe=m[10],Ve=m[11],We=m[12],et=m[13],tt=m[14],Je=m[15];c=C[0],G+=c*je,W+=c*xe,ne+=c*Re,ce+=c*Fe,de+=c*Be,b+=c*Ce,x+=c*Ue,ee+=c*Se,X+=c*Ae,k+=c*He,V+=c*Oe,J+=c*Ve,re+=c*We,me+=c*et,oe+=c*tt,we+=c*Je,c=C[1],W+=c*je,ne+=c*xe,ce+=c*Re,de+=c*Fe,b+=c*Be,x+=c*Ce,ee+=c*Ue,X+=c*Se,k+=c*Ae,V+=c*He,J+=c*Oe,re+=c*Ve,me+=c*We,oe+=c*et,we+=c*tt,le+=c*Je,c=C[2],ne+=c*je,ce+=c*xe,de+=c*Re,b+=c*Fe,x+=c*Be,ee+=c*Ce,X+=c*Ue,k+=c*Se,V+=c*Ae,J+=c*He,re+=c*Oe,me+=c*Ve,oe+=c*We,we+=c*et,le+=c*tt,_e+=c*Je,c=C[3],ce+=c*je,de+=c*xe,b+=c*Re,x+=c*Fe,ee+=c*Be,X+=c*Ce,k+=c*Ue,V+=c*Se,J+=c*Ae,re+=c*He,me+=c*Oe,oe+=c*Ve,we+=c*We,le+=c*et,_e+=c*tt,q+=c*Je,c=C[4],de+=c*je,b+=c*xe,x+=c*Re,ee+=c*Fe,X+=c*Be,k+=c*Ce,V+=c*Ue,J+=c*Se,re+=c*Ae,me+=c*He,oe+=c*Oe,we+=c*Ve,le+=c*We,_e+=c*et,q+=c*tt,B+=c*Je,c=C[5],b+=c*je,x+=c*xe,ee+=c*Re,X+=c*Fe,k+=c*Be,V+=c*Ce,J+=c*Ue,re+=c*Se,me+=c*Ae,oe+=c*He,we+=c*Oe,le+=c*Ve,_e+=c*We,q+=c*et,B+=c*tt,F+=c*Je,c=C[6],x+=c*je,ee+=c*xe,X+=c*Re,k+=c*Fe,V+=c*Be,J+=c*Ce,re+=c*Ue,me+=c*Se,oe+=c*Ae,we+=c*He,le+=c*Oe,_e+=c*Ve,q+=c*We,B+=c*et,F+=c*tt,h+=c*Je,c=C[7],ee+=c*je,X+=c*xe,k+=c*Re,V+=c*Fe,J+=c*Be,re+=c*Ce,me+=c*Ue,oe+=c*Se,we+=c*Ae,le+=c*He,_e+=c*Oe,q+=c*Ve,B+=c*We,F+=c*et,h+=c*tt,O+=c*Je,c=C[8],X+=c*je,k+=c*xe,V+=c*Re,J+=c*Fe,re+=c*Be,me+=c*Ce,oe+=c*Ue,we+=c*Se,le+=c*Ae,_e+=c*He,q+=c*Oe,B+=c*Ve,F+=c*We,h+=c*et,O+=c*tt,ae+=c*Je,c=C[9],k+=c*je,V+=c*xe,J+=c*Re,re+=c*Fe,me+=c*Be,oe+=c*Ce,we+=c*Ue,le+=c*Se,_e+=c*Ae,q+=c*He,B+=c*Oe,F+=c*Ve,h+=c*We,O+=c*et,ae+=c*tt,fe+=c*Je,c=C[10],V+=c*je,J+=c*xe,re+=c*Re,me+=c*Fe,oe+=c*Be,we+=c*Ce,le+=c*Ue,_e+=c*Se,q+=c*Ae,B+=c*He,F+=c*Oe,h+=c*Ve,O+=c*We,ae+=c*et,fe+=c*tt,Ie+=c*Je,c=C[11],J+=c*je,re+=c*xe,me+=c*Re,oe+=c*Fe,we+=c*Be,le+=c*Ce,_e+=c*Ue,q+=c*Se,B+=c*Ae,F+=c*He,h+=c*Oe,O+=c*Ve,ae+=c*We,fe+=c*et,Ie+=c*tt,ze+=c*Je,c=C[12],re+=c*je,me+=c*xe,oe+=c*Re,we+=c*Fe,le+=c*Be,_e+=c*Ce,q+=c*Ue,B+=c*Se,F+=c*Ae,h+=c*He,O+=c*Oe,ae+=c*Ve,fe+=c*We,Ie+=c*et,ze+=c*tt,ke+=c*Je,c=C[13],me+=c*je,oe+=c*xe,we+=c*Re,le+=c*Fe,_e+=c*Be,q+=c*Ce,B+=c*Ue,F+=c*Se,h+=c*Ae,O+=c*He,ae+=c*Oe,fe+=c*Ve,Ie+=c*We,ze+=c*et,ke+=c*tt,Me+=c*Je,c=C[14],oe+=c*je,we+=c*xe,le+=c*Re,_e+=c*Fe,q+=c*Be,B+=c*Ce,F+=c*Ue,h+=c*Se,O+=c*Ae,ae+=c*He,fe+=c*Oe,Ie+=c*Ve,ze+=c*We,ke+=c*et,Me+=c*tt,pt+=c*Je,c=C[15],we+=c*je,le+=c*xe,_e+=c*Re,q+=c*Fe,B+=c*Be,F+=c*Ce,h+=c*Ue,O+=c*Se,ae+=c*Ae,fe+=c*He,Ie+=c*Oe,ze+=c*Ve,ke+=c*We,Me+=c*et,pt+=c*tt,gt+=c*Je,G+=38*le,W+=38*_e,ne+=38*q,ce+=38*B,de+=38*F,b+=38*h,x+=38*O,ee+=38*ae,X+=38*fe,k+=38*Ie,V+=38*ze,J+=38*ke,re+=38*Me,me+=38*pt,oe+=38*gt,_=1,c=G+_+65535,_=Math.floor(c/65536),G=c-_*65536,c=W+_+65535,_=Math.floor(c/65536),W=c-_*65536,c=ne+_+65535,_=Math.floor(c/65536),ne=c-_*65536,c=ce+_+65535,_=Math.floor(c/65536),ce=c-_*65536,c=de+_+65535,_=Math.floor(c/65536),de=c-_*65536,c=b+_+65535,_=Math.floor(c/65536),b=c-_*65536,c=x+_+65535,_=Math.floor(c/65536),x=c-_*65536,c=ee+_+65535,_=Math.floor(c/65536),ee=c-_*65536,c=X+_+65535,_=Math.floor(c/65536),X=c-_*65536,c=k+_+65535,_=Math.floor(c/65536),k=c-_*65536,c=V+_+65535,_=Math.floor(c/65536),V=c-_*65536,c=J+_+65535,_=Math.floor(c/65536),J=c-_*65536,c=re+_+65535,_=Math.floor(c/65536),re=c-_*65536,c=me+_+65535,_=Math.floor(c/65536),me=c-_*65536,c=oe+_+65535,_=Math.floor(c/65536),oe=c-_*65536,c=we+_+65535,_=Math.floor(c/65536),we=c-_*65536,G+=_-1+37*(_-1),_=1,c=G+_+65535,_=Math.floor(c/65536),G=c-_*65536,c=W+_+65535,_=Math.floor(c/65536),W=c-_*65536,c=ne+_+65535,_=Math.floor(c/65536),ne=c-_*65536,c=ce+_+65535,_=Math.floor(c/65536),ce=c-_*65536,c=de+_+65535,_=Math.floor(c/65536),de=c-_*65536,c=b+_+65535,_=Math.floor(c/65536),b=c-_*65536,c=x+_+65535,_=Math.floor(c/65536),x=c-_*65536,c=ee+_+65535,_=Math.floor(c/65536),ee=c-_*65536,c=X+_+65535,_=Math.floor(c/65536),X=c-_*65536,c=k+_+65535,_=Math.floor(c/65536),k=c-_*65536,c=V+_+65535,_=Math.floor(c/65536),V=c-_*65536,c=J+_+65535,_=Math.floor(c/65536),J=c-_*65536,c=re+_+65535,_=Math.floor(c/65536),re=c-_*65536,c=me+_+65535,_=Math.floor(c/65536),me=c-_*65536,c=oe+_+65535,_=Math.floor(c/65536),oe=c-_*65536,c=we+_+65535,_=Math.floor(c/65536),we=c-_*65536,G+=_-1+37*(_-1),D[0]=G,D[1]=W,D[2]=ne,D[3]=ce,D[4]=de,D[5]=b,D[6]=x,D[7]=ee,D[8]=X,D[9]=k,D[10]=V,D[11]=J,D[12]=re,D[13]=me,D[14]=oe,D[15]=we}function R(D,C){j(D,C,C)}function T(D,C){const m=s();for(let c=0;c<16;c++)m[c]=C[c];for(let c=253;c>=0;c--)R(m,m),c!==2&&c!==4&&j(m,m,C);for(let c=0;c<16;c++)D[c]=m[c]}function z(D,C){const m=new Uint8Array(32),c=new Float64Array(80),_=s(),G=s(),W=s(),ne=s(),ce=s(),de=s();for(let X=0;X<31;X++)m[X]=D[X];m[31]=D[31]&127|64,m[0]&=248,E(c,C);for(let X=0;X<16;X++)G[X]=c[X];_[0]=ne[0]=1;for(let X=254;X>=0;--X){const k=m[X>>>3]>>>(X&7)&1;f(_,G,k),f(W,ne,k),I(ce,_,W),N(_,_,W),I(W,G,ne),N(G,G,ne),R(ne,ce),R(de,_),j(_,W,_),j(W,G,ce),I(ce,_,W),N(_,_,W),R(G,_),N(W,ne,de),j(_,W,l),I(_,_,ne),j(W,W,_),j(_,ne,de),j(ne,G,c),R(G,ce),f(_,G,k),f(W,ne,k)}for(let X=0;X<16;X++)c[X+16]=_[X],c[X+32]=W[X],c[X+48]=G[X],c[X+64]=ne[X];const b=c.subarray(32),x=c.subarray(16);T(b,b),j(x,x,b);const ee=new Uint8Array(32);return g(ee,x),ee}n.scalarMult=z;function K(D){return z(D,a)}n.scalarMultBase=K;function se(D){if(D.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const C=new Uint8Array(D);return{publicKey:K(C),secretKey:C}}n.generateKeyPairFromSeed=se;function P(D){const C=(0,t.randomBytes)(32,D),m=se(C);return(0,r.wipe)(C),m}n.generateKeyPair=P;function L(D,C,m=!1){if(D.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(C.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=z(D,C);if(m){let _=0;for(let G=0;G<c.length;G++)_|=c[G];if(_===0)throw new Error("X25519: invalid shared key")}return c}n.sharedKey=L})(uu);function hu(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Id(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?hu(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Gc(n,t){t||(t=n.reduce((a,l)=>a+l.length,0));const r=Id(t);let s=0;for(const a of n)r.set(a,s),s+=a.length;return hu(r)}function Yb(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var l=n.charAt(a),p=l.charCodeAt(0);if(r[p]!==255)throw new TypeError(l+" is ambiguous");r[p]=a}var f=n.length,g=n.charAt(0),E=Math.log(f)/Math.log(256),I=Math.log(256)/Math.log(f);function N(T){if(T instanceof Uint8Array||(ArrayBuffer.isView(T)?T=new Uint8Array(T.buffer,T.byteOffset,T.byteLength):Array.isArray(T)&&(T=Uint8Array.from(T))),!(T instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(T.length===0)return"";for(var z=0,K=0,se=0,P=T.length;se!==P&&T[se]===0;)se++,z++;for(var L=(P-se)*I+1>>>0,D=new Uint8Array(L);se!==P;){for(var C=T[se],m=0,c=L-1;(C!==0||m<K)&&c!==-1;c--,m++)C+=256*D[c]>>>0,D[c]=C%f>>>0,C=C/f>>>0;if(C!==0)throw new Error("Non-zero carry");K=m,se++}for(var _=L-K;_!==L&&D[_]===0;)_++;for(var G=g.repeat(z);_<L;++_)G+=n.charAt(D[_]);return G}function j(T){if(typeof T!="string")throw new TypeError("Expected String");if(T.length===0)return new Uint8Array;var z=0;if(T[z]!==" "){for(var K=0,se=0;T[z]===g;)K++,z++;for(var P=(T.length-z)*E+1>>>0,L=new Uint8Array(P);T[z];){var D=r[T.charCodeAt(z)];if(D===255)return;for(var C=0,m=P-1;(D!==0||C<se)&&m!==-1;m--,C++)D+=f*L[m]>>>0,L[m]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");se=C,z++}if(T[z]!==" "){for(var c=P-se;c!==P&&L[c]===0;)c++;for(var _=new Uint8Array(K+(P-c)),G=K;c!==P;)_[G++]=L[c++];return _}}}function R(T){var z=j(T);if(z)return z;throw new Error(`Non-${t} character`)}return{encode:N,decodeUnsafe:j,decode:R}}var Jb=Yb,Xb=Jb;const Zb=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},Qb=n=>new TextEncoder().encode(n),em=n=>new TextDecoder().decode(n);class tm{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class rm{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return xd(this,t)}}class im{constructor(t){this.decoders=t}or(t){return xd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const xd=(n,t)=>new im({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class nm{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new tm(t,r,s),this.decoder=new rm(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const ko=({name:n,prefix:t,encode:r,decode:s})=>new nm(n,t,r,s),ys=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=Xb(r,t);return ko({prefix:n,name:t,encode:s,decode:l=>Zb(a(l))})},sm=(n,t,r,s)=>{const a={};for(let I=0;I<t.length;++I)a[t[I]]=I;let l=n.length;for(;n[l-1]==="=";)--l;const p=new Uint8Array(l*r/8|0);let f=0,g=0,E=0;for(let I=0;I<l;++I){const N=a[n[I]];if(N===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<r|N,f+=r,f>=8&&(f-=8,p[E++]=255&g>>f)}if(f>=r||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return p},om=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let l="",p=0,f=0;for(let g=0;g<n.length;++g)for(f=f<<8|n[g],p+=8;p>r;)p-=r,l+=t[a&f>>p];if(p&&(l+=t[a&f<<r-p]),s)for(;l.length*r&7;)l+="=";return l},Yt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>ko({prefix:t,name:n,encode(a){return om(a,s,r)},decode(a){return sm(a,s,r,n)}}),am=ko({prefix:"\0",name:"identity",encode:n=>em(n),decode:n=>Qb(n)}),cm=Object.freeze(Object.defineProperty({__proto__:null,identity:am},Symbol.toStringTag,{value:"Module"})),um=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),hm=Object.freeze(Object.defineProperty({__proto__:null,base2:um},Symbol.toStringTag,{value:"Module"})),lm=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),fm=Object.freeze(Object.defineProperty({__proto__:null,base8:lm},Symbol.toStringTag,{value:"Module"})),dm=ys({prefix:"9",name:"base10",alphabet:"0123456789"}),pm=Object.freeze(Object.defineProperty({__proto__:null,base10:dm},Symbol.toStringTag,{value:"Module"})),gm=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),vm=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ym=Object.freeze(Object.defineProperty({__proto__:null,base16:gm,base16upper:vm},Symbol.toStringTag,{value:"Module"})),_m=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bm=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),mm=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),wm=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Em=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Dm=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Sm=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Im=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),xm=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Om=Object.freeze(Object.defineProperty({__proto__:null,base32:_m,base32hex:Em,base32hexpad:Sm,base32hexpadupper:Im,base32hexupper:Dm,base32pad:mm,base32padupper:wm,base32upper:bm,base32z:xm},Symbol.toStringTag,{value:"Module"})),Cm=ys({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Am=ys({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Pm=Object.freeze(Object.defineProperty({__proto__:null,base36:Cm,base36upper:Am},Symbol.toStringTag,{value:"Module"})),Tm=ys({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Nm=ys({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Rm=Object.freeze(Object.defineProperty({__proto__:null,base58btc:Tm,base58flickr:Nm},Symbol.toStringTag,{value:"Module"})),Fm=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Um=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Lm=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Mm=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),$m=Object.freeze(Object.defineProperty({__proto__:null,base64:Fm,base64pad:Um,base64url:Lm,base64urlpad:Mm},Symbol.toStringTag,{value:"Module"})),Od=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),jm=Od.reduce((n,t,r)=>(n[r]=t,n),[]),Bm=Od.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function qm(n){return n.reduce((t,r)=>(t+=jm[r],t),"")}function zm(n){const t=[];for(const r of n){const s=Bm[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const Hm=ko({prefix:"🚀",name:"base256emoji",encode:qm,decode:zm}),Km=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Hm},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Rl={...cm,...hm,...fm,...pm,...ym,...Om,...Pm,...Rm,...$m,...Km};function Cd(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const Fl=Cd("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Ec=Cd("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=Id(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),Ad={utf8:Fl,"utf-8":Fl,hex:Rl.base16,latin1:Ec,ascii:Ec,binary:Ec,...Rl};function _r(n,t="utf8"){const r=Ad[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?hu(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function ur(n,t="utf8"){const r=Ad[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}var Ul=globalThis&&globalThis.__spreadArray||function(n,t,r){if(r||arguments.length===2)for(var s=0,a=t.length,l;s<a;s++)(l||!(s in t))&&(l||(l=Array.prototype.slice.call(t,0,s)),l[s]=t[s]);return n.concat(l||Array.prototype.slice.call(t))},km=function(){function n(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return n}(),Vm=function(){function n(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return n}(),Gm=function(){function n(t,r,s,a){this.name=t,this.version=r,this.os=s,this.bot=a,this.type="bot-device"}return n}(),Wm=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),Ym=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),Jm=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Xm=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ll=3,Zm=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Jm]],Ml=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Qm(n){return n?$l(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Ym:typeof navigator<"u"?$l(navigator.userAgent):rw()}function ew(n){return n!==""&&Zm.reduce(function(t,r){var s=r[0],a=r[1];if(t)return t;var l=a.exec(n);return!!l&&[s,l]},!1)}function $l(n){var t=ew(n);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new Wm;var a=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);a?a.length<Ll&&(a=Ul(Ul([],a,!0),iw(Ll-a.length),!0)):a=[];var l=a.join("."),p=tw(n),f=Xm.exec(n);return f&&f[1]?new Gm(r,l,p,f[1]):new km(r,l,p)}function tw(n){for(var t=0,r=Ml.length;t<r;t++){var s=Ml[t],a=s[0],l=s[1],p=l.exec(n);if(p)return a}return null}function rw(){var n=typeof process<"u"&&process.version;return n?new Vm(process.version.slice(1)):null}function iw(n){for(var t=[],r=0;r<n;r++)t.push("0");return t}var ye={};const jr=fd(ab);var Dc={},es={},jl;function nw(){if(jl)return es;jl=1,Object.defineProperty(es,"__esModule",{value:!0}),es.delay=void 0;function n(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return es.delay=n,es}var Ji={},Sc={},Xi={},Bl;function sw(){return Bl||(Bl=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.ONE_THOUSAND=Xi.ONE_HUNDRED=void 0,Xi.ONE_HUNDRED=100,Xi.ONE_THOUSAND=1e3),Xi}var Ic={},ql;function ow(){return ql||(ql=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(Ic)),Ic}var zl;function Pd(){return zl||(zl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=jr;t.__exportStar(sw(),n),t.__exportStar(ow(),n)}(Sc)),Sc}var Hl;function aw(){if(Hl)return Ji;Hl=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.fromMiliseconds=Ji.toMiliseconds=void 0;const n=Pd();function t(s){return s*n.ONE_THOUSAND}Ji.toMiliseconds=t;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return Ji.fromMiliseconds=r,Ji}var Kl;function cw(){return Kl||(Kl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=jr;t.__exportStar(nw(),n),t.__exportStar(aw(),n)}(Dc)),Dc}var xn={},kl;function uw(){if(kl)return xn;kl=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const a=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:a})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return xn.Watch=n,xn.default=n,xn}var xc={},ts={},Vl;function hw(){if(Vl)return ts;Vl=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.IWatch=void 0;class n{}return ts.IWatch=n,ts}var Gl;function lw(){return Gl||(Gl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),jr.__exportStar(hw(),n)}(xc)),xc}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=jr;t.__exportStar(cw(),n),t.__exportStar(uw(),n),t.__exportStar(lw(),n),t.__exportStar(Pd(),n)})(ye);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=Nd=lt.getLocation=lt.getLocationOrThrow=lu=lt.getNavigator=lt.getNavigatorOrThrow=Td=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function tn(n){let t;return typeof window<"u"&&typeof window[n]<"u"&&(t=window[n]),t}lt.getFromWindow=tn;function Nn(n){const t=tn(n);if(!t)throw new Error(`${n} is not defined in Window`);return t}lt.getFromWindowOrThrow=Nn;function fw(){return Nn("document")}lt.getDocumentOrThrow=fw;function dw(){return tn("document")}var Td=lt.getDocument=dw;function pw(){return Nn("navigator")}lt.getNavigatorOrThrow=pw;function gw(){return tn("navigator")}var lu=lt.getNavigator=gw;function vw(){return Nn("location")}lt.getLocationOrThrow=vw;function yw(){return tn("location")}var Nd=lt.getLocation=yw;function _w(){return Nn("crypto")}lt.getCryptoOrThrow=_w;function bw(){return tn("crypto")}lt.getCrypto=bw;function mw(){return Nn("localStorage")}lt.getLocalStorageOrThrow=mw;function ww(){return tn("localStorage")}lt.getLocalStorage=ww;var fu={};Object.defineProperty(fu,"__esModule",{value:!0});var Rd=fu.getWindowMetadata=void 0;const Wl=lt;function Ew(){let n,t;try{n=Wl.getDocumentOrThrow(),t=Wl.getLocationOrThrow()}catch{return null}function r(){const N=n.getElementsByTagName("link"),j=[];for(let R=0;R<N.length;R++){const T=N[R],z=T.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const K=T.getAttribute("href");if(K)if(K.toLowerCase().indexOf("https:")===-1&&K.toLowerCase().indexOf("http:")===-1&&K.indexOf("//")!==0){let se=t.protocol+"//"+t.host;if(K.indexOf("/")===0)se+=K;else{const P=t.pathname.split("/");P.pop();const L=P.join("/");se+=L+"/"+K}j.push(se)}else if(K.indexOf("//")===0){const se=t.protocol+K;j.push(se)}else j.push(K)}}return j}function s(...N){const j=n.getElementsByTagName("meta");for(let R=0;R<j.length;R++){const T=j[R],z=["itemprop","property","name"].map(K=>T.getAttribute(K)).filter(K=>K?N.includes(K):!1);if(z.length&&z){const K=T.getAttribute("content");if(K)return K}}return""}function a(){let N=s("name","og:site_name","og:title","twitter:title");return N||(N=n.title),N}function l(){return s("description","og:description","twitter:description","keywords")}const p=a(),f=l(),g=t.origin,E=r();return{description:f,url:g,icons:E,name:p}}Rd=fu.getWindowMetadata=Ew;var ps={},Dw=n=>encodeURIComponent(n).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),Fd="%[a-f0-9]{2}",Yl=new RegExp("("+Fd+")|([^%]+?)","gi"),Jl=new RegExp("("+Fd+")+","gi");function Wc(n,t){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;t=t||1;var r=n.slice(0,t),s=n.slice(t);return Array.prototype.concat.call([],Wc(r),Wc(s))}function Sw(n){try{return decodeURIComponent(n)}catch{for(var t=n.match(Yl)||[],r=1;r<t.length;r++)n=Wc(t,r).join(""),t=n.match(Yl)||[];return n}}function Iw(n){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=Jl.exec(n);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var s=Sw(r[0]);s!==r[0]&&(t[r[0]]=s)}r=Jl.exec(n)}t["%C2"]="�";for(var a=Object.keys(t),l=0;l<a.length;l++){var p=a[l];n=n.replace(new RegExp(p,"g"),t[p])}return n}var xw=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch{return Iw(n)}},Ow=(n,t)=>{if(!(typeof n=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[n];const r=n.indexOf(t);return r===-1?[n]:[n.slice(0,r),n.slice(r+t.length)]},Cw=function(n,t){for(var r={},s=Object.keys(n),a=Array.isArray(t),l=0;l<s.length;l++){var p=s[l],f=n[p];(a?t.indexOf(p)!==-1:t(p,f,n))&&(r[p]=f)}return r};(function(n){const t=Dw,r=xw,s=Ow,a=Cw,l=P=>P==null,p=Symbol("encodeFragmentIdentifier");function f(P){switch(P.arrayFormat){case"index":return L=>(D,C)=>{const m=D.length;return C===void 0||P.skipNull&&C===null||P.skipEmptyString&&C===""?D:C===null?[...D,[I(L,P),"[",m,"]"].join("")]:[...D,[I(L,P),"[",I(m,P),"]=",I(C,P)].join("")]};case"bracket":return L=>(D,C)=>C===void 0||P.skipNull&&C===null||P.skipEmptyString&&C===""?D:C===null?[...D,[I(L,P),"[]"].join("")]:[...D,[I(L,P),"[]=",I(C,P)].join("")];case"colon-list-separator":return L=>(D,C)=>C===void 0||P.skipNull&&C===null||P.skipEmptyString&&C===""?D:C===null?[...D,[I(L,P),":list="].join("")]:[...D,[I(L,P),":list=",I(C,P)].join("")];case"comma":case"separator":case"bracket-separator":{const L=P.arrayFormat==="bracket-separator"?"[]=":"=";return D=>(C,m)=>m===void 0||P.skipNull&&m===null||P.skipEmptyString&&m===""?C:(m=m===null?"":m,C.length===0?[[I(D,P),L,I(m,P)].join("")]:[[C,I(m,P)].join(P.arrayFormatSeparator)])}default:return L=>(D,C)=>C===void 0||P.skipNull&&C===null||P.skipEmptyString&&C===""?D:C===null?[...D,I(L,P)]:[...D,[I(L,P),"=",I(C,P)].join("")]}}function g(P){let L;switch(P.arrayFormat){case"index":return(D,C,m)=>{if(L=/\[(\d*)\]$/.exec(D),D=D.replace(/\[\d*\]$/,""),!L){m[D]=C;return}m[D]===void 0&&(m[D]={}),m[D][L[1]]=C};case"bracket":return(D,C,m)=>{if(L=/(\[\])$/.exec(D),D=D.replace(/\[\]$/,""),!L){m[D]=C;return}if(m[D]===void 0){m[D]=[C];return}m[D]=[].concat(m[D],C)};case"colon-list-separator":return(D,C,m)=>{if(L=/(:list)$/.exec(D),D=D.replace(/:list$/,""),!L){m[D]=C;return}if(m[D]===void 0){m[D]=[C];return}m[D]=[].concat(m[D],C)};case"comma":case"separator":return(D,C,m)=>{const c=typeof C=="string"&&C.includes(P.arrayFormatSeparator),_=typeof C=="string"&&!c&&N(C,P).includes(P.arrayFormatSeparator);C=_?N(C,P):C;const G=c||_?C.split(P.arrayFormatSeparator).map(W=>N(W,P)):C===null?C:N(C,P);m[D]=G};case"bracket-separator":return(D,C,m)=>{const c=/(\[\])$/.test(D);if(D=D.replace(/\[\]$/,""),!c){m[D]=C&&N(C,P);return}const _=C===null?[]:C.split(P.arrayFormatSeparator).map(G=>N(G,P));if(m[D]===void 0){m[D]=_;return}m[D]=[].concat(m[D],_)};default:return(D,C,m)=>{if(m[D]===void 0){m[D]=C;return}m[D]=[].concat(m[D],C)}}}function E(P){if(typeof P!="string"||P.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function I(P,L){return L.encode?L.strict?t(P):encodeURIComponent(P):P}function N(P,L){return L.decode?r(P):P}function j(P){return Array.isArray(P)?P.sort():typeof P=="object"?j(Object.keys(P)).sort((L,D)=>Number(L)-Number(D)).map(L=>P[L]):P}function R(P){const L=P.indexOf("#");return L!==-1&&(P=P.slice(0,L)),P}function T(P){let L="";const D=P.indexOf("#");return D!==-1&&(L=P.slice(D)),L}function z(P){P=R(P);const L=P.indexOf("?");return L===-1?"":P.slice(L+1)}function K(P,L){return L.parseNumbers&&!Number.isNaN(Number(P))&&typeof P=="string"&&P.trim()!==""?P=Number(P):L.parseBooleans&&P!==null&&(P.toLowerCase()==="true"||P.toLowerCase()==="false")&&(P=P.toLowerCase()==="true"),P}function se(P,L){L=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},L),E(L.arrayFormatSeparator);const D=g(L),C=Object.create(null);if(typeof P!="string"||(P=P.trim().replace(/^[?#&]/,""),!P))return C;for(const m of P.split("&")){if(m==="")continue;let[c,_]=s(L.decode?m.replace(/\+/g," "):m,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(L.arrayFormat)?_:N(_,L),D(N(c,L),_,C)}for(const m of Object.keys(C)){const c=C[m];if(typeof c=="object"&&c!==null)for(const _ of Object.keys(c))c[_]=K(c[_],L);else C[m]=K(c,L)}return L.sort===!1?C:(L.sort===!0?Object.keys(C).sort():Object.keys(C).sort(L.sort)).reduce((m,c)=>{const _=C[c];return _&&typeof _=="object"&&!Array.isArray(_)?m[c]=j(_):m[c]=_,m},Object.create(null))}n.extract=z,n.parse=se,n.stringify=(P,L)=>{if(!P)return"";L=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},L),E(L.arrayFormatSeparator);const D=_=>L.skipNull&&l(P[_])||L.skipEmptyString&&P[_]==="",C=f(L),m={};for(const _ of Object.keys(P))D(_)||(m[_]=P[_]);const c=Object.keys(m);return L.sort!==!1&&c.sort(L.sort),c.map(_=>{const G=P[_];return G===void 0?"":G===null?I(_,L):Array.isArray(G)?G.length===0&&L.arrayFormat==="bracket-separator"?I(_,L)+"[]":G.reduce(C(_),[]).join("&"):I(_,L)+"="+I(G,L)}).filter(_=>_.length>0).join("&")},n.parseUrl=(P,L)=>{L=Object.assign({decode:!0},L);const[D,C]=s(P,"#");return Object.assign({url:D.split("?")[0]||"",query:se(z(P),L)},L&&L.parseFragmentIdentifier&&C?{fragmentIdentifier:N(C,L)}:{})},n.stringifyUrl=(P,L)=>{L=Object.assign({encode:!0,strict:!0,[p]:!0},L);const D=R(P.url).split("?")[0]||"",C=n.extract(P.url),m=n.parse(C,{sort:!1}),c=Object.assign(m,P.query);let _=n.stringify(c,L);_&&(_=`?${_}`);let G=T(P.url);return P.fragmentIdentifier&&(G=`#${L[p]?I(P.fragmentIdentifier,L):P.fragmentIdentifier}`),`${D}${_}${G}`},n.pick=(P,L,D)=>{D=Object.assign({parseFragmentIdentifier:!0,[p]:!1},D);const{url:C,query:m,fragmentIdentifier:c}=n.parseUrl(P,D);return n.stringifyUrl({url:C,query:a(m,L),fragmentIdentifier:c},D)},n.exclude=(P,L,D)=>{const C=Array.isArray(L)?m=>!L.includes(m):(m,c)=>!L(m,c);return n.pick(P,C,D)}})(ps);const Aw={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function Pw(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const a=n[s];r.push(...a.accounts)}),r}function Ud(n,t){return n.includes(":")?[n]:t.chains||[]}const Ld="base10",cr="base16",Yc="base64pad",du="utf8",Md=0,rn=1,Tw=0,Xl=1,Jc=12,pu=32;function Nw(){const n=uu.generateKeyPair();return{privateKey:ur(n.secretKey,cr),publicKey:ur(n.publicKey,cr)}}function Xc(){const n=Tn.randomBytes(pu);return ur(n,cr)}function Rw(n,t){const r=uu.sharedKey(_r(n,cr),_r(t,cr)),s=new qb(Ko.SHA256,r).expand(pu);return ur(s,cr)}function Fw(n){const t=Ko.hash(_r(n,cr));return ur(t,cr)}function An(n){const t=Ko.hash(_r(n,du));return ur(t,cr)}function Uw(n){return _r(`${n}`,Ld)}function _s(n){return Number(ur(n,Ld))}function Lw(n){const t=Uw(typeof n.type<"u"?n.type:Md);if(_s(t)===rn&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?_r(n.senderPublicKey,cr):void 0,s=typeof n.iv<"u"?_r(n.iv,cr):Tn.randomBytes(Jc),a=new au.ChaCha20Poly1305(_r(n.symKey,cr)).seal(s,_r(n.message,du));return $w({type:t,sealed:a,iv:s,senderPublicKey:r})}function Mw(n){const t=new au.ChaCha20Poly1305(_r(n.symKey,cr)),{sealed:r,iv:s}=Fo(n.encoded),a=t.open(s,r);if(a===null)throw new Error("Failed to decrypt");return ur(a,du)}function $w(n){if(_s(n.type)===rn){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ur(Gc([n.type,n.senderPublicKey,n.iv,n.sealed]),Yc)}return ur(Gc([n.type,n.iv,n.sealed]),Yc)}function Fo(n){const t=_r(n,Yc),r=t.slice(Tw,Xl),s=Xl;if(_s(r)===rn){const f=s+pu,g=f+Jc,E=t.slice(s,f),I=t.slice(f,g),N=t.slice(g);return{type:r,sealed:N,iv:I,senderPublicKey:E}}const a=s+Jc,l=t.slice(s,a),p=t.slice(a);return{type:r,sealed:p,iv:l}}function jw(n,t){const r=Fo(n);return $d({type:_s(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ur(r.senderPublicKey,cr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function $d(n){const t=(n==null?void 0:n.type)||Md;if(t===rn){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function Zl(n){return n.type===rn&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var Bw=Object.defineProperty,Ql=Object.getOwnPropertySymbols,qw=Object.prototype.hasOwnProperty,zw=Object.prototype.propertyIsEnumerable,ef=(n,t,r)=>t in n?Bw(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,tf=(n,t)=>{for(var r in t||(t={}))qw.call(t,r)&&ef(n,r,t[r]);if(Ql)for(var r of Ql(t))zw.call(t,r)&&ef(n,r,t[r]);return n};const Hw="ReactNative",Ti={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Kw="js";function gu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function jd(){return!Td()&&!!lu()&&navigator.product===Hw}function vu(){return!gu()&&!!lu()}function yu(){return jd()?Ti.reactNative:gu()?Ti.node:vu()?Ti.browser:Ti.unknown}function kw(n,t){let r=ps.parse(n);return r=tf(tf({},r),t),n=ps.stringify(r),n}function Vw(){return Rd()||{name:"",description:"",url:"",icons:[""]}}function Gw(){if(yu()===Ti.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const n=Qm();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function Ww(){var n;const t=yu();return t===Ti.browser?[t,((n=Nd())==null?void 0:n.host)||"unknown"].join(":"):t}function Yw(n,t,r){const s=Gw(),a=Ww();return[[n,t].join("-"),[Kw,r].join("-"),s,a].join("/")}function Jw({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:a,projectId:l,useOnCloseEvent:p}){const f=r.split("?"),g=Yw(n,t,s),E={auth:a,ua:g,projectId:l,useOnCloseEvent:p||void 0},I=kw(f[1]||"",E);return f[0]+"?"+I}function en(n,t){return n.filter(r=>t.includes(r)).length===n.length}function Bd(n){return Object.fromEntries(n.entries())}function qd(n){return new Map(Object.entries(n))}function On(n=ye.FIVE_MINUTES,t){const r=ye.toMiliseconds(n||ye.FIVE_MINUTES);let s,a,l;return{resolve:p=>{l&&s&&(clearTimeout(l),s(p))},reject:p=>{l&&a&&(clearTimeout(l),a(p))},done:()=>new Promise((p,f)=>{l=setTimeout(()=>{f(new Error(t))},r),s=p,a=f})}}function Uo(n,t,r){return new Promise(async(s,a)=>{const l=setTimeout(()=>a(new Error(r)),t);try{const p=await n;s(p)}catch(p){a(p)}clearTimeout(l)})}function zd(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function Xw(n){return zd("topic",n)}function Zw(n){return zd("id",n)}function Hd(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function Vr(n,t){return ye.fromMiliseconds((t||Date.now())+ye.toMiliseconds(n))}function Pi(n){return Date.now()>=ye.toMiliseconds(n)}function zt(n,t){return`${n}${t?`:${t}`:""}`}function Oc(n=[],t=[]){return[...new Set([...n,...t])]}async function Qw({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const l=`${a}/wc?requestId=${n}&sessionTopic=${t}`,p=yu();p===Ti.browser?l.startsWith("https://")?window.open(l,"_blank","noreferrer noopener"):window.open(l,"_self","noreferrer noopener"):p===Ti.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(l)}catch(s){console.error(s)}}const eE="irn";function Zc(n){return(n==null?void 0:n.relay)||{protocol:eE}}function Ao(n){const t=Aw[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var tE=Object.defineProperty,rf=Object.getOwnPropertySymbols,rE=Object.prototype.hasOwnProperty,iE=Object.prototype.propertyIsEnumerable,nf=(n,t,r)=>t in n?tE(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,nE=(n,t)=>{for(var r in t||(t={}))rE.call(t,r)&&nf(n,r,t[r]);if(rf)for(var r of rf(t))iE.call(t,r)&&nf(n,r,t[r]);return n};function sE(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const l=a.replace(s,""),p=n[a];r[l]=p}}),r}function oE(n){const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),a=n.substring(t+1,r).split("@"),l=typeof r<"u"?n.substring(r):"",p=ps.parse(l);return{protocol:s,topic:aE(a[0]),version:parseInt(a[1],10),symKey:p.symKey,relay:sE(p)}}function aE(n){return n.startsWith("//")?n.substring(2):n}function cE(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const l=r+t+a;n[a]&&(s[l]=n[a])}),s}function uE(n){return`${n.protocol}:${n.topic}@${n.version}?`+ps.stringify(nE({symKey:n.symKey},cE(n.relay)))}function Rn(n){const t=[];return n.forEach(r=>{const[s,a]=r.split(":");t.push(`${s}:${a}`)}),t}function hE(n){const t=[];return Object.values(n).forEach(r=>{t.push(...Rn(r.accounts))}),t}function lE(n,t){const r=[];return Object.values(n).forEach(s=>{Rn(s.accounts).includes(t)&&r.push(...s.methods)}),r}function fE(n,t){const r=[];return Object.values(n).forEach(s=>{Rn(s.accounts).includes(t)&&r.push(...s.events)}),r}function dE(n,t){const r=To(n,t);if(r)throw new Error(r.message);const s={};for(const[a,l]of Object.entries(n))s[a]={methods:l.methods,events:l.events,chains:l.accounts.map(p=>`${p.split(":")[0]}:${p.split(":")[1]}`)};return s}function _u(n){return n.includes(":")}function Po(n){return _u(n)?n.split(":")[0]:n}const pE={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},gE={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function he(n,t){const{message:r,code:s}=gE[n];return{message:t?`${r} ${t}`:r,code:s}}function Rt(n,t){const{message:r,code:s}=pE[n];return{message:t?`${r} ${t}`:r,code:s}}function ii(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function Pn(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function ar(n){return typeof n>"u"}function Gt(n,t){return t&&ar(n)?!0:typeof n=="string"&&!!n.trim().length}function bu(n,t){return t&&ar(n)?!0:typeof n=="number"&&!isNaN(n)}function vE(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),a=Object.keys(r);let l=!0;return en(a,s)?(s.forEach(p=>{const{accounts:f,methods:g,events:E}=n.namespaces[p],I=Rn(f),N=r[p];(!en(Ud(p,N),I)||!en(N.methods,g)||!en(N.events,E))&&(l=!1)}),l):!1}function Lo(n){return Gt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function yE(n){if(Gt(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Lo(r)}}return!1}function _E(n){if(Gt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function bE(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function mE(n){return n==null?void 0:n.topic}function wE(n,t){let r=null;return Gt(n==null?void 0:n.publicKey,!1)||(r=he("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function sf(n){let t=!0;return ii(n)?n.length&&(t=n.every(r=>Gt(r,!1))):t=!1,t}function EE(n,t,r){let s=null;return ii(t)&&t.length?t.forEach(a=>{s||Lo(a)||(s=Rt("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Lo(n)||(s=Rt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function DE(n,t,r){let s=null;return Object.entries(n).forEach(([a,l])=>{if(s)return;const p=EE(a,Ud(a,l),`${t} ${r}`);p&&(s=p)}),s}function SE(n,t){let r=null;return ii(n)?n.forEach(s=>{r||yE(s)||(r=Rt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=Rt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function IE(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=SE(s==null?void 0:s.accounts,`${t} namespace`);a&&(r=a)}),r}function xE(n,t){let r=null;return sf(n==null?void 0:n.methods)?sf(n==null?void 0:n.events)||(r=Rt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Rt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Kd(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=xE(s,`${t}, namespace`);a&&(r=a)}),r}function OE(n,t,r){let s=null;if(n&&Pn(n)){const a=Kd(n,t);a&&(s=a);const l=DE(n,t,r);l&&(s=l)}else s=he("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function To(n,t){let r=null;if(n&&Pn(n)){const s=Kd(n,t);s&&(r=s);const a=IE(n,t);a&&(r=a)}else r=he("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function kd(n){return Gt(n.protocol,!0)}function CE(n,t){let r=!1;return t&&!n?r=!0:n&&ii(n)&&n.length&&n.forEach(s=>{r=kd(s)}),r}function AE(n){return typeof n=="number"}function vr(n){return typeof n<"u"&&typeof n!==null}function PE(n){return!(!n||typeof n!="object"||!n.code||!bu(n.code,!1)||!n.message||!Gt(n.message,!1))}function TE(n){return!(ar(n)||!Gt(n.method,!1))}function NE(n){return!(ar(n)||ar(n.result)&&ar(n.error)||!bu(n.id,!1)||!Gt(n.jsonrpc,!1))}function RE(n){return!(ar(n)||!Gt(n.name,!1))}function of(n,t){return!(!Lo(t)||!hE(n).includes(t))}function FE(n,t,r){return Gt(r,!1)?lE(n,t).includes(r):!1}function UE(n,t,r){return Gt(r,!1)?fE(n,t).includes(r):!1}function af(n,t,r){let s=null;const a=LE(n),l=ME(t),p=Object.keys(a),f=Object.keys(l),g=cf(Object.keys(n)),E=cf(Object.keys(t)),I=g.filter(N=>!E.includes(N));return I.length&&(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${I.toString()}
      Received: ${Object.keys(t).toString()}`)),en(p,f)||(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${p.toString()}
      Approved: ${f.toString()}`)),Object.keys(t).forEach(N=>{if(!N.includes(":")||s)return;const j=Rn(t[N].accounts);j.includes(N)||(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${N}
        Required: ${N}
        Approved: ${j.toString()}`))}),p.forEach(N=>{s||(en(a[N].methods,l[N].methods)?en(a[N].events,l[N].events)||(s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${N}`)):s=he("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${N}`))}),s}function LE(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{t[a]={methods:n[r].methods,events:n[r].events}})}),t}function cf(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function ME(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=Rn(n[r].accounts);s==null||s.forEach(a=>{t[a]={accounts:n[r].accounts.filter(l=>l.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function $E(n,t){return bu(n,!1)&&n<=t.max&&n>=t.min}var Vo={},bs={};Object.defineProperty(bs,"__esModule",{value:!0});function jE(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}bs.safeJsonParse=jE;function BE(n){return typeof n=="string"?n:JSON.stringify(n,(t,r)=>typeof r>"u"?null:r)}bs.safeJsonStringify=BE;var rs={exports:{}},uf;function qE(){return uf||(uf=1,function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof yr<"u"&&yr.localStorage?rs.exports=yr.localStorage:typeof window<"u"&&window.localStorage?rs.exports=window.localStorage:rs.exports=new t}()),rs.exports}var Cc={},is={},hf;function zE(){if(hf)return is;hf=1,Object.defineProperty(is,"__esModule",{value:!0}),is.IKeyValueStorage=void 0;class n{}return is.IKeyValueStorage=n,is}var ns={},lf;function HE(){if(lf)return ns;lf=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.parseEntry=void 0;const n=bs;function t(r){var s;return[r[0],n.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return ns.parseEntry=t,ns}var ff;function KE(){return ff||(ff=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=jr;t.__exportStar(zE(),n),t.__exportStar(HE(),n)}(Cc)),Cc}Object.defineProperty(Vo,"__esModule",{value:!0});Vo.KeyValueStorage=void 0;const Cn=jr,df=bs,kE=Cn.__importDefault(qE()),VE=KE();class Vd{constructor(){this.localStorage=kE.default}getKeys(){return Cn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Cn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(VE.parseEntry)})}getItem(t){return Cn.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return df.safeJsonParse(r)})}setItem(t,r){return Cn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,df.safeJsonStringify(r))})}removeItem(t){return Cn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Vo.KeyValueStorage=Vd;var GE=Vo.default=Vd,Fn={},ss={},Ac={},os={};let nn=class{};const WE=Object.freeze(Object.defineProperty({__proto__:null,IEvents:nn},Symbol.toStringTag,{value:"Module"})),YE=fd(WE);var pf;function JE(){if(pf)return os;pf=1,Object.defineProperty(os,"__esModule",{value:!0}),os.IHeartBeat=void 0;const n=YE;class t extends n.IEvents{constructor(s){super()}}return os.IHeartBeat=t,os}var gf;function Gd(){return gf||(gf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),jr.__exportStar(JE(),n)}(Ac)),Ac}var Pc={},Zi={},vf;function XE(){if(vf)return Zi;vf=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.HEARTBEAT_EVENTS=Zi.HEARTBEAT_INTERVAL=void 0;const n=ye;return Zi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Zi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Zi}var yf;function Wd(){return yf||(yf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),jr.__exportStar(XE(),n)}(Pc)),Pc}var _f;function ZE(){if(_f)return ss;_f=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.HeartBeat=void 0;const n=jr,t=$r,r=ye,s=Gd(),a=Wd();class l extends s.IHeartBeat{constructor(f){super(f),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||a.HEARTBEAT_INTERVAL}static init(f){return n.__awaiter(this,void 0,void 0,function*(){const g=new l(f);return yield g.init(),g})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,g){this.events.on(f,g)}once(f,g){this.events.once(f,g)}off(f,g){this.events.off(f,g)}removeListener(f,g){this.events.removeListener(f,g)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return ss.HeartBeat=l,ss}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=jr;t.__exportStar(ZE(),n),t.__exportStar(Gd(),n),t.__exportStar(Wd(),n)})(Fn);var Qe={},Tc,bf;function QE(){if(bf)return Tc;bf=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Tc=t;function t(r,s,a){var l=a&&a.stringify||n,p=1;if(typeof r=="object"&&r!==null){var f=s.length+p;if(f===1)return r;var g=new Array(f);g[0]=l(r);for(var E=1;E<f;E++)g[E]=l(s[E]);return g.join(" ")}if(typeof r!="string")return r;var I=s.length;if(I===0)return r;for(var N="",j=1-p,R=-1,T=r&&r.length||0,z=0;z<T;){if(r.charCodeAt(z)===37&&z+1<T){switch(R=R>-1?R:0,r.charCodeAt(z+1)){case 100:case 102:if(j>=I||s[j]==null)break;R<z&&(N+=r.slice(R,z)),N+=Number(s[j]),R=z+2,z++;break;case 105:if(j>=I||s[j]==null)break;R<z&&(N+=r.slice(R,z)),N+=Math.floor(Number(s[j])),R=z+2,z++;break;case 79:case 111:case 106:if(j>=I||s[j]===void 0)break;R<z&&(N+=r.slice(R,z));var K=typeof s[j];if(K==="string"){N+="'"+s[j]+"'",R=z+2,z++;break}if(K==="function"){N+=s[j].name||"<anonymous>",R=z+2,z++;break}N+=l(s[j]),R=z+2,z++;break;case 115:if(j>=I)break;R<z&&(N+=r.slice(R,z)),N+=String(s[j]),R=z+2,z++;break;case 37:R<z&&(N+=r.slice(R,z)),N+="%",R=z+2,z++,j--;break}++j}++z}return R===-1?r:(R<T&&(N+=r.slice(R)),N)}return Tc}var Nc,mf;function e3(){if(mf)return Nc;mf=1;const n=QE();Nc=a;const t=C().console||{},r={mapHttpRequest:T,mapHttpResponse:T,wrapRequestSerializer:z,wrapResponseSerializer:z,wrapErrorSerializer:z,req:T,res:T,err:j};function s(m,c){return Array.isArray(m)?m.filter(function(G){return G!=="!stdSerializers.err"}):m===!0?Object.keys(c):!1}function a(m){m=m||{},m.browser=m.browser||{};const c=m.browser.transmit;if(c&&typeof c.send!="function")throw Error("pino: transmit option must have a send function");const _=m.browser.write||t;m.browser.write&&(m.browser.asObject=!0);const G=m.serializers||{},W=s(m.browser.serialize,G);let ne=m.browser.serialize;Array.isArray(m.browser.serialize)&&m.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ne=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof _=="function"&&(_.error=_.fatal=_.warn=_.info=_.debug=_.trace=_),m.enabled===!1&&(m.level="silent");const de=m.level||"info",b=Object.create(_);b.log||(b.log=K),Object.defineProperty(b,"levelVal",{get:ee}),Object.defineProperty(b,"level",{get:X,set:k});const x={transmit:c,serialize:W,asObject:m.browser.asObject,levels:ce,timestamp:R(m)};b.levels=a.levels,b.level=de,b.setMaxListeners=b.getMaxListeners=b.emit=b.addListener=b.on=b.prependListener=b.once=b.prependOnceListener=b.removeListener=b.removeAllListeners=b.listeners=b.listenerCount=b.eventNames=b.write=b.flush=K,b.serializers=G,b._serialize=W,b._stdErrSerialize=ne,b.child=V,c&&(b._logEvent=N());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function X(){return this._level}function k(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,l(x,b,"error","log"),l(x,b,"fatal","error"),l(x,b,"warn","error"),l(x,b,"info","log"),l(x,b,"debug","log"),l(x,b,"trace","log")}function V(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},W&&J.serializers&&(re.serializers=J.serializers);const me=re.serializers;if(W&&me){var oe=Object.assign({},G,me),we=m.browser.serialize===!0?Object.keys(oe):W;delete J.serializers,g([J],we,oe,this._stdErrSerialize)}function le(_e){this._childLevel=(_e._childLevel|0)+1,this.error=E(_e,J,"error"),this.fatal=E(_e,J,"fatal"),this.warn=E(_e,J,"warn"),this.info=E(_e,J,"info"),this.debug=E(_e,J,"debug"),this.trace=E(_e,J,"trace"),oe&&(this.serializers=oe,this._serialize=we),c&&(this._logEvent=N([].concat(_e._logEvent.bindings,J)))}return le.prototype=this,new le(this)}return b}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:se,epochTime:P,unixTime:L,isoTime:D});function l(m,c,_,G){const W=Object.getPrototypeOf(c);c[_]=c.levelVal>c.levels.values[_]?K:W[_]?W[_]:t[_]||t[G]||K,p(m,c,_)}function p(m,c,_){!m.transmit&&c[_]===K||(c[_]=function(G){return function(){const ne=m.timestamp(),ce=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var b=0;b<ce.length;b++)ce[b]=arguments[b];if(m.serialize&&!m.asObject&&g(ce,this._serialize,this.serializers,this._stdErrSerialize),m.asObject?G.call(de,f(this,_,ce,ne)):G.apply(de,ce),m.transmit){const x=m.transmit.level||c.level,ee=a.levels.values[x],X=a.levels.values[_];if(X<ee)return;I(this,{ts:ne,methodLevel:_,methodValue:X,transmitLevel:x,transmitValue:a.levels.values[m.transmit.level||c.level],send:m.transmit.send,val:c.levelVal},ce)}}}(c[_]))}function f(m,c,_,G){m._serialize&&g(_,m._serialize,m.serializers,m._stdErrSerialize);const W=_.slice();let ne=W[0];const ce={};G&&(ce.time=G),ce.level=a.levels.values[c];let de=(m._childLevel|0)+1;if(de<1&&(de=1),ne!==null&&typeof ne=="object"){for(;de--&&typeof W[0]=="object";)Object.assign(ce,W.shift());ne=W.length?n(W.shift(),W):void 0}else typeof ne=="string"&&(ne=n(W.shift(),W));return ne!==void 0&&(ce.msg=ne),ce}function g(m,c,_,G){for(const W in m)if(G&&m[W]instanceof Error)m[W]=a.stdSerializers.err(m[W]);else if(typeof m[W]=="object"&&!Array.isArray(m[W]))for(const ne in m[W])c&&c.indexOf(ne)>-1&&ne in _&&(m[W][ne]=_[ne](m[W][ne]))}function E(m,c,_){return function(){const G=new Array(1+arguments.length);G[0]=c;for(var W=1;W<G.length;W++)G[W]=arguments[W-1];return m[_].apply(this,G)}}function I(m,c,_){const G=c.send,W=c.ts,ne=c.methodLevel,ce=c.methodValue,de=c.val,b=m._logEvent.bindings;g(_,m._serialize||Object.keys(m.serializers),m.serializers,m._stdErrSerialize===void 0?!0:m._stdErrSerialize),m._logEvent.ts=W,m._logEvent.messages=_.filter(function(x){return b.indexOf(x)===-1}),m._logEvent.level.label=ne,m._logEvent.level.value=ce,G(ne,m._logEvent,de),m._logEvent=N(b)}function N(m){return{ts:0,messages:[],bindings:m||[],level:{label:"",value:0}}}function j(m){const c={type:m.constructor.name,msg:m.message,stack:m.stack};for(const _ in m)c[_]===void 0&&(c[_]=m[_]);return c}function R(m){return typeof m.timestamp=="function"?m.timestamp:m.timestamp===!1?se:P}function T(){return{}}function z(m){return m}function K(){}function se(){return!1}function P(){return Date.now()}function L(){return Math.round(Date.now()/1e3)}function D(){return new Date(Date.now()).toISOString()}function C(){function m(c){return typeof c<"u"&&c}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return m(self)||m(window)||m(this)||{}}}return Nc}var Qi={},wf;function Yd(){return wf||(wf=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.PINO_CUSTOM_CONTEXT_KEY=Qi.PINO_LOGGER_DEFAULTS=void 0,Qi.PINO_LOGGER_DEFAULTS={level:"info"},Qi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Qi}var or={},Ef;function t3(){if(Ef)return or;Ef=1,Object.defineProperty(or,"__esModule",{value:!0}),or.generateChildLogger=or.formatChildLoggerContext=or.getLoggerContext=or.setBrowserLoggerContext=or.getBrowserLoggerContext=or.getDefaultLoggerOptions=void 0;const n=Yd();function t(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||n.PINO_LOGGER_DEFAULTS.level})}or.getDefaultLoggerOptions=t;function r(f,g=n.PINO_CUSTOM_CONTEXT_KEY){return f[g]||""}or.getBrowserLoggerContext=r;function s(f,g,E=n.PINO_CUSTOM_CONTEXT_KEY){return f[E]=g,f}or.setBrowserLoggerContext=s;function a(f,g=n.PINO_CUSTOM_CONTEXT_KEY){let E="";return typeof f.bindings>"u"?E=r(f,g):E=f.bindings().context||"",E}or.getLoggerContext=a;function l(f,g,E=n.PINO_CUSTOM_CONTEXT_KEY){const I=a(f,E);return I.trim()?`${I}/${g}`:g}or.formatChildLoggerContext=l;function p(f,g,E=n.PINO_CUSTOM_CONTEXT_KEY){const I=l(f,g,E),N=f.child({context:I});return s(N,I,E)}return or.generateChildLogger=p,or}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=jr,r=t.__importDefault(e3());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(Yd(),n),t.__exportStar(t3(),n)})(Qe);class r3 extends nn{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class i3 extends nn{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class n3{constructor(t,r){this.logger=t,this.core=r}}let s3=class extends nn{constructor(t,r){super(),this.relayer=t,this.logger=r}},o3=class extends nn{constructor(t){super()}},a3=class{constructor(t,r,s,a){this.core=t,this.logger=r,this.name=s}};class c3 extends nn{constructor(t,r){super(),this.relayer=t,this.logger=r}}let u3=class extends nn{constructor(t,r){super(),this.core=t,this.logger=r}},h3=class{constructor(t,r){this.projectId=t,this.logger=r}},l3=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},f3=class{constructor(t){this.client=t}};const d3=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),p3=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function mu(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return p3(n)}catch{return n}}function gs(n){return typeof n=="string"?n:d3(n)||""}var wu={},Jd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Le,r=Ir;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},f.prototype.update=function(g,E){if(E===void 0&&(E=g.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var I=0;if(this._bytesHashed+=E,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&E>0;)this._buffer[this._bufferLength++]=g[I++],E--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(E>=this.blockSize&&(I=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,g,I,E),E%=this.blockSize);E>0;)this._buffer[this._bufferLength++]=g[I++],E--;return this},f.prototype.finish=function(g){if(!this._finished){var E=this._bytesHashed,I=this._bufferLength,N=E/536870912|0,j=E<<3,R=E%128<112?128:256;this._buffer[I]=128;for(var T=I+1;T<R-8;T++)this._buffer[T]=0;t.writeUint32BE(N,this._buffer,R-8),t.writeUint32BE(j,this._buffer,R-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,R),this._finished=!0}for(var T=0;T<this.digestLength/8;T++)t.writeUint32BE(this._stateHi[T],g,T*8),t.writeUint32BE(this._stateLo[T],g,T*8+4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._stateHi.set(g.stateHi),this._stateLo.set(g.stateLo),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){r.wipe(g.stateHi),r.wipe(g.stateLo),g.buffer&&r.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(f,g,E,I,N,j,R){for(var T=E[0],z=E[1],K=E[2],se=E[3],P=E[4],L=E[5],D=E[6],C=E[7],m=I[0],c=I[1],_=I[2],G=I[3],W=I[4],ne=I[5],ce=I[6],de=I[7],b,x,ee,X,k,V,J,re;R>=128;){for(var me=0;me<16;me++){var oe=8*me+j;f[me]=t.readUint32BE(N,oe),g[me]=t.readUint32BE(N,oe+4)}for(var me=0;me<80;me++){var we=T,le=z,_e=K,q=se,B=P,F=L,h=D,O=C,ae=m,fe=c,Ie=_,ze=G,ke=W,Me=ne,pt=ce,gt=de;if(b=C,x=de,k=x&65535,V=x>>>16,J=b&65535,re=b>>>16,b=(P>>>14|W<<32-14)^(P>>>18|W<<32-18)^(W>>>41-32|P<<32-(41-32)),x=(W>>>14|P<<32-14)^(W>>>18|P<<32-18)^(P>>>41-32|W<<32-(41-32)),k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,b=P&L^~P&D,x=W&ne^~W&ce,k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,b=a[me*2],x=a[me*2+1],k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,b=f[me%16],x=g[me%16],k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,ee=J&65535|re<<16,X=k&65535|V<<16,b=ee,x=X,k=x&65535,V=x>>>16,J=b&65535,re=b>>>16,b=(T>>>28|m<<32-28)^(m>>>34-32|T<<32-(34-32))^(m>>>39-32|T<<32-(39-32)),x=(m>>>28|T<<32-28)^(T>>>34-32|m<<32-(34-32))^(T>>>39-32|m<<32-(39-32)),k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,b=T&z^T&K^z&K,x=m&c^m&_^c&_,k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,O=J&65535|re<<16,gt=k&65535|V<<16,b=q,x=ze,k=x&65535,V=x>>>16,J=b&65535,re=b>>>16,b=ee,x=X,k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,q=J&65535|re<<16,ze=k&65535|V<<16,z=we,K=le,se=_e,P=q,L=B,D=F,C=h,T=O,c=ae,_=fe,G=Ie,W=ze,ne=ke,ce=Me,de=pt,m=gt,me%16===15)for(var oe=0;oe<16;oe++)b=f[oe],x=g[oe],k=x&65535,V=x>>>16,J=b&65535,re=b>>>16,b=f[(oe+9)%16],x=g[(oe+9)%16],k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,ee=f[(oe+1)%16],X=g[(oe+1)%16],b=(ee>>>1|X<<32-1)^(ee>>>8|X<<32-8)^ee>>>7,x=(X>>>1|ee<<32-1)^(X>>>8|ee<<32-8)^(X>>>7|ee<<32-7),k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,ee=f[(oe+14)%16],X=g[(oe+14)%16],b=(ee>>>19|X<<32-19)^(X>>>61-32|ee<<32-(61-32))^ee>>>6,x=(X>>>19|ee<<32-19)^(ee>>>61-32|X<<32-(61-32))^(X>>>6|ee<<32-6),k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,f[oe]=J&65535|re<<16,g[oe]=k&65535|V<<16}b=T,x=m,k=x&65535,V=x>>>16,J=b&65535,re=b>>>16,b=E[0],x=I[0],k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,E[0]=T=J&65535|re<<16,I[0]=m=k&65535|V<<16,b=z,x=c,k=x&65535,V=x>>>16,J=b&65535,re=b>>>16,b=E[1],x=I[1],k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,E[1]=z=J&65535|re<<16,I[1]=c=k&65535|V<<16,b=K,x=_,k=x&65535,V=x>>>16,J=b&65535,re=b>>>16,b=E[2],x=I[2],k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,E[2]=K=J&65535|re<<16,I[2]=_=k&65535|V<<16,b=se,x=G,k=x&65535,V=x>>>16,J=b&65535,re=b>>>16,b=E[3],x=I[3],k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,E[3]=se=J&65535|re<<16,I[3]=G=k&65535|V<<16,b=P,x=W,k=x&65535,V=x>>>16,J=b&65535,re=b>>>16,b=E[4],x=I[4],k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,E[4]=P=J&65535|re<<16,I[4]=W=k&65535|V<<16,b=L,x=ne,k=x&65535,V=x>>>16,J=b&65535,re=b>>>16,b=E[5],x=I[5],k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,E[5]=L=J&65535|re<<16,I[5]=ne=k&65535|V<<16,b=D,x=ce,k=x&65535,V=x>>>16,J=b&65535,re=b>>>16,b=E[6],x=I[6],k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,E[6]=D=J&65535|re<<16,I[6]=ce=k&65535|V<<16,b=C,x=de,k=x&65535,V=x>>>16,J=b&65535,re=b>>>16,b=E[7],x=I[7],k+=x&65535,V+=x>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,E[7]=C=J&65535|re<<16,I[7]=de=k&65535|V<<16,j+=128,R-=128}return j}function p(f){var g=new s;g.update(f);var E=g.digest();return g.clean(),E}n.hash=p})(Jd);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=Tn,r=Jd,s=Ir;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(q){const B=new Float64Array(16);if(q)for(let F=0;F<q.length;F++)B[F]=q[F];return B}const l=new Uint8Array(32);l[0]=9;const p=a(),f=a([1]),g=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),E=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),I=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),N=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),j=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function R(q,B){for(let F=0;F<16;F++)q[F]=B[F]|0}function T(q){let B=1;for(let F=0;F<16;F++){let h=q[F]+B+65535;B=Math.floor(h/65536),q[F]=h-B*65536}q[0]+=B-1+37*(B-1)}function z(q,B,F){const h=~(F-1);for(let O=0;O<16;O++){const ae=h&(q[O]^B[O]);q[O]^=ae,B[O]^=ae}}function K(q,B){const F=a(),h=a();for(let O=0;O<16;O++)h[O]=B[O];T(h),T(h),T(h);for(let O=0;O<2;O++){F[0]=h[0]-65517;for(let fe=1;fe<15;fe++)F[fe]=h[fe]-65535-(F[fe-1]>>16&1),F[fe-1]&=65535;F[15]=h[15]-32767-(F[14]>>16&1);const ae=F[15]>>16&1;F[14]&=65535,z(h,F,1-ae)}for(let O=0;O<16;O++)q[2*O]=h[O]&255,q[2*O+1]=h[O]>>8}function se(q,B){let F=0;for(let h=0;h<32;h++)F|=q[h]^B[h];return(1&F-1>>>8)-1}function P(q,B){const F=new Uint8Array(32),h=new Uint8Array(32);return K(F,q),K(h,B),se(F,h)}function L(q){const B=new Uint8Array(32);return K(B,q),B[0]&1}function D(q,B){for(let F=0;F<16;F++)q[F]=B[2*F]+(B[2*F+1]<<8);q[15]&=32767}function C(q,B,F){for(let h=0;h<16;h++)q[h]=B[h]+F[h]}function m(q,B,F){for(let h=0;h<16;h++)q[h]=B[h]-F[h]}function c(q,B,F){let h,O,ae=0,fe=0,Ie=0,ze=0,ke=0,Me=0,pt=0,gt=0,je=0,xe=0,Re=0,Fe=0,Be=0,Ce=0,Ue=0,Se=0,Ae=0,He=0,Oe=0,Ve=0,We=0,et=0,tt=0,Je=0,er=0,hr=0,Wr=0,tr=0,ni=0,bi=0,Li=0,wt=F[0],vt=F[1],Et=F[2],Dt=F[3],bt=F[4],yt=F[5],Ut=F[6],Lt=F[7],St=F[8],Mt=F[9],It=F[10],At=F[11],xt=F[12],ht=F[13],$t=F[14],jt=F[15];h=B[0],ae+=h*wt,fe+=h*vt,Ie+=h*Et,ze+=h*Dt,ke+=h*bt,Me+=h*yt,pt+=h*Ut,gt+=h*Lt,je+=h*St,xe+=h*Mt,Re+=h*It,Fe+=h*At,Be+=h*xt,Ce+=h*ht,Ue+=h*$t,Se+=h*jt,h=B[1],fe+=h*wt,Ie+=h*vt,ze+=h*Et,ke+=h*Dt,Me+=h*bt,pt+=h*yt,gt+=h*Ut,je+=h*Lt,xe+=h*St,Re+=h*Mt,Fe+=h*It,Be+=h*At,Ce+=h*xt,Ue+=h*ht,Se+=h*$t,Ae+=h*jt,h=B[2],Ie+=h*wt,ze+=h*vt,ke+=h*Et,Me+=h*Dt,pt+=h*bt,gt+=h*yt,je+=h*Ut,xe+=h*Lt,Re+=h*St,Fe+=h*Mt,Be+=h*It,Ce+=h*At,Ue+=h*xt,Se+=h*ht,Ae+=h*$t,He+=h*jt,h=B[3],ze+=h*wt,ke+=h*vt,Me+=h*Et,pt+=h*Dt,gt+=h*bt,je+=h*yt,xe+=h*Ut,Re+=h*Lt,Fe+=h*St,Be+=h*Mt,Ce+=h*It,Ue+=h*At,Se+=h*xt,Ae+=h*ht,He+=h*$t,Oe+=h*jt,h=B[4],ke+=h*wt,Me+=h*vt,pt+=h*Et,gt+=h*Dt,je+=h*bt,xe+=h*yt,Re+=h*Ut,Fe+=h*Lt,Be+=h*St,Ce+=h*Mt,Ue+=h*It,Se+=h*At,Ae+=h*xt,He+=h*ht,Oe+=h*$t,Ve+=h*jt,h=B[5],Me+=h*wt,pt+=h*vt,gt+=h*Et,je+=h*Dt,xe+=h*bt,Re+=h*yt,Fe+=h*Ut,Be+=h*Lt,Ce+=h*St,Ue+=h*Mt,Se+=h*It,Ae+=h*At,He+=h*xt,Oe+=h*ht,Ve+=h*$t,We+=h*jt,h=B[6],pt+=h*wt,gt+=h*vt,je+=h*Et,xe+=h*Dt,Re+=h*bt,Fe+=h*yt,Be+=h*Ut,Ce+=h*Lt,Ue+=h*St,Se+=h*Mt,Ae+=h*It,He+=h*At,Oe+=h*xt,Ve+=h*ht,We+=h*$t,et+=h*jt,h=B[7],gt+=h*wt,je+=h*vt,xe+=h*Et,Re+=h*Dt,Fe+=h*bt,Be+=h*yt,Ce+=h*Ut,Ue+=h*Lt,Se+=h*St,Ae+=h*Mt,He+=h*It,Oe+=h*At,Ve+=h*xt,We+=h*ht,et+=h*$t,tt+=h*jt,h=B[8],je+=h*wt,xe+=h*vt,Re+=h*Et,Fe+=h*Dt,Be+=h*bt,Ce+=h*yt,Ue+=h*Ut,Se+=h*Lt,Ae+=h*St,He+=h*Mt,Oe+=h*It,Ve+=h*At,We+=h*xt,et+=h*ht,tt+=h*$t,Je+=h*jt,h=B[9],xe+=h*wt,Re+=h*vt,Fe+=h*Et,Be+=h*Dt,Ce+=h*bt,Ue+=h*yt,Se+=h*Ut,Ae+=h*Lt,He+=h*St,Oe+=h*Mt,Ve+=h*It,We+=h*At,et+=h*xt,tt+=h*ht,Je+=h*$t,er+=h*jt,h=B[10],Re+=h*wt,Fe+=h*vt,Be+=h*Et,Ce+=h*Dt,Ue+=h*bt,Se+=h*yt,Ae+=h*Ut,He+=h*Lt,Oe+=h*St,Ve+=h*Mt,We+=h*It,et+=h*At,tt+=h*xt,Je+=h*ht,er+=h*$t,hr+=h*jt,h=B[11],Fe+=h*wt,Be+=h*vt,Ce+=h*Et,Ue+=h*Dt,Se+=h*bt,Ae+=h*yt,He+=h*Ut,Oe+=h*Lt,Ve+=h*St,We+=h*Mt,et+=h*It,tt+=h*At,Je+=h*xt,er+=h*ht,hr+=h*$t,Wr+=h*jt,h=B[12],Be+=h*wt,Ce+=h*vt,Ue+=h*Et,Se+=h*Dt,Ae+=h*bt,He+=h*yt,Oe+=h*Ut,Ve+=h*Lt,We+=h*St,et+=h*Mt,tt+=h*It,Je+=h*At,er+=h*xt,hr+=h*ht,Wr+=h*$t,tr+=h*jt,h=B[13],Ce+=h*wt,Ue+=h*vt,Se+=h*Et,Ae+=h*Dt,He+=h*bt,Oe+=h*yt,Ve+=h*Ut,We+=h*Lt,et+=h*St,tt+=h*Mt,Je+=h*It,er+=h*At,hr+=h*xt,Wr+=h*ht,tr+=h*$t,ni+=h*jt,h=B[14],Ue+=h*wt,Se+=h*vt,Ae+=h*Et,He+=h*Dt,Oe+=h*bt,Ve+=h*yt,We+=h*Ut,et+=h*Lt,tt+=h*St,Je+=h*Mt,er+=h*It,hr+=h*At,Wr+=h*xt,tr+=h*ht,ni+=h*$t,bi+=h*jt,h=B[15],Se+=h*wt,Ae+=h*vt,He+=h*Et,Oe+=h*Dt,Ve+=h*bt,We+=h*yt,et+=h*Ut,tt+=h*Lt,Je+=h*St,er+=h*Mt,hr+=h*It,Wr+=h*At,tr+=h*xt,ni+=h*ht,bi+=h*$t,Li+=h*jt,ae+=38*Ae,fe+=38*He,Ie+=38*Oe,ze+=38*Ve,ke+=38*We,Me+=38*et,pt+=38*tt,gt+=38*Je,je+=38*er,xe+=38*hr,Re+=38*Wr,Fe+=38*tr,Be+=38*ni,Ce+=38*bi,Ue+=38*Li,O=1,h=ae+O+65535,O=Math.floor(h/65536),ae=h-O*65536,h=fe+O+65535,O=Math.floor(h/65536),fe=h-O*65536,h=Ie+O+65535,O=Math.floor(h/65536),Ie=h-O*65536,h=ze+O+65535,O=Math.floor(h/65536),ze=h-O*65536,h=ke+O+65535,O=Math.floor(h/65536),ke=h-O*65536,h=Me+O+65535,O=Math.floor(h/65536),Me=h-O*65536,h=pt+O+65535,O=Math.floor(h/65536),pt=h-O*65536,h=gt+O+65535,O=Math.floor(h/65536),gt=h-O*65536,h=je+O+65535,O=Math.floor(h/65536),je=h-O*65536,h=xe+O+65535,O=Math.floor(h/65536),xe=h-O*65536,h=Re+O+65535,O=Math.floor(h/65536),Re=h-O*65536,h=Fe+O+65535,O=Math.floor(h/65536),Fe=h-O*65536,h=Be+O+65535,O=Math.floor(h/65536),Be=h-O*65536,h=Ce+O+65535,O=Math.floor(h/65536),Ce=h-O*65536,h=Ue+O+65535,O=Math.floor(h/65536),Ue=h-O*65536,h=Se+O+65535,O=Math.floor(h/65536),Se=h-O*65536,ae+=O-1+37*(O-1),O=1,h=ae+O+65535,O=Math.floor(h/65536),ae=h-O*65536,h=fe+O+65535,O=Math.floor(h/65536),fe=h-O*65536,h=Ie+O+65535,O=Math.floor(h/65536),Ie=h-O*65536,h=ze+O+65535,O=Math.floor(h/65536),ze=h-O*65536,h=ke+O+65535,O=Math.floor(h/65536),ke=h-O*65536,h=Me+O+65535,O=Math.floor(h/65536),Me=h-O*65536,h=pt+O+65535,O=Math.floor(h/65536),pt=h-O*65536,h=gt+O+65535,O=Math.floor(h/65536),gt=h-O*65536,h=je+O+65535,O=Math.floor(h/65536),je=h-O*65536,h=xe+O+65535,O=Math.floor(h/65536),xe=h-O*65536,h=Re+O+65535,O=Math.floor(h/65536),Re=h-O*65536,h=Fe+O+65535,O=Math.floor(h/65536),Fe=h-O*65536,h=Be+O+65535,O=Math.floor(h/65536),Be=h-O*65536,h=Ce+O+65535,O=Math.floor(h/65536),Ce=h-O*65536,h=Ue+O+65535,O=Math.floor(h/65536),Ue=h-O*65536,h=Se+O+65535,O=Math.floor(h/65536),Se=h-O*65536,ae+=O-1+37*(O-1),q[0]=ae,q[1]=fe,q[2]=Ie,q[3]=ze,q[4]=ke,q[5]=Me,q[6]=pt,q[7]=gt,q[8]=je,q[9]=xe,q[10]=Re,q[11]=Fe,q[12]=Be,q[13]=Ce,q[14]=Ue,q[15]=Se}function _(q,B){c(q,B,B)}function G(q,B){const F=a();let h;for(h=0;h<16;h++)F[h]=B[h];for(h=253;h>=0;h--)_(F,F),h!==2&&h!==4&&c(F,F,B);for(h=0;h<16;h++)q[h]=F[h]}function W(q,B){const F=a();let h;for(h=0;h<16;h++)F[h]=B[h];for(h=250;h>=0;h--)_(F,F),h!==1&&c(F,F,B);for(h=0;h<16;h++)q[h]=F[h]}function ne(q,B){const F=a(),h=a(),O=a(),ae=a(),fe=a(),Ie=a(),ze=a(),ke=a(),Me=a();m(F,q[1],q[0]),m(Me,B[1],B[0]),c(F,F,Me),C(h,q[0],q[1]),C(Me,B[0],B[1]),c(h,h,Me),c(O,q[3],B[3]),c(O,O,E),c(ae,q[2],B[2]),C(ae,ae,ae),m(fe,h,F),m(Ie,ae,O),C(ze,ae,O),C(ke,h,F),c(q[0],fe,Ie),c(q[1],ke,ze),c(q[2],ze,Ie),c(q[3],fe,ke)}function ce(q,B,F){for(let h=0;h<4;h++)z(q[h],B[h],F)}function de(q,B){const F=a(),h=a(),O=a();G(O,B[2]),c(F,B[0],O),c(h,B[1],O),K(q,h),q[31]^=L(F)<<7}function b(q,B,F){R(q[0],p),R(q[1],f),R(q[2],f),R(q[3],p);for(let h=255;h>=0;--h){const O=F[h/8|0]>>(h&7)&1;ce(q,B,O),ne(B,q),ne(q,q),ce(q,B,O)}}function x(q,B){const F=[a(),a(),a(),a()];R(F[0],I),R(F[1],N),R(F[2],f),c(F[3],I,N),b(q,F,B)}function ee(q){if(q.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const B=(0,r.hash)(q);B[0]&=248,B[31]&=127,B[31]|=64;const F=new Uint8Array(32),h=[a(),a(),a(),a()];x(h,B),de(F,h);const O=new Uint8Array(64);return O.set(q),O.set(F,32),{publicKey:F,secretKey:O}}n.generateKeyPairFromSeed=ee;function X(q){const B=(0,t.randomBytes)(32,q),F=ee(B);return(0,s.wipe)(B),F}n.generateKeyPair=X;function k(q){if(q.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(q.subarray(32))}n.extractPublicKeyFromSecretKey=k;const V=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(q,B){let F,h,O,ae;for(h=63;h>=32;--h){for(F=0,O=h-32,ae=h-12;O<ae;++O)B[O]+=F-16*B[h]*V[O-(h-32)],F=Math.floor((B[O]+128)/256),B[O]-=F*256;B[O]+=F,B[h]=0}for(F=0,O=0;O<32;O++)B[O]+=F-(B[31]>>4)*V[O],F=B[O]>>8,B[O]&=255;for(O=0;O<32;O++)B[O]-=F*V[O];for(h=0;h<32;h++)B[h+1]+=B[h]>>8,q[h]=B[h]&255}function re(q){const B=new Float64Array(64);for(let F=0;F<64;F++)B[F]=q[F];for(let F=0;F<64;F++)q[F]=0;J(q,B)}function me(q,B){const F=new Float64Array(64),h=[a(),a(),a(),a()],O=(0,r.hash)(q.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const ae=new Uint8Array(64);ae.set(O.subarray(32),32);const fe=new r.SHA512;fe.update(ae.subarray(32)),fe.update(B);const Ie=fe.digest();fe.clean(),re(Ie),x(h,Ie),de(ae,h),fe.reset(),fe.update(ae.subarray(0,32)),fe.update(q.subarray(32)),fe.update(B);const ze=fe.digest();re(ze);for(let ke=0;ke<32;ke++)F[ke]=Ie[ke];for(let ke=0;ke<32;ke++)for(let Me=0;Me<32;Me++)F[ke+Me]+=ze[ke]*O[Me];return J(ae.subarray(32),F),ae}n.sign=me;function oe(q,B){const F=a(),h=a(),O=a(),ae=a(),fe=a(),Ie=a(),ze=a();return R(q[2],f),D(q[1],B),_(O,q[1]),c(ae,O,g),m(O,O,q[2]),C(ae,q[2],ae),_(fe,ae),_(Ie,fe),c(ze,Ie,fe),c(F,ze,O),c(F,F,ae),W(F,F),c(F,F,O),c(F,F,ae),c(F,F,ae),c(q[0],F,ae),_(h,q[0]),c(h,h,ae),P(h,O)&&c(q[0],q[0],j),_(h,q[0]),c(h,h,ae),P(h,O)?-1:(L(q[0])===B[31]>>7&&m(q[0],p,q[0]),c(q[3],q[0],q[1]),0)}function we(q,B,F){const h=new Uint8Array(32),O=[a(),a(),a(),a()],ae=[a(),a(),a(),a()];if(F.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(oe(ae,q))return!1;const fe=new r.SHA512;fe.update(F.subarray(0,32)),fe.update(q),fe.update(B);const Ie=fe.digest();return re(Ie),b(O,ae,Ie),x(ae,F.subarray(32)),ne(O,ae),de(h,O),!se(F,h)}n.verify=we;function le(q){let B=[a(),a(),a(),a()];if(oe(B,q))throw new Error("Ed25519: invalid public key");let F=a(),h=a(),O=B[1];C(F,f,O),m(h,f,O),G(h,h),c(F,F,h);let ae=new Uint8Array(32);return K(ae,F),ae}n.convertPublicKeyToX25519=le;function _e(q){const B=(0,r.hash)(q.subarray(0,32));B[0]&=248,B[31]&=127,B[31]|=64;const F=new Uint8Array(B.subarray(0,32));return(0,s.wipe)(B),F}n.convertSecretKeyToX25519=_e})(wu);const g3="EdDSA",v3="JWT",Xd=".",Zd="base64url",y3="utf8",_3="utf8",b3=":",m3="did",w3="key",Df="base58btc",E3="z",D3="K36",S3=32;function Mo(n){return ur(_r(gs(n),y3),Zd)}function Qd(n){const t=_r(D3,Df),r=E3+ur(Gc([t,n]),Df);return[m3,w3,r].join(b3)}function I3(n){return ur(n,Zd)}function x3(n){return _r([Mo(n.header),Mo(n.payload)].join(Xd),_3)}function O3(n){return[Mo(n.header),Mo(n.payload),I3(n.signature)].join(Xd)}function Sf(n=Tn.randomBytes(S3)){return wu.generateKeyPairFromSeed(n)}async function C3(n,t,r,s,a=ye.fromMiliseconds(Date.now())){const l={alg:g3,typ:v3},p=Qd(s.publicKey),f=a+r,g={iss:p,sub:n,aud:t,iat:a,exp:f},E=x3({header:l,payload:g}),I=wu.sign(s.secretKey,E);return O3({header:l,payload:g,signature:I})}const A3="PARSE_ERROR",P3="INVALID_REQUEST",T3="METHOD_NOT_FOUND",N3="INVALID_PARAMS",ep="INTERNAL_ERROR",Eu="SERVER_ERROR",R3=[-32700,-32600,-32601,-32602,-32603],ds={[A3]:{code:-32700,message:"Parse error"},[P3]:{code:-32600,message:"Invalid Request"},[T3]:{code:-32601,message:"Method not found"},[N3]:{code:-32602,message:"Invalid params"},[ep]:{code:-32603,message:"Internal error"},[Eu]:{code:-32e3,message:"Server error"}},tp=Eu;function F3(n){return R3.includes(n)}function If(n){return Object.keys(ds).includes(n)?ds[n]:ds[tp]}function U3(n){const t=Object.values(ds).find(r=>r.code===n);return t||ds[tp]}function rp(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var ip={},vi={},xf;function L3(){if(xf)return vi;xf=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.isBrowserCryptoAvailable=vi.getSubtleCrypto=vi.getBrowerCrypto=void 0;function n(){return(yr===null||yr===void 0?void 0:yr.crypto)||(yr===null||yr===void 0?void 0:yr.msCrypto)||{}}vi.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}vi.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return vi.isBrowserCryptoAvailable=r,vi}var yi={},Of;function M3(){if(Of)return yi;Of=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.isBrowser=yi.isNode=yi.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}yi.isReactNative=n;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}yi.isNode=t;function r(){return!n()&&!t()}return yi.isBrowser=r,yi}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=jr;t.__exportStar(L3(),n),t.__exportStar(M3(),n)})(ip);function np(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function Du(n=6){return BigInt(np(n))}function Go(n,t,r){return{id:r||np(),jsonrpc:"2.0",method:n,params:t}}function Su(n,t){return{id:n,jsonrpc:"2.0",result:t}}function Wo(n,t,r){return{id:n,jsonrpc:"2.0",error:$3(t,r)}}function $3(n,t){return typeof n>"u"?If(ep):(typeof n=="string"&&(n=Object.assign(Object.assign({},If(Eu)),{message:n})),typeof t<"u"&&(n.data=t),F3(n.code)&&(n=U3(n.code)),n)}class j3{}class B3 extends j3{constructor(){super()}}class q3 extends B3{constructor(t){super()}}const z3="^https?:",H3="^wss?:";function K3(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function sp(n,t){const r=K3(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function Cf(n){return sp(n,z3)}function Af(n){return sp(n,H3)}function k3(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function op(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function Iu(n){return op(n)&&"method"in n}function Yo(n){return op(n)&&(_i(n)||Gr(n))}function _i(n){return"result"in n}function Gr(n){return"error"in n}class Fi extends q3{constructor(t){super(t),this.events=new $r.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Go(t.method,t.params||[],t.id||Du().toString()),r)}async requestStrict(t,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(l){a(l)}this.events.on(`${t.id}`,l=>{Gr(l)?a(l.error):s(l.result)});try{await this.connection.send(t,r)}catch(l){a(l)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Yo(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const V3=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),G3=()=>typeof window<"u",Pf=n=>n.split("?")[0],Tf=10,W3=V3();class Y3{constructor(t){if(this.url=t,this.events=new $r.EventEmitter,this.registering=!1,!Af(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(gs(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!Af(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const a=ip.isReactNative()?void 0:{rejectUnauthorized:!k3(t)},l=new W3(t,[],a);G3()?l.onerror=p=>{const f=p;s(this.emitError(f.error))}:l.on("error",p=>{s(this.emitError(p))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?mu(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),l=Wo(t,a);this.events.emit("payload",l)}parseError(t,r=this.url){return rp(t,Pf(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Tf&&this.events.setMaxListeners(Tf)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Pf(this.url)}`));return this.events.emit("register_error",r),r}}var $o={exports:{}};$o.exports;(function(n,t){var r=200,s="__lodash_hash_undefined__",a=1,l=2,p=9007199254740991,f="[object Arguments]",g="[object Array]",E="[object AsyncFunction]",I="[object Boolean]",N="[object Date]",j="[object Error]",R="[object Function]",T="[object GeneratorFunction]",z="[object Map]",K="[object Number]",se="[object Null]",P="[object Object]",L="[object Promise]",D="[object Proxy]",C="[object RegExp]",m="[object Set]",c="[object String]",_="[object Symbol]",G="[object Undefined]",W="[object WeakMap]",ne="[object ArrayBuffer]",ce="[object DataView]",de="[object Float32Array]",b="[object Float64Array]",x="[object Int8Array]",ee="[object Int16Array]",X="[object Int32Array]",k="[object Uint8Array]",V="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",me=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,we=/^(?:0|[1-9]\d*)$/,le={};le[de]=le[b]=le[x]=le[ee]=le[X]=le[k]=le[V]=le[J]=le[re]=!0,le[f]=le[g]=le[ne]=le[I]=le[ce]=le[N]=le[j]=le[R]=le[z]=le[K]=le[P]=le[C]=le[m]=le[c]=le[W]=!1;var _e=typeof yr=="object"&&yr&&yr.Object===Object&&yr,q=typeof self=="object"&&self&&self.Object===Object&&self,B=_e||q||Function("return this")(),F=t&&!t.nodeType&&t,h=F&&!0&&n&&!n.nodeType&&n,O=h&&h.exports===F,ae=O&&_e.process,fe=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),Ie=fe&&fe.isTypedArray;function ze(w,U){for(var te=-1,pe=w==null?0:w.length,at=0,Te=[];++te<pe;){var ft=w[te];U(ft,te,w)&&(Te[at++]=ft)}return Te}function ke(w,U){for(var te=-1,pe=U.length,at=w.length;++te<pe;)w[at+te]=U[te];return w}function Me(w,U){for(var te=-1,pe=w==null?0:w.length;++te<pe;)if(U(w[te],te,w))return!0;return!1}function pt(w,U){for(var te=-1,pe=Array(w);++te<w;)pe[te]=U(te);return pe}function gt(w){return function(U){return w(U)}}function je(w,U){return w.has(U)}function xe(w,U){return w==null?void 0:w[U]}function Re(w){var U=-1,te=Array(w.size);return w.forEach(function(pe,at){te[++U]=[at,pe]}),te}function Fe(w,U){return function(te){return w(U(te))}}function Be(w){var U=-1,te=Array(w.size);return w.forEach(function(pe){te[++U]=pe}),te}var Ce=Array.prototype,Ue=Function.prototype,Se=Object.prototype,Ae=B["__core-js_shared__"],He=Ue.toString,Oe=Se.hasOwnProperty,Ve=function(){var w=/[^.]+$/.exec(Ae&&Ae.keys&&Ae.keys.IE_PROTO||"");return w?"Symbol(src)_1."+w:""}(),We=Se.toString,et=RegExp("^"+He.call(Oe).replace(me,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=O?B.Buffer:void 0,Je=B.Symbol,er=B.Uint8Array,hr=Se.propertyIsEnumerable,Wr=Ce.splice,tr=Je?Je.toStringTag:void 0,ni=Object.getOwnPropertySymbols,bi=tt?tt.isBuffer:void 0,Li=Fe(Object.keys,Object),wt=br(B,"DataView"),vt=br(B,"Map"),Et=br(B,"Promise"),Dt=br(B,"Set"),bt=br(B,"WeakMap"),yt=br(Object,"create"),Ut=oi(wt),Lt=oi(vt),St=oi(Et),Mt=oi(Dt),It=oi(bt),At=Je?Je.prototype:void 0,xt=At?At.valueOf:void 0;function ht(w){var U=-1,te=w==null?0:w.length;for(this.clear();++U<te;){var pe=w[U];this.set(pe[0],pe[1])}}function $t(){this.__data__=yt?yt(null):{},this.size=0}function jt(w){var U=this.has(w)&&delete this.__data__[w];return this.size-=U?1:0,U}function Zo(w){var U=this.__data__;if(yt){var te=U[w];return te===s?void 0:te}return Oe.call(U,w)?U[w]:void 0}function Qo(w){var U=this.__data__;return yt?U[w]!==void 0:Oe.call(U,w)}function ea(w,U){var te=this.__data__;return this.size+=this.has(w)?0:1,te[w]=yt&&U===void 0?s:U,this}ht.prototype.clear=$t,ht.prototype.delete=jt,ht.prototype.get=Zo,ht.prototype.has=Qo,ht.prototype.set=ea;function xr(w){var U=-1,te=w==null?0:w.length;for(this.clear();++U<te;){var pe=w[U];this.set(pe[0],pe[1])}}function ta(){this.__data__=[],this.size=0}function ra(w){var U=this.__data__,te=Mi(U,w);if(te<0)return!1;var pe=U.length-1;return te==pe?U.pop():Wr.call(U,te,1),--this.size,!0}function ia(w){var U=this.__data__,te=Mi(U,w);return te<0?void 0:U[te][1]}function na(w){return Mi(this.__data__,w)>-1}function sa(w,U){var te=this.__data__,pe=Mi(te,w);return pe<0?(++this.size,te.push([w,U])):te[pe][1]=U,this}xr.prototype.clear=ta,xr.prototype.delete=ra,xr.prototype.get=ia,xr.prototype.has=na,xr.prototype.set=sa;function si(w){var U=-1,te=w==null?0:w.length;for(this.clear();++U<te;){var pe=w[U];this.set(pe[0],pe[1])}}function on(){this.size=0,this.__data__={hash:new ht,map:new(vt||xr),string:new ht}}function oa(w){var U=mi(this,w).delete(w);return this.size-=U?1:0,U}function an(w){return mi(this,w).get(w)}function aa(w){return mi(this,w).has(w)}function ca(w,U){var te=mi(this,w),pe=te.size;return te.set(w,U),this.size+=te.size==pe?0:1,this}si.prototype.clear=on,si.prototype.delete=oa,si.prototype.get=an,si.prototype.has=aa,si.prototype.set=ca;function cn(w){var U=-1,te=w==null?0:w.length;for(this.__data__=new si;++U<te;)this.add(w[U])}function ws(w){return this.__data__.set(w,s),this}function Es(w){return this.__data__.has(w)}cn.prototype.add=cn.prototype.push=ws,cn.prototype.has=Es;function Br(w){var U=this.__data__=new xr(w);this.size=U.size}function ua(){this.__data__=new xr,this.size=0}function ha(w){var U=this.__data__,te=U.delete(w);return this.size=U.size,te}function la(w){return this.__data__.get(w)}function fa(w){return this.__data__.has(w)}function Ds(w,U){var te=this.__data__;if(te instanceof xr){var pe=te.__data__;if(!vt||pe.length<r-1)return pe.push([w,U]),this.size=++te.size,this;te=this.__data__=new si(pe)}return te.set(w,U),this.size=te.size,this}Br.prototype.clear=ua,Br.prototype.delete=ha,Br.prototype.get=la,Br.prototype.has=fa,Br.prototype.set=Ds;function Ss(w,U){var te=ln(w),pe=!te&&Ls(w),at=!te&&!pe&&Mn(w),Te=!te&&!pe&&!at&&js(w),ft=te||pe||at||Te,Bt=ft?pt(w.length,String):[],Xe=Bt.length;for(var ct in w)(U||Oe.call(w,ct))&&!(ft&&(ct=="length"||at&&(ct=="offset"||ct=="parent")||Te&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Ts(ct,Xe)))&&Bt.push(ct);return Bt}function Mi(w,U){for(var te=w.length;te--;)if(Us(w[te][0],U))return te;return-1}function Un(w,U,te){var pe=U(w);return ln(w)?pe:ke(pe,te(w))}function $i(w){return w==null?w===void 0?G:se:tr&&tr in Object(w)?As(w):ga(w)}function Ln(w){return Bi(w)&&$i(w)==f}function ji(w,U,te,pe,at){return w===U?!0:w==null||U==null||!Bi(w)&&!Bi(U)?w!==w&&U!==U:Is(w,U,te,pe,ji,at)}function Is(w,U,te,pe,at,Te){var ft=ln(w),Bt=ln(U),Xe=ft?g:Yr(w),ct=Bt?g:Yr(U);Xe=Xe==f?P:Xe,ct=ct==f?P:ct;var Pt=Xe==P,lr=ct==P,qt=Xe==ct;if(qt&&Mn(w)){if(!Mn(U))return!1;ft=!0,Pt=!1}if(qt&&!Pt)return Te||(Te=new Br),ft||js(w)?un(w,U,te,pe,at,Te):pa(w,U,Xe,te,pe,at,Te);if(!(te&a)){var dt=Pt&&Oe.call(w,"__wrapped__"),rr=lr&&Oe.call(U,"__wrapped__");if(dt||rr){var qr=dt?w.value():w,Or=rr?U.value():U;return Te||(Te=new Br),at(qr,Or,te,pe,Te)}}return qt?(Te||(Te=new Br),Cs(w,U,te,pe,at,Te)):!1}function da(w){if(!$s(w)||Rs(w))return!1;var U=fn(w)?et:oe;return U.test(oi(w))}function xs(w){return Bi(w)&&Ms(w.length)&&!!le[$i(w)]}function Os(w){if(!Fs(w))return Li(w);var U=[];for(var te in Object(w))Oe.call(w,te)&&te!="constructor"&&U.push(te);return U}function un(w,U,te,pe,at,Te){var ft=te&a,Bt=w.length,Xe=U.length;if(Bt!=Xe&&!(ft&&Xe>Bt))return!1;var ct=Te.get(w);if(ct&&Te.get(U))return ct==U;var Pt=-1,lr=!0,qt=te&l?new cn:void 0;for(Te.set(w,U),Te.set(U,w);++Pt<Bt;){var dt=w[Pt],rr=U[Pt];if(pe)var qr=ft?pe(rr,dt,Pt,U,w,Te):pe(dt,rr,Pt,w,U,Te);if(qr!==void 0){if(qr)continue;lr=!1;break}if(qt){if(!Me(U,function(Or,Jr){if(!je(qt,Jr)&&(dt===Or||at(dt,Or,te,pe,Te)))return qt.push(Jr)})){lr=!1;break}}else if(!(dt===rr||at(dt,rr,te,pe,Te))){lr=!1;break}}return Te.delete(w),Te.delete(U),lr}function pa(w,U,te,pe,at,Te,ft){switch(te){case ce:if(w.byteLength!=U.byteLength||w.byteOffset!=U.byteOffset)return!1;w=w.buffer,U=U.buffer;case ne:return!(w.byteLength!=U.byteLength||!Te(new er(w),new er(U)));case I:case N:case K:return Us(+w,+U);case j:return w.name==U.name&&w.message==U.message;case C:case c:return w==U+"";case z:var Bt=Re;case m:var Xe=pe&a;if(Bt||(Bt=Be),w.size!=U.size&&!Xe)return!1;var ct=ft.get(w);if(ct)return ct==U;pe|=l,ft.set(w,U);var Pt=un(Bt(w),Bt(U),pe,at,Te,ft);return ft.delete(w),Pt;case _:if(xt)return xt.call(w)==xt.call(U)}return!1}function Cs(w,U,te,pe,at,Te){var ft=te&a,Bt=hn(w),Xe=Bt.length,ct=hn(U),Pt=ct.length;if(Xe!=Pt&&!ft)return!1;for(var lr=Xe;lr--;){var qt=Bt[lr];if(!(ft?qt in U:Oe.call(U,qt)))return!1}var dt=Te.get(w);if(dt&&Te.get(U))return dt==U;var rr=!0;Te.set(w,U),Te.set(U,w);for(var qr=ft;++lr<Xe;){qt=Bt[lr];var Or=w[qt],Jr=U[qt];if(pe)var $n=ft?pe(Jr,Or,qt,U,w,Te):pe(Or,Jr,qt,w,U,Te);if(!($n===void 0?Or===Jr||at(Or,Jr,te,pe,Te):$n)){rr=!1;break}qr||(qr=qt=="constructor")}if(rr&&!qr){var qi=w.constructor,kt=U.constructor;qi!=kt&&"constructor"in w&&"constructor"in U&&!(typeof qi=="function"&&qi instanceof qi&&typeof kt=="function"&&kt instanceof kt)&&(rr=!1)}return Te.delete(w),Te.delete(U),rr}function hn(w){return Un(w,_a,Ps)}function mi(w,U){var te=w.__data__;return Ns(U)?te[typeof U=="string"?"string":"hash"]:te.map}function br(w,U){var te=xe(w,U);return da(te)?te:void 0}function As(w){var U=Oe.call(w,tr),te=w[tr];try{w[tr]=void 0;var pe=!0}catch{}var at=We.call(w);return pe&&(U?w[tr]=te:delete w[tr]),at}var Ps=ni?function(w){return w==null?[]:(w=Object(w),ze(ni(w),function(U){return hr.call(w,U)}))}:ot,Yr=$i;(wt&&Yr(new wt(new ArrayBuffer(1)))!=ce||vt&&Yr(new vt)!=z||Et&&Yr(Et.resolve())!=L||Dt&&Yr(new Dt)!=m||bt&&Yr(new bt)!=W)&&(Yr=function(w){var U=$i(w),te=U==P?w.constructor:void 0,pe=te?oi(te):"";if(pe)switch(pe){case Ut:return ce;case Lt:return z;case St:return L;case Mt:return m;case It:return W}return U});function Ts(w,U){return U=U??p,!!U&&(typeof w=="number"||we.test(w))&&w>-1&&w%1==0&&w<U}function Ns(w){var U=typeof w;return U=="string"||U=="number"||U=="symbol"||U=="boolean"?w!=="__proto__":w===null}function Rs(w){return!!Ve&&Ve in w}function Fs(w){var U=w&&w.constructor,te=typeof U=="function"&&U.prototype||Se;return w===te}function ga(w){return We.call(w)}function oi(w){if(w!=null){try{return He.call(w)}catch{}try{return w+""}catch{}}return""}function Us(w,U){return w===U||w!==w&&U!==U}var Ls=Ln(function(){return arguments}())?Ln:function(w){return Bi(w)&&Oe.call(w,"callee")&&!hr.call(w,"callee")},ln=Array.isArray;function va(w){return w!=null&&Ms(w.length)&&!fn(w)}var Mn=bi||st;function ya(w,U){return ji(w,U)}function fn(w){if(!$s(w))return!1;var U=$i(w);return U==R||U==T||U==E||U==D}function Ms(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=p}function $s(w){var U=typeof w;return w!=null&&(U=="object"||U=="function")}function Bi(w){return w!=null&&typeof w=="object"}var js=Ie?gt(Ie):xs;function _a(w){return va(w)?Ss(w):Os(w)}function ot(){return[]}function st(){return!1}n.exports=ya})($o,$o.exports);var J3=$o.exports;const X3=dd(J3);function Z3(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var l=n.charAt(a),p=l.charCodeAt(0);if(r[p]!==255)throw new TypeError(l+" is ambiguous");r[p]=a}var f=n.length,g=n.charAt(0),E=Math.log(f)/Math.log(256),I=Math.log(256)/Math.log(f);function N(T){if(T instanceof Uint8Array||(ArrayBuffer.isView(T)?T=new Uint8Array(T.buffer,T.byteOffset,T.byteLength):Array.isArray(T)&&(T=Uint8Array.from(T))),!(T instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(T.length===0)return"";for(var z=0,K=0,se=0,P=T.length;se!==P&&T[se]===0;)se++,z++;for(var L=(P-se)*I+1>>>0,D=new Uint8Array(L);se!==P;){for(var C=T[se],m=0,c=L-1;(C!==0||m<K)&&c!==-1;c--,m++)C+=256*D[c]>>>0,D[c]=C%f>>>0,C=C/f>>>0;if(C!==0)throw new Error("Non-zero carry");K=m,se++}for(var _=L-K;_!==L&&D[_]===0;)_++;for(var G=g.repeat(z);_<L;++_)G+=n.charAt(D[_]);return G}function j(T){if(typeof T!="string")throw new TypeError("Expected String");if(T.length===0)return new Uint8Array;var z=0;if(T[z]!==" "){for(var K=0,se=0;T[z]===g;)K++,z++;for(var P=(T.length-z)*E+1>>>0,L=new Uint8Array(P);T[z];){var D=r[T.charCodeAt(z)];if(D===255)return;for(var C=0,m=P-1;(D!==0||C<se)&&m!==-1;m--,C++)D+=f*L[m]>>>0,L[m]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");se=C,z++}if(T[z]!==" "){for(var c=P-se;c!==P&&L[c]===0;)c++;for(var _=new Uint8Array(K+(P-c)),G=K;c!==P;)_[G++]=L[c++];return _}}}function R(T){var z=j(T);if(z)return z;throw new Error(`Non-${t} character`)}return{encode:N,decodeUnsafe:j,decode:R}}var Q3=Z3,e6=Q3;const ap=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},t6=n=>new TextEncoder().encode(n),r6=n=>new TextDecoder().decode(n);class i6{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class n6{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return cp(this,t)}}class s6{constructor(t){this.decoders=t}or(t){return cp(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const cp=(n,t)=>new s6({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class o6{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new i6(t,r,s),this.decoder=new n6(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Jo=({name:n,prefix:t,encode:r,decode:s})=>new o6(n,t,r,s),ms=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=e6(r,t);return Jo({prefix:n,name:t,encode:s,decode:l=>ap(a(l))})},a6=(n,t,r,s)=>{const a={};for(let I=0;I<t.length;++I)a[t[I]]=I;let l=n.length;for(;n[l-1]==="=";)--l;const p=new Uint8Array(l*r/8|0);let f=0,g=0,E=0;for(let I=0;I<l;++I){const N=a[n[I]];if(N===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<r|N,f+=r,f>=8&&(f-=8,p[E++]=255&g>>f)}if(f>=r||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return p},c6=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let l="",p=0,f=0;for(let g=0;g<n.length;++g)for(f=f<<8|n[g],p+=8;p>r;)p-=r,l+=t[a&f>>p];if(p&&(l+=t[a&f<<r-p]),s)for(;l.length*r&7;)l+="=";return l},Jt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Jo({prefix:t,name:n,encode(a){return c6(a,s,r)},decode(a){return a6(a,s,r,n)}}),u6=Jo({prefix:"\0",name:"identity",encode:n=>r6(n),decode:n=>t6(n)});var h6=Object.freeze({__proto__:null,identity:u6});const l6=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var f6=Object.freeze({__proto__:null,base2:l6});const d6=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var p6=Object.freeze({__proto__:null,base8:d6});const g6=ms({prefix:"9",name:"base10",alphabet:"0123456789"});var v6=Object.freeze({__proto__:null,base10:g6});const y6=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),_6=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var b6=Object.freeze({__proto__:null,base16:y6,base16upper:_6});const m6=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),w6=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),E6=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),D6=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),S6=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),I6=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),x6=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),O6=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),C6=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var A6=Object.freeze({__proto__:null,base32:m6,base32upper:w6,base32pad:E6,base32padupper:D6,base32hex:S6,base32hexupper:I6,base32hexpad:x6,base32hexpadupper:O6,base32z:C6});const P6=ms({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),T6=ms({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var N6=Object.freeze({__proto__:null,base36:P6,base36upper:T6});const R6=ms({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),F6=ms({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var U6=Object.freeze({__proto__:null,base58btc:R6,base58flickr:F6});const L6=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),M6=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),$6=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),j6=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var B6=Object.freeze({__proto__:null,base64:L6,base64pad:M6,base64url:$6,base64urlpad:j6});const up=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),q6=up.reduce((n,t,r)=>(n[r]=t,n),[]),z6=up.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function H6(n){return n.reduce((t,r)=>(t+=q6[r],t),"")}function K6(n){const t=[];for(const r of n){const s=z6[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const k6=Jo({prefix:"🚀",name:"base256emoji",encode:H6,decode:K6});var V6=Object.freeze({__proto__:null,base256emoji:k6}),G6=hp,Nf=128,W6=127,Y6=~W6,J6=Math.pow(2,31);function hp(n,t,r){t=t||[],r=r||0;for(var s=r;n>=J6;)t[r++]=n&255|Nf,n/=128;for(;n&Y6;)t[r++]=n&255|Nf,n>>>=7;return t[r]=n|0,hp.bytes=r-s+1,t}var X6=Qc,Z6=128,Rf=127;function Qc(n,s){var r=0,s=s||0,a=0,l=s,p,f=n.length;do{if(l>=f)throw Qc.bytes=0,new RangeError("Could not decode varint");p=n[l++],r+=a<28?(p&Rf)<<a:(p&Rf)*Math.pow(2,a),a+=7}while(p>=Z6);return Qc.bytes=l-s,r}var Q6=Math.pow(2,7),eD=Math.pow(2,14),tD=Math.pow(2,21),rD=Math.pow(2,28),iD=Math.pow(2,35),nD=Math.pow(2,42),sD=Math.pow(2,49),oD=Math.pow(2,56),aD=Math.pow(2,63),cD=function(n){return n<Q6?1:n<eD?2:n<tD?3:n<rD?4:n<iD?5:n<nD?6:n<sD?7:n<oD?8:n<aD?9:10},uD={encode:G6,decode:X6,encodingLength:cD},lp=uD;const Ff=(n,t,r=0)=>(lp.encode(n,t,r),t),Uf=n=>lp.encodingLength(n),eu=(n,t)=>{const r=t.byteLength,s=Uf(n),a=s+Uf(r),l=new Uint8Array(a+r);return Ff(n,l,0),Ff(r,l,s),l.set(t,a),new hD(n,r,t,l)};class hD{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}}const fp=({name:n,code:t,encode:r})=>new lD(n,t,r);class lD{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?eu(this.code,r):r.then(s=>eu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const dp=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),fD=fp({name:"sha2-256",code:18,encode:dp("SHA-256")}),dD=fp({name:"sha2-512",code:19,encode:dp("SHA-512")});var pD=Object.freeze({__proto__:null,sha256:fD,sha512:dD});const pp=0,gD="identity",gp=ap,vD=n=>eu(pp,gp(n)),yD={code:pp,name:gD,encode:gp,digest:vD};var _D=Object.freeze({__proto__:null,identity:yD});new TextEncoder,new TextDecoder;const Lf={...h6,...f6,...p6,...v6,...b6,...A6,...N6,...U6,...B6,...V6};({...pD,..._D});function vp(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function bD(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?vp(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function yp(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const Mf=yp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Rc=yp("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=bD(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),mD={utf8:Mf,"utf-8":Mf,hex:Lf.base16,latin1:Rc,ascii:Rc,binary:Rc,...Lf};function wD(n,t="utf8"){const r=mD[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?vp(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const _p="wc",ED=2,xu="core",Ni=`${_p}@2:${xu}:`,DD={name:xu,logger:"error"},SD={database:":memory:"},ID="crypto",$f="client_ed25519_seed",xD=ye.ONE_DAY,OD="keychain",CD="0.3",AD="messages",PD="0.3",TD=ye.SIX_HOURS,ND="publisher",bp="irn",RD="error",mp="wss://relay.walletconnect.com",jf="wss://relay.walletconnect.org",FD="relayer",Ct={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},UD="_subscription",as={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},LD=ye.ONE_SECOND/2,MD="2.9.0",$D=1e4,jD="0.3",BD="WALLETCONNECT_CLIENT_ID",ri={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},qD="subscription",zD="0.3",HD=ye.FIVE_SECONDS*1e3,KD="pairing",kD="0.3",cs={wc_pairingDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:0},res:{ttl:ye.ONE_DAY,prompt:!1,tag:0}}},ti={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},VD="history",GD="0.3",WD="expirer",Lr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},YD="0.3",Fc="verify-api",Bf="https://verify.walletconnect.com";class JD{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=OD,this.version=CD,this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:l}=he("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(l)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Bd(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?qd(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class XD{constructor(t,r,s){this.core=t,this.logger=r,this.name=ID,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),l=Sf(a);return Qd(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=Nw();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const l=await this.getClientSeed(),p=Sf(l),f=Xc();return await C3(f,a,xD,p)},this.generateSharedKey=(a,l,p)=>{this.isInitialized();const f=this.getPrivateKey(a),g=Rw(f,l);return this.setSymKey(g,p)},this.setSymKey=async(a,l)=>{this.isInitialized();const p=l||Fw(a);return await this.keychain.set(p,a),p},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,l,p)=>{this.isInitialized();const f=$d(p),g=gs(l);if(Zl(f)){const j=f.senderPublicKey,R=f.receiverPublicKey;a=await this.generateSharedKey(j,R)}const E=this.getSymKey(a),{type:I,senderPublicKey:N}=f;return Lw({type:I,symKey:E,message:g,senderPublicKey:N})},this.decode=async(a,l,p)=>{this.isInitialized();const f=jw(l,p);if(Zl(f)){const I=f.receiverPublicKey,N=f.senderPublicKey;a=await this.generateSharedKey(I,N)}const g=this.getSymKey(a),E=Mw({symKey:g,encoded:l});return mu(E)},this.getPayloadType=a=>{const l=Fo(a);return _s(l.type)},this.getPayloadSenderPublicKey=a=>{const l=Fo(a);return l.senderPublicKey?ur(l.senderPublicKey,cr):void 0},this.core=t,this.logger=Qe.generateChildLogger(r,this.name),this.keychain=s||new JD(this.core,this.logger)}get context(){return Qe.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get($f)}catch{t=Xc(),await this.keychain.set($f,t)}return wD(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class ZD extends n3{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=AD,this.version=PD,this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const l=An(a);let p=this.messages.get(s);return typeof p>"u"&&(p={}),typeof p[l]<"u"||(p[l]=a,this.messages.set(s,p),await this.persist()),l},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const l=this.get(s),p=An(a);return typeof l[p]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Qe.generateChildLogger(t,this.name),this.core=r}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Bd(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?qd(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class QD extends s3{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new $r.EventEmitter,this.name=ND,this.queue=new Map,this.publishTimeout=ye.toMiliseconds(ye.TEN_SECONDS),this.queueTimeout=ye.toMiliseconds(ye.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,l)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}});try{const p=(l==null?void 0:l.ttl)||TD,f=Zc(l),g=(l==null?void 0:l.prompt)||!1,E=(l==null?void 0:l.tag)||0,I=(l==null?void 0:l.id)||Du().toString(),N={topic:s,message:a,opts:{ttl:p,relay:f,prompt:g,tag:E,id:I}},j=setTimeout(()=>this.queue.set(I,N),this.queueTimeout);try{await await Uo(this.rpcPublish(s,a,p,f,g,E,I),this.publishTimeout),clearTimeout(j),this.relayer.events.emit(Ct.publish,N)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}})}catch(p){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(p),p}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=Qe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Qe.getLoggerContext(this.logger)}rpcPublish(t,r,s,a,l,p,f){var g,E,I,N;const j={method:Ao(a.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:l,tag:p},id:f};return ar((g=j.params)==null?void 0:g.prompt)&&((E=j.params)==null||delete E.prompt),ar((I=j.params)==null?void 0:I.tag)&&((N=j.params)==null||delete N.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:j}),this.relayer.request(j)}onPublish(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:a}=t;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Fn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Ct.connection_stalled);return}this.checkQueue()}),this.relayer.on(Ct.message_ack,t=>{this.onPublish(t.id.toString())})}}class e2{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const a=s.filter(l=>l!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var t2=Object.defineProperty,r2=Object.defineProperties,i2=Object.getOwnPropertyDescriptors,qf=Object.getOwnPropertySymbols,n2=Object.prototype.hasOwnProperty,s2=Object.prototype.propertyIsEnumerable,zf=(n,t,r)=>t in n?t2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,us=(n,t)=>{for(var r in t||(t={}))n2.call(t,r)&&zf(n,r,t[r]);if(qf)for(var r of qf(t))s2.call(t,r)&&zf(n,r,t[r]);return n},Uc=(n,t)=>r2(n,i2(t));class o2 extends c3{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new e2,this.events=new $r.EventEmitter,this.name=qD,this.version=zD,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ni,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const l=Zc(a),p={topic:s,relay:l};this.pending.set(s,p);const f=await this.rpcSubscribe(s,l);return this.onSubscribe(f,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),f}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,l)=>{const p=new ye.Watch;p.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),p.stop(this.pendingSubscriptionWatchLabel),a(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=HD&&(clearInterval(f),p.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Qe.generateChildLogger(r,this.name),this.clientId=""}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const a=Zc(s);await this.rpcUnsubscribe(t,r,a);const l=Rt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const s={method:Ao(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Uo(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ct.connection_stalled)}return An(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:Ao(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Uo(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ct.connection_stalled)}}rpcUnsubscribe(t,r,s){const a={method:Ao(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,Uc(us({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,us({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,us({},r)),this.topicMap.set(r.topic,t),this.events.emit(ri.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(ri.deleted,Uc(us({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ri.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ri.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);ii(r)&&this.onBatchSubscribe(r.map((s,a)=>Uc(us({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Fn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ct.connect,async()=>{await this.onConnect()}),this.relayer.on(Ct.disconnect,()=>{this.onDisconnect()}),this.events.on(ri.created,async t=>{const r=ri.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(ri.deleted,async t=>{const r=ri.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var a2=Object.defineProperty,Hf=Object.getOwnPropertySymbols,c2=Object.prototype.hasOwnProperty,u2=Object.prototype.propertyIsEnumerable,Kf=(n,t,r)=>t in n?a2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,h2=(n,t)=>{for(var r in t||(t={}))c2.call(t,r)&&Kf(n,r,t[r]);if(Hf)for(var r of Hf(t))u2.call(t,r)&&Kf(n,r,t[r]);return n};class l2 extends o3{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new $r.EventEmitter,this.name=FD,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Qe.generateChildLogger(t.logger,this.name):Qe.pino(Qe.getDefaultLoggerOptions({level:t.logger||RD})),this.messages=new ZD(this.logger,t.core),this.subscriber=new o2(this,this.logger),this.publisher=new QD(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||mp,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${jf}...`),await this.restartTransport(jf)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},$D)}get context(){return Qe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";return a||(await Promise.all([new Promise(l=>{this.subscriber.once(ri.created,p=>{p.topic===t&&l()})}),new Promise(async l=>{a=await this.subscriber.subscribe(t,r),l()})]),a)}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ct.transport_closed))}async transportOpen(t){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=t||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(ri.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,s)=>{await Uo(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>s(a)).then(()=>r()).finally(()=>this.removeListener(Ct.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Ct.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.events.emit(Ct.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=t||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(as.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Fi(new Y3(Jw({sdkVersion:MD,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,s):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Iu(t)){if(!t.method.endsWith(UD))return;const r=t.params,{topic:s,message:a,publishedAt:l}=r.data,p={topic:s,message:a,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(h2({type:"event",event:r.id},p)),this.events.emit(r.id,p),await this.acknowledgePayload(t),await this.onMessageEvent(p)}else Yo(t)&&this.events.emit(Ct.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Ct.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Su(t.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(as.payload,t=>this.onProviderPayload(t)),this.provider.on(as.connect,()=>{this.events.emit(Ct.connect)}),this.provider.on(as.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(as.error,t=>{this.logger.error(t),this.events.emit(Ct.error,t)})}registerEventListeners(){this.events.on(Ct.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Ct.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ye.toMiliseconds(LD))}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var f2=Object.defineProperty,kf=Object.getOwnPropertySymbols,d2=Object.prototype.hasOwnProperty,p2=Object.prototype.propertyIsEnumerable,Vf=(n,t,r)=>t in n?f2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Gf=(n,t)=>{for(var r in t||(t={}))d2.call(t,r)&&Vf(n,r,t[r]);if(kf)for(var r of kf(t))p2.call(t,r)&&Vf(n,r,t[r]);return n};class Xo extends a3{constructor(t,r,s,a=Ni,l=void 0){super(t,r,s,a),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=jD,this.cached=[],this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!ar(p)?this.map.set(this.getKey(p),p):bE(p)?this.map.set(p.id,p):mE(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,f)=>{this.isInitialized(),this.map.has(p)?await this.update(p,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:f}),this.map.set(p,f),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(f=>Object.keys(p).every(g=>X3(f[g],p[g]))):this.values),this.update=async(p,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:f});const g=Gf(Gf({},this.getData(p)),f);this.map.set(p,g),await this.persist()},this.delete=async(p,f)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:f}),this.map.delete(p),await this.persist())},this.logger=Qe.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=l}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class g2{constructor(t,r){this.core=t,this.logger=r,this.name=KD,this.version=kD,this.events=new ou,this.initialized=!1,this.storagePrefix=Ni,this.ignoredPayloadTypes=[rn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Xc(),a=await this.core.crypto.setSymKey(s),l=Vr(ye.FIVE_MINUTES),p={protocol:bp},f={topic:a,expiry:l,relay:p,active:!1},g=uE({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:p});return await this.pairings.set(a,f),await this.core.relayer.subscribe(a),this.core.expirer.set(a,l),{topic:a,uri:g}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:l,relay:p}=oE(s.uri);if(this.pairings.keys.includes(a))throw new Error(`Pairing already exists: ${a}`);if(this.core.crypto.hasKeys(a))throw new Error(`Keychain already exists: ${a}`);const f=Vr(ye.FIVE_MINUTES),g={topic:a,relay:p,expiry:f,active:!1};return await this.pairings.set(a,g),await this.core.crypto.setSymKey(l,a),await this.core.relayer.subscribe(a,{relay:p}),this.core.expirer.set(a,f),s.activatePairing&&await this.activate({topic:a}),g},this.activate=async({topic:s})=>{this.isInitialized();const a=Vr(ye.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const l=await this.sendRequest(a,"wc_pairingPing",{}),{done:p,resolve:f,reject:g}=On();this.events.once(zt("pairing_ping",l),({error:E})=>{E?g(E):f()}),await p()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",Rt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,l)=>{const p=Go(a,l),f=await this.core.crypto.encode(s,p),g=cs[a].req;return this.core.history.set(s,p),this.core.relayer.publish(s,f,g),p.id},this.sendResult=async(s,a,l)=>{const p=Su(s,l),f=await this.core.crypto.encode(a,p),g=await this.core.history.get(a,s),E=cs[g.request.method].res;await this.core.relayer.publish(a,f,E),await this.core.history.resolve(p)},this.sendError=async(s,a,l)=>{const p=Wo(s,l),f=await this.core.crypto.encode(a,p),g=await this.core.history.get(a,s),E=cs[g.request.method]?cs[g.request.method].res:cs.unregistered_method.res;await this.core.relayer.publish(a,f,E),await this.core.history.resolve(p)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Rt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Pi(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:l}=s,p=l.method;if(this.pairings.keys.includes(a))switch(p){case"wc_pairingPing":return this.onPairingPingRequest(a,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,l);default:return this.onUnknownRpcMethodRequest(a,l)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:l}=s,p=(await this.core.history.get(a,l.id)).request.method;if(this.pairings.keys.includes(a))switch(p){case"wc_pairingPing":return this.onPairingPingResponse(a,l);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(s,a)=>{const{id:l}=a;try{this.isValidPing({topic:s}),await this.sendResult(l,s,!0),this.events.emit("pairing_ping",{id:l,topic:s})}catch(p){await this.sendError(l,s,p),this.logger.error(p)}},this.onPairingPingResponse=(s,a)=>{const{id:l}=a;setTimeout(()=>{_i(a)?this.events.emit(zt("pairing_ping",l),{}):Gr(a)&&this.events.emit(zt("pairing_ping",l),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:l}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:l,topic:s})}catch(p){await this.sendError(l,s,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:l,method:p}=a;try{if(this.registeredMethods.includes(p))return;const f=Rt("WC_METHOD_UNSUPPORTED",p);await this.sendError(l,s,f),this.logger.error(f)}catch(f){await this.sendError(l,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Rt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!vr(s)){const{message:a}=he("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(a)}if(!_E(s.uri)){const{message:a}=he("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(a)}},this.isValidPing=async s=>{if(!vr(s)){const{message:l}=he("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!vr(s)){const{message:l}=he("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!Gt(s,!1)){const{message:a}=he("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=he("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Pi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=he("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=Qe.generateChildLogger(r,this.name),this.pairings=new Xo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Qe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Ct.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);Iu(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Yo(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))})}registerExpirerEvents(){this.core.expirer.on(Lr.expired,async t=>{const{topic:r}=Hd(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class v2 extends i3{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new $r.EventEmitter,this.name=VD,this.version=GD,this.cached=[],this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:l}),this.records.has(a.id))return;const p={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:l,expiry:Vr(ye.THIRTY_DAYS)};this.records.set(p.id,p),this.events.emit(ti.created,p)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=Gr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(ti.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(l=>{if(l.topic===s){if(typeof a<"u"&&l.id!==a)return;this.records.delete(l.id),this.events.emit(ti.deleted,l)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Go(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ti.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(ti.created,t=>{const r=ti.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(ti.updated,t=>{const r=ti.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(ti.deleted,t=>{const r=ti.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Fn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{ye.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class y2 extends u3{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new $r.EventEmitter,this.name=WD,this.version=YD,this.cached=[],this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const l=this.formatTarget(s),p={target:l,expiry:a};this.expirations.set(l,p),this.checkExpiry(l,p),this.events.emit(Lr.created,{target:l,expiration:p})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),l=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Lr.deleted,{target:a,expiration:l})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Qe.generateChildLogger(r,this.name)}get context(){return Qe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Xw(t);if(typeof t=="number")return Zw(t);const{message:r}=he("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Lr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=he("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=he("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;ye.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Lr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Fn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Lr.created,t=>{const r=Lr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Lr.expired,t=>{const r=Lr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Lr.deleted,t=>{const r=Lr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}}class _2 extends h3{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Fc,this.initialized=!1,this.init=async s=>{jd()||!vu()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||Bf,await this.createIframe())},this.register=async s=>{var a;if(this.initialized||await this.init(),!!this.iframe)try{(a=this.iframe.contentWindow)==null||a.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async s=>{var a;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const l=this.startAbortTimer(ye.FIVE_SECONDS),p=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(l),p.status===200?(a=await p.json())==null?void 0:a.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,a)=>{if(document.getElementById(Fc))return s();const l=document.createElement("iframe");l.setAttribute("id",Fc),l.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),l.style.display="none",l.addEventListener("load",()=>{this.initialized=!0,s()}),l.addEventListener("error",p=>{a(p)}),document.body.append(l),this.iframe=l}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),ye.toMiliseconds(ye.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Qe.generateChildLogger(r,this.name),this.verifyUrl=Bf,this.abortController=new AbortController,this.isDevEnv=gu()&&{}.IS_VITEST}get context(){return Qe.getLoggerContext(this.logger)}startAbortTimer(t){return setTimeout(()=>this.abortController.abort(),ye.toMiliseconds(t))}}var b2=Object.defineProperty,Wf=Object.getOwnPropertySymbols,m2=Object.prototype.hasOwnProperty,w2=Object.prototype.propertyIsEnumerable,Yf=(n,t,r)=>t in n?b2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Jf=(n,t)=>{for(var r in t||(t={}))m2.call(t,r)&&Yf(n,r,t[r]);if(Wf)for(var r of Wf(t))w2.call(t,r)&&Yf(n,r,t[r]);return n};class Ou extends r3{constructor(t){super(t),this.protocol=_p,this.version=ED,this.name=xu,this.events=new $r.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||mp;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||DD.logger}));this.logger=Qe.generateChildLogger(r,this.name),this.heartbeat=new Fn.HeartBeat,this.crypto=new XD(this,this.logger,t==null?void 0:t.keychain),this.history=new v2(this,this.logger),this.expirer=new y2(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new GE(Jf(Jf({},SD),t==null?void 0:t.storageOptions)),this.relayer=new l2({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new g2(this,this.logger),this.verify=new _2(this.projectId||"",this.logger)}static async init(t){const r=new Ou(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(BD,s),r}get context(){return Qe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const E2=Ou,wp="wc",Ep=2,Dp="client",Cu=`${wp}@${Ep}:${Dp}:`,Lc={name:Dp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},D2="WALLETCONNECT_DEEPLINK_CHOICE",S2="proposal",Sp="Proposal expired",I2="session",xo=ye.SEVEN_DAYS,x2="engine",hs={wc_sessionPropose:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1115}}},Mc={min:ye.FIVE_MINUTES,max:ye.SEVEN_DAYS},O2="request",C2=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var A2=Object.defineProperty,P2=Object.defineProperties,T2=Object.getOwnPropertyDescriptors,Xf=Object.getOwnPropertySymbols,N2=Object.prototype.hasOwnProperty,R2=Object.prototype.propertyIsEnumerable,Zf=(n,t,r)=>t in n?A2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ur=(n,t)=>{for(var r in t||(t={}))N2.call(t,r)&&Zf(n,r,t[r]);if(Xf)for(var r of Xf(t))R2.call(t,r)&&Zf(n,r,t[r]);return n},$c=(n,t)=>P2(n,T2(t));class F2 extends f3{constructor(t){super(t),this.name=x2,this.events=new ou,this.initialized=!1,this.ignoredPayloadTypes=[rn],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(hs)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const s=$c(Ur({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:l,optionalNamespaces:p,sessionProperties:f,relays:g}=s;let E=a,I,N=!1;if(E&&(N=this.client.core.pairing.pairings.get(E).active),!E||!N){const{topic:L,uri:D}=await this.client.core.pairing.create();E=L,I=D}const j=await this.client.core.crypto.generateKeyPair(),R=Ur({requiredNamespaces:l,optionalNamespaces:p,relays:g??[{protocol:bp}],proposer:{publicKey:j,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:T,resolve:z,done:K}=On(ye.FIVE_MINUTES,Sp);if(this.events.once(zt("session_connect"),async({error:L,session:D})=>{if(L)T(L);else if(D){D.self.publicKey=j;const C=$c(Ur({},D),{requiredNamespaces:D.requiredNamespaces,optionalNamespaces:D.optionalNamespaces});await this.client.session.set(D.topic,C),await this.setExpiry(D.topic,D.expiry),E&&await this.client.core.pairing.updateMetadata({topic:E,metadata:D.peer.metadata}),z(C)}}),!E){const{message:L}=he("NO_MATCHING_KEY",`connect() pairing topic: ${E}`);throw new Error(L)}const se=await this.sendRequest(E,"wc_sessionPropose",R),P=Vr(ye.FIVE_MINUTES);return await this.setProposal(se,Ur({id:se,expiry:P},R)),{uri:I,approval:K}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:l,sessionProperties:p}=r,f=this.client.proposal.get(s);let{pairingTopic:g,proposer:E,requiredNamespaces:I,optionalNamespaces:N}=f;g=g||"",Pn(I)||(I=dE(l,"approve()"));const j=await this.client.core.crypto.generateKeyPair(),R=E.publicKey,T=await this.client.core.crypto.generateSharedKey(j,R);g&&s&&(await this.client.core.pairing.updateMetadata({topic:g,metadata:E.metadata}),await this.sendResult(s,g,{relay:{protocol:a??"irn"},responderPublicKey:j}),await this.client.proposal.delete(s,Rt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:g}));const z=Ur({relay:{protocol:a??"irn"},namespaces:l,requiredNamespaces:I,optionalNamespaces:N,pairingTopic:g,controller:{publicKey:j,metadata:this.client.metadata},expiry:Vr(xo)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(T),await this.sendRequest(T,"wc_sessionSettle",z);const K=$c(Ur({},z),{topic:T,pairingTopic:g,acknowledged:!1,self:z.controller,peer:{publicKey:E.publicKey,metadata:E.metadata},controller:j});return await this.client.session.set(T,K),await this.setExpiry(T,Vr(xo)),{topic:T,acknowledged:()=>new Promise(se=>setTimeout(()=>se(this.client.session.get(T)),500))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:l}=this.client.proposal.get(s);l&&(await this.sendError(s,l,a),await this.client.proposal.delete(s,Rt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,l=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:a}),{done:p,resolve:f,reject:g}=On();return this.events.once(zt("session_update",l),({error:E})=>{E?g(E):f()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:p}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest(s,"wc_sessionExtend",{}),{done:l,resolve:p,reject:f}=On();return this.events.once(zt("session_extend",a),({error:g})=>{g?f(g):p()}),await this.setExpiry(s,Vr(xo)),{acknowledged:l}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:l,expiry:p}=r,f=await this.sendRequest(l,"wc_sessionRequest",{request:a,chainId:s},p),{done:g,resolve:E,reject:I}=On(p);this.events.once(zt("session_request",f),({error:j,result:R})=>{j?I(j):E(R)}),this.client.events.emit("session_request_sent",{topic:l,request:a,chainId:s,id:f});const N=await this.client.core.storage.getItem(D2);return Qw({id:f,topic:l,wcDeepLink:N}),await g()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:l}=a;_i(a)?await this.sendResult(l,s,a.result):Gr(a)&&await this.sendError(l,s,a.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest(s,"wc_sessionPing",{}),{done:l,resolve:p,reject:f}=On();this.events.once(zt("session_ping",a),({error:g})=>{g?f(g):p()}),await l()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:l}=r;await this.sendRequest(s,"wc_sessionEvent",{event:a,chainId:l})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=Du().toString();let l;const p=f=>{(f==null?void 0:f.id.toString())===a&&(this.client.core.relayer.events.removeListener(Ct.message_ack,p),l())};await Promise.all([new Promise(f=>{l=f,this.client.core.relayer.on(Ct.message_ack,p)}),this.sendRequest(s,"wc_sessionDelete",Rt("USER_DISCONNECTED"),void 0,a)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>vE(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(l=>{var p,f;return((p=l.peerMetadata)==null?void 0:p.url)&&((f=l.peerMetadata)==null?void 0:f.url)===r.peer.metadata.url&&l.topic&&l.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Rt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r)},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,Rt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=hs.wc_sessionRequest.req.ttl,{id:a,topic:l,params:p}=r;await this.client.pendingRequest.set(a,{id:a,topic:l,params:p}),s&&this.client.core.expirer.set(a,Vr(s))},this.sendRequest=async(r,s,a,l,p)=>{const f=Go(s,a);if(vu()&&C2.includes(s)){const I=An(JSON.stringify(f));await this.client.core.verify.register({attestationId:I})}const g=await this.client.core.crypto.encode(r,f),E=hs[s].req;return l&&(E.ttl=l),p&&(E.id=p),this.client.core.history.set(r,f),this.client.core.relayer.publish(r,g,E),f.id},this.sendResult=async(r,s,a)=>{const l=Su(r,a),p=await this.client.core.crypto.encode(s,l),f=await this.client.core.history.get(s,r),g=hs[f.request.method].res;this.client.core.relayer.publish(s,p,g),await this.client.core.history.resolve(l)},this.sendError=async(r,s,a)=>{const l=Wo(r,a),p=await this.client.core.crypto.encode(s,l),f=await this.client.core.history.get(s,r),g=hs[f.request.method].res;this.client.core.relayer.publish(s,p,g),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Pi(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Pi(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=r=>{const{topic:s,payload:a}=r,l=a.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,l=(await this.client.core.history.get(s,a.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=he("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:l}=s;try{this.isValidConnect(Ur({},s.params));const p=Vr(ye.FIVE_MINUTES),f=Ur({id:l,pairingTopic:r,expiry:p},a);await this.setProposal(l,f);const g=An(JSON.stringify(s)),E=await this.getVerifyContext(g,f.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:f,verifyContext:E})}catch(p){await this.sendError(l,r,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(_i(s)){const{result:l}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const p=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const f=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const g=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:g});const E=await this.client.core.crypto.generateSharedKey(f,g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:E});const I=await this.client.core.relayer.subscribe(E);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:I}),await this.client.core.pairing.activate({topic:r})}else Gr(s)&&(await this.client.proposal.delete(a,Rt("USER_DISCONNECTED")),this.events.emit(zt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidSessionSettleRequest(l);const{relay:p,controller:f,expiry:g,namespaces:E,requiredNamespaces:I,optionalNamespaces:N,sessionProperties:j,pairingTopic:R}=s.params,T=Ur({topic:r,relay:p,expiry:g,namespaces:E,acknowledged:!0,pairingTopic:R,requiredNamespaces:I,optionalNamespaces:N,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},j&&{sessionProperties:j});await this.sendResult(s.id,r,!0),this.events.emit(zt("session_connect"),{session:T}),this.cleanupDuplicatePairings(T)}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;_i(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(zt("session_approve",a),{})):Gr(s)&&(await this.client.session.delete(r,Rt("USER_DISCONNECTED")),this.events.emit(zt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:l}=s;try{this.isValidUpdate(Ur({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult(l,r,!0),this.client.events.emit("session_update",{id:l,topic:r,params:a})}catch(p){await this.sendError(l,r,p),this.client.logger.error(p)}},this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;_i(s)?this.events.emit(zt("session_update",a),{}):Gr(s)&&this.events.emit(zt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Vr(xo)),await this.sendResult(a,r,!0),this.client.events.emit("session_extend",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;_i(s)?this.events.emit(zt("session_extend",a),{}):Gr(s)&&this.events.emit(zt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult(a,r,!0),this.client.events.emit("session_ping",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{_i(s)?this.events.emit(zt("session_ping",a),{}):Gr(s)&&this.events.emit(zt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(Ct.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult(a,r,!0)]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidRequest(Ur({topic:r},l)),await this.setPendingSessionRequest({id:a,topic:r,params:l});const p=An(JSON.stringify(s)),f=this.client.session.get(r),g=await this.getVerifyContext(p,f.peer.metadata);this.client.events.emit("session_request",{id:a,topic:r,params:l,verifyContext:g})}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;_i(s)?this.events.emit(zt("session_request",a),{result:s.result}):Gr(s)&&this.events.emit(zt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidEmit(Ur({topic:r},l)),this.client.events.emit("session_event",{id:a,topic:r,params:l})}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.isValidConnect=async r=>{if(!vr(r)){const{message:g}=he("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(g)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:l,sessionProperties:p,relays:f}=r;if(ar(s)||await this.isValidPairingTopic(s),!CE(f,!0)){const{message:g}=he("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(g)}!ar(a)&&Pn(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!ar(l)&&Pn(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),ar(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=OE(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!vr(r))throw new Error(he("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:l,sessionProperties:p}=r;await this.isValidProposalId(s);const f=this.client.proposal.get(s),g=To(a,"approve()");if(g)throw new Error(g.message);const E=af(f.requiredNamespaces,a,"approve()");if(E)throw new Error(E.message);if(!Gt(l,!0)){const{message:I}=he("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(I)}ar(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async r=>{if(!vr(r)){const{message:l}=he("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!PE(a)){const{message:l}=he("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!vr(r)){const{message:E}=he("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(E)}const{relay:s,controller:a,namespaces:l,expiry:p}=r;if(!kd(s)){const{message:E}=he("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(E)}const f=wE(a,"onSessionSettleRequest()");if(f)throw new Error(f.message);const g=To(l,"onSessionSettleRequest()");if(g)throw new Error(g.message);if(Pi(p)){const{message:E}=he("EXPIRED","onSessionSettleRequest()");throw new Error(E)}},this.isValidUpdate=async r=>{if(!vr(r)){const{message:g}=he("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(g)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const l=this.client.session.get(s),p=To(a,"update()");if(p)throw new Error(p.message);const f=af(l.requiredNamespaces,a,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async r=>{if(!vr(r)){const{message:a}=he("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!vr(r)){const{message:g}=he("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(g)}const{topic:s,request:a,chainId:l,expiry:p}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!of(f,l)){const{message:g}=he("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(g)}if(!TE(a)){const{message:g}=he("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(g)}if(!FE(f,l,a.method)){const{message:g}=he("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(g)}if(p&&!$E(p,Mc)){const{message:g}=he("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${Mc.min} and ${Mc.max}`);throw new Error(g)}},this.isValidRespond=async r=>{if(!vr(r)){const{message:l}=he("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!NE(a)){const{message:l}=he("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!vr(r)){const{message:a}=he("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!vr(r)){const{message:f}=he("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(f)}const{topic:s,event:a,chainId:l}=r;await this.isValidSessionTopic(s);const{namespaces:p}=this.client.session.get(s);if(!of(p,l)){const{message:f}=he("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(f)}if(!RE(a)){const{message:f}=he("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}if(!UE(p,l,a.name)){const{message:f}=he("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}},this.isValidDisconnect=async r=>{if(!vr(r)){const{message:a}=he("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});l&&(a.verified.origin=l,a.verified.validation=l===s.url?"VALID":"INVALID")}catch(l){this.client.logger.error(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!Gt(a,!1)){const{message:l}=he("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(l)}})}}isInitialized(){if(!this.initialized){const{message:t}=he("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(Ct.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);Iu(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Yo(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})})}registerExpirerEvents(){this.client.core.expirer.on(Lr.expired,async t=>{const{topic:r,id:s}=Hd(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,he("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(t){if(!Gt(t,!1)){const{message:r}=he("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=he("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Pi(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=he("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Gt(t,!1)){const{message:r}=he("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=he("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Pi(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=he("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Gt(t,!1)){const{message:r}=he("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=he("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!AE(t)){const{message:r}=he("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=he("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Pi(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=he("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class U2 extends Xo{constructor(t,r){super(t,r,S2,Cu),this.core=t,this.logger=r}}class L2 extends Xo{constructor(t,r){super(t,r,I2,Cu),this.core=t,this.logger=r}}class M2 extends Xo{constructor(t,r){super(t,r,O2,Cu,s=>s.id),this.core=t,this.logger=r}}let $2=class Ip extends l3{constructor(t){super(t),this.protocol=wp,this.version=Ep,this.name=Lc.name,this.events=new $r.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Lc.name,this.metadata=(t==null?void 0:t.metadata)||Vw();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Lc.logger}));this.core=(t==null?void 0:t.core)||new E2(t),this.logger=Qe.generateChildLogger(r,this.name),this.session=new L2(this.core,this.logger),this.proposal=new U2(this.core,this.logger),this.pendingRequest=new M2(this.core,this.logger),this.engine=new F2(this)}static async init(t){const r=new Ip(t);return await r.initialize(),r}get context(){return Qe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var tu={exports:{}};(function(n,t){var r=typeof self<"u"?self:yr,s=function(){function l(){this.fetch=!1,this.DOMException=r.DOMException}return l.prototype=r,new l}();(function(l){(function(p){var f={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function g(b){return b&&DataView.prototype.isPrototypeOf(b)}if(f.arrayBuffer)var E=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],I=ArrayBuffer.isView||function(b){return b&&E.indexOf(Object.prototype.toString.call(b))>-1};function N(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(b))throw new TypeError("Invalid character in header field name");return b.toLowerCase()}function j(b){return typeof b!="string"&&(b=String(b)),b}function R(b){var x={next:function(){var ee=b.shift();return{done:ee===void 0,value:ee}}};return f.iterable&&(x[Symbol.iterator]=function(){return x}),x}function T(b){this.map={},b instanceof T?b.forEach(function(x,ee){this.append(ee,x)},this):Array.isArray(b)?b.forEach(function(x){this.append(x[0],x[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(x){this.append(x,b[x])},this)}T.prototype.append=function(b,x){b=N(b),x=j(x);var ee=this.map[b];this.map[b]=ee?ee+", "+x:x},T.prototype.delete=function(b){delete this.map[N(b)]},T.prototype.get=function(b){return b=N(b),this.has(b)?this.map[b]:null},T.prototype.has=function(b){return this.map.hasOwnProperty(N(b))},T.prototype.set=function(b,x){this.map[N(b)]=j(x)},T.prototype.forEach=function(b,x){for(var ee in this.map)this.map.hasOwnProperty(ee)&&b.call(x,this.map[ee],ee,this)},T.prototype.keys=function(){var b=[];return this.forEach(function(x,ee){b.push(ee)}),R(b)},T.prototype.values=function(){var b=[];return this.forEach(function(x){b.push(x)}),R(b)},T.prototype.entries=function(){var b=[];return this.forEach(function(x,ee){b.push([ee,x])}),R(b)},f.iterable&&(T.prototype[Symbol.iterator]=T.prototype.entries);function z(b){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}function K(b){return new Promise(function(x,ee){b.onload=function(){x(b.result)},b.onerror=function(){ee(b.error)}})}function se(b){var x=new FileReader,ee=K(x);return x.readAsArrayBuffer(b),ee}function P(b){var x=new FileReader,ee=K(x);return x.readAsText(b),ee}function L(b){for(var x=new Uint8Array(b),ee=new Array(x.length),X=0;X<x.length;X++)ee[X]=String.fromCharCode(x[X]);return ee.join("")}function D(b){if(b.slice)return b.slice(0);var x=new Uint8Array(b.byteLength);return x.set(new Uint8Array(b)),x.buffer}function C(){return this.bodyUsed=!1,this._initBody=function(b){this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:f.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:f.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():f.arrayBuffer&&f.blob&&g(b)?(this._bodyArrayBuffer=D(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||I(b))?this._bodyArrayBuffer=D(b):this._bodyText=b=Object.prototype.toString.call(b):this._bodyText="",this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var b=z(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?z(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(se)}),this.text=function(){var b=z(this);if(b)return b;if(this._bodyBlob)return P(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(L(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(G)}),this.json=function(){return this.text().then(JSON.parse)},this}var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function c(b){var x=b.toUpperCase();return m.indexOf(x)>-1?x:b}function _(b,x){x=x||{};var ee=x.body;if(b instanceof _){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,x.headers||(this.headers=new T(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!ee&&b._bodyInit!=null&&(ee=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=x.credentials||this.credentials||"same-origin",(x.headers||!this.headers)&&(this.headers=new T(x.headers)),this.method=c(x.method||this.method||"GET"),this.mode=x.mode||this.mode||null,this.signal=x.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})};function G(b){var x=new FormData;return b.trim().split("&").forEach(function(ee){if(ee){var X=ee.split("="),k=X.shift().replace(/\+/g," "),V=X.join("=").replace(/\+/g," ");x.append(decodeURIComponent(k),decodeURIComponent(V))}}),x}function W(b){var x=new T,ee=b.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(X){var k=X.split(":"),V=k.shift().trim();if(V){var J=k.join(":").trim();x.append(V,J)}}),x}C.call(_.prototype);function ne(b,x){x||(x={}),this.type="default",this.status=x.status===void 0?200:x.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in x?x.statusText:"OK",this.headers=new T(x.headers),this.url=x.url||"",this._initBody(b)}C.call(ne.prototype),ne.prototype.clone=function(){return new ne(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new T(this.headers),url:this.url})},ne.error=function(){var b=new ne(null,{status:0,statusText:""});return b.type="error",b};var ce=[301,302,303,307,308];ne.redirect=function(b,x){if(ce.indexOf(x)===-1)throw new RangeError("Invalid status code");return new ne(null,{status:x,headers:{location:b}})},p.DOMException=l.DOMException;try{new p.DOMException}catch{p.DOMException=function(x,ee){this.message=x,this.name=ee;var X=Error(x);this.stack=X.stack},p.DOMException.prototype=Object.create(Error.prototype),p.DOMException.prototype.constructor=p.DOMException}function de(b,x){return new Promise(function(ee,X){var k=new _(b,x);if(k.signal&&k.signal.aborted)return X(new p.DOMException("Aborted","AbortError"));var V=new XMLHttpRequest;function J(){V.abort()}V.onload=function(){var re={status:V.status,statusText:V.statusText,headers:W(V.getAllResponseHeaders()||"")};re.url="responseURL"in V?V.responseURL:re.headers.get("X-Request-URL");var me="response"in V?V.response:V.responseText;ee(new ne(me,re))},V.onerror=function(){X(new TypeError("Network request failed"))},V.ontimeout=function(){X(new TypeError("Network request failed"))},V.onabort=function(){X(new p.DOMException("Aborted","AbortError"))},V.open(k.method,k.url,!0),k.credentials==="include"?V.withCredentials=!0:k.credentials==="omit"&&(V.withCredentials=!1),"responseType"in V&&f.blob&&(V.responseType="blob"),k.headers.forEach(function(re,me){V.setRequestHeader(me,re)}),k.signal&&(k.signal.addEventListener("abort",J),V.onreadystatechange=function(){V.readyState===4&&k.signal.removeEventListener("abort",J)}),V.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return de.polyfill=!0,l.fetch||(l.fetch=de,l.Headers=T,l.Request=_,l.Response=ne),p.Headers=T,p.Request=_,p.Response=ne,p.fetch=de,Object.defineProperty(p,"__esModule",{value:!0}),p})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var a=s;t=a.fetch,t.default=a.fetch,t.fetch=a.fetch,t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response,n.exports=t})(tu,tu.exports);var j2=tu.exports;const Qf=dd(j2),B2={Accept:"application/json","Content-Type":"application/json"},q2="POST",ed={headers:B2,method:q2},td=10;class sn{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new $r.EventEmitter,this.isAvailable=!1,this.registering=!1,!Cf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=gs(t),l=await(await Qf(this.url,Object.assign(Object.assign({},ed),{body:s}))).json();this.onPayload({data:l})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!Cf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=gs({id:1,jsonrpc:"2.0",method:"test",params:[]});await Qf(t,Object.assign(Object.assign({},ed),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?mu(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),l=Wo(t,a);this.events.emit("payload",l)}parseError(t,r=this.url){return rp(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>td&&this.events.setMaxListeners(td)}}const rd="error",z2="wss://relay.walletconnect.com",H2="wc",K2="universal_provider",id=`${H2}@2:${K2}:`,k2="https://rpc.walletconnect.com/v1",Ui={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ls=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ru={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",f="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",E=500,I="__lodash_placeholder__",N=1,j=2,R=4,T=1,z=2,K=1,se=2,P=4,L=8,D=16,C=32,m=64,c=128,_=256,G=512,W=30,ne="...",ce=800,de=16,b=1,x=2,ee=3,X=1/0,k=9007199254740991,V=17976931348623157e292,J=0/0,re=4294967295,me=re-1,oe=re>>>1,we=[["ary",c],["bind",K],["bindKey",se],["curry",L],["curryRight",D],["flip",G],["partial",C],["partialRight",m],["rearg",_]],le="[object Arguments]",_e="[object Array]",q="[object AsyncFunction]",B="[object Boolean]",F="[object Date]",h="[object DOMException]",O="[object Error]",ae="[object Function]",fe="[object GeneratorFunction]",Ie="[object Map]",ze="[object Number]",ke="[object Null]",Me="[object Object]",pt="[object Promise]",gt="[object Proxy]",je="[object RegExp]",xe="[object Set]",Re="[object String]",Fe="[object Symbol]",Be="[object Undefined]",Ce="[object WeakMap]",Ue="[object WeakSet]",Se="[object ArrayBuffer]",Ae="[object DataView]",He="[object Float32Array]",Oe="[object Float64Array]",Ve="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Je="[object Uint8ClampedArray]",er="[object Uint16Array]",hr="[object Uint32Array]",Wr=/\b__p \+= '';/g,tr=/\b(__p \+=) '' \+/g,ni=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bi=/&(?:amp|lt|gt|quot|#39);/g,Li=/[&<>"']/g,wt=RegExp(bi.source),vt=RegExp(Li.source),Et=/<%-([\s\S]+?)%>/g,Dt=/<%([\s\S]+?)%>/g,bt=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ut=/^\w*$/,Lt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,St=/[\\^$.*+?()[\]{}|]/g,Mt=RegExp(St.source),It=/^\s+/,At=/\s/,xt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,$t=/,? & /,jt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Zo=/[()=,{}\[\]\/\s]/,Qo=/\\(\\)?/g,ea=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,ta=/^[-+]0x[0-9a-f]+$/i,ra=/^0b[01]+$/i,ia=/^\[object .+?Constructor\]$/,na=/^0o[0-7]+$/i,sa=/^(?:0|[1-9]\d*)$/,si=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,on=/($^)/,oa=/['\n\r\u2028\u2029\\]/g,an="\\ud800-\\udfff",aa="\\u0300-\\u036f",ca="\\ufe20-\\ufe2f",cn="\\u20d0-\\u20ff",ws=aa+ca+cn,Es="\\u2700-\\u27bf",Br="a-z\\xdf-\\xf6\\xf8-\\xff",ua="\\xac\\xb1\\xd7\\xf7",ha="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",la="\\u2000-\\u206f",fa=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ds="A-Z\\xc0-\\xd6\\xd8-\\xde",Ss="\\ufe0e\\ufe0f",Mi=ua+ha+la+fa,Un="['’]",$i="["+an+"]",Ln="["+Mi+"]",ji="["+ws+"]",Is="\\d+",da="["+Es+"]",xs="["+Br+"]",Os="[^"+an+Mi+Is+Es+Br+Ds+"]",un="\\ud83c[\\udffb-\\udfff]",pa="(?:"+ji+"|"+un+")",Cs="[^"+an+"]",hn="(?:\\ud83c[\\udde6-\\uddff]){2}",mi="[\\ud800-\\udbff][\\udc00-\\udfff]",br="["+Ds+"]",As="\\u200d",Ps="(?:"+xs+"|"+Os+")",Yr="(?:"+br+"|"+Os+")",Ts="(?:"+Un+"(?:d|ll|m|re|s|t|ve))?",Ns="(?:"+Un+"(?:D|LL|M|RE|S|T|VE))?",Rs=pa+"?",Fs="["+Ss+"]?",ga="(?:"+As+"(?:"+[Cs,hn,mi].join("|")+")"+Fs+Rs+")*",oi="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Us="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ls=Fs+Rs+ga,ln="(?:"+[da,hn,mi].join("|")+")"+Ls,va="(?:"+[Cs+ji+"?",ji,hn,mi,$i].join("|")+")",Mn=RegExp(Un,"g"),ya=RegExp(ji,"g"),fn=RegExp(un+"(?="+un+")|"+va+Ls,"g"),Ms=RegExp([br+"?"+xs+"+"+Ts+"(?="+[Ln,br,"$"].join("|")+")",Yr+"+"+Ns+"(?="+[Ln,br+Ps,"$"].join("|")+")",br+"?"+Ps+"+"+Ts,br+"+"+Ns,Us,oi,Is,ln].join("|"),"g"),$s=RegExp("["+As+an+ws+Ss+"]"),Bi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,js=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],_a=-1,ot={};ot[He]=ot[Oe]=ot[Ve]=ot[We]=ot[et]=ot[tt]=ot[Je]=ot[er]=ot[hr]=!0,ot[le]=ot[_e]=ot[Se]=ot[B]=ot[Ae]=ot[F]=ot[O]=ot[ae]=ot[Ie]=ot[ze]=ot[Me]=ot[je]=ot[xe]=ot[Re]=ot[Ce]=!1;var st={};st[le]=st[_e]=st[Se]=st[Ae]=st[B]=st[F]=st[He]=st[Oe]=st[Ve]=st[We]=st[et]=st[Ie]=st[ze]=st[Me]=st[je]=st[xe]=st[Re]=st[Fe]=st[tt]=st[Je]=st[er]=st[hr]=!0,st[O]=st[ae]=st[Ce]=!1;var w={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,Te=parseInt,ft=typeof ls=="object"&&ls&&ls.Object===Object&&ls,Bt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=ft||Bt||Function("return this")(),ct=t&&!t.nodeType&&t,Pt=ct&&!0&&n&&!n.nodeType&&n,lr=Pt&&Pt.exports===ct,qt=lr&&ft.process,dt=function(){try{var M=Pt&&Pt.require&&Pt.require("util").types;return M||qt&&qt.binding&&qt.binding("util")}catch{}}(),rr=dt&&dt.isArrayBuffer,qr=dt&&dt.isDate,Or=dt&&dt.isMap,Jr=dt&&dt.isRegExp,$n=dt&&dt.isSet,qi=dt&&dt.isTypedArray;function kt(M,Y,H){switch(H.length){case 0:return M.call(Y);case 1:return M.call(Y,H[0]);case 2:return M.call(Y,H[0],H[1]);case 3:return M.call(Y,H[0],H[1],H[2])}return M.apply(Y,H)}function Cp(M,Y,H,ge){for(var Pe=-1,rt=M==null?0:M.length;++Pe<rt;){var Ht=M[Pe];Y(ge,Ht,H(Ht),M)}return ge}function Cr(M,Y){for(var H=-1,ge=M==null?0:M.length;++H<ge&&Y(M[H],H,M)!==!1;);return M}function Ap(M,Y){for(var H=M==null?0:M.length;H--&&Y(M[H],H,M)!==!1;);return M}function Tu(M,Y){for(var H=-1,ge=M==null?0:M.length;++H<ge;)if(!Y(M[H],H,M))return!1;return!0}function wi(M,Y){for(var H=-1,ge=M==null?0:M.length,Pe=0,rt=[];++H<ge;){var Ht=M[H];Y(Ht,H,M)&&(rt[Pe++]=Ht)}return rt}function Bs(M,Y){var H=M==null?0:M.length;return!!H&&dn(M,Y,0)>-1}function ba(M,Y,H){for(var ge=-1,Pe=M==null?0:M.length;++ge<Pe;)if(H(Y,M[ge]))return!0;return!1}function _t(M,Y){for(var H=-1,ge=M==null?0:M.length,Pe=Array(ge);++H<ge;)Pe[H]=Y(M[H],H,M);return Pe}function Ei(M,Y){for(var H=-1,ge=Y.length,Pe=M.length;++H<ge;)M[Pe+H]=Y[H];return M}function ma(M,Y,H,ge){var Pe=-1,rt=M==null?0:M.length;for(ge&&rt&&(H=M[++Pe]);++Pe<rt;)H=Y(H,M[Pe],Pe,M);return H}function Pp(M,Y,H,ge){var Pe=M==null?0:M.length;for(ge&&Pe&&(H=M[--Pe]);Pe--;)H=Y(H,M[Pe],Pe,M);return H}function wa(M,Y){for(var H=-1,ge=M==null?0:M.length;++H<ge;)if(Y(M[H],H,M))return!0;return!1}var Tp=Ea("length");function Np(M){return M.split("")}function Rp(M){return M.match(jt)||[]}function Nu(M,Y,H){var ge;return H(M,function(Pe,rt,Ht){if(Y(Pe,rt,Ht))return ge=rt,!1}),ge}function qs(M,Y,H,ge){for(var Pe=M.length,rt=H+(ge?1:-1);ge?rt--:++rt<Pe;)if(Y(M[rt],rt,M))return rt;return-1}function dn(M,Y,H){return Y===Y?kp(M,Y,H):qs(M,Ru,H)}function Fp(M,Y,H,ge){for(var Pe=H-1,rt=M.length;++Pe<rt;)if(ge(M[Pe],Y))return Pe;return-1}function Ru(M){return M!==M}function Fu(M,Y){var H=M==null?0:M.length;return H?Sa(M,Y)/H:J}function Ea(M){return function(Y){return Y==null?r:Y[M]}}function Da(M){return function(Y){return M==null?r:M[Y]}}function Uu(M,Y,H,ge,Pe){return Pe(M,function(rt,Ht,ut){H=ge?(ge=!1,rt):Y(H,rt,Ht,ut)}),H}function Up(M,Y){var H=M.length;for(M.sort(Y);H--;)M[H]=M[H].value;return M}function Sa(M,Y){for(var H,ge=-1,Pe=M.length;++ge<Pe;){var rt=Y(M[ge]);rt!==r&&(H=H===r?rt:H+rt)}return H}function Ia(M,Y){for(var H=-1,ge=Array(M);++H<M;)ge[H]=Y(H);return ge}function Lp(M,Y){return _t(Y,function(H){return[H,M[H]]})}function Lu(M){return M&&M.slice(0,Bu(M)+1).replace(It,"")}function mr(M){return function(Y){return M(Y)}}function xa(M,Y){return _t(Y,function(H){return M[H]})}function jn(M,Y){return M.has(Y)}function Mu(M,Y){for(var H=-1,ge=M.length;++H<ge&&dn(Y,M[H],0)>-1;);return H}function $u(M,Y){for(var H=M.length;H--&&dn(Y,M[H],0)>-1;);return H}function Mp(M,Y){for(var H=M.length,ge=0;H--;)M[H]===Y&&++ge;return ge}var $p=Da(w),jp=Da(U);function Bp(M){return"\\"+pe[M]}function qp(M,Y){return M==null?r:M[Y]}function pn(M){return $s.test(M)}function zp(M){return Bi.test(M)}function Hp(M){for(var Y,H=[];!(Y=M.next()).done;)H.push(Y.value);return H}function Oa(M){var Y=-1,H=Array(M.size);return M.forEach(function(ge,Pe){H[++Y]=[Pe,ge]}),H}function ju(M,Y){return function(H){return M(Y(H))}}function Di(M,Y){for(var H=-1,ge=M.length,Pe=0,rt=[];++H<ge;){var Ht=M[H];(Ht===Y||Ht===I)&&(M[H]=I,rt[Pe++]=H)}return rt}function zs(M){var Y=-1,H=Array(M.size);return M.forEach(function(ge){H[++Y]=ge}),H}function Kp(M){var Y=-1,H=Array(M.size);return M.forEach(function(ge){H[++Y]=[ge,ge]}),H}function kp(M,Y,H){for(var ge=H-1,Pe=M.length;++ge<Pe;)if(M[ge]===Y)return ge;return-1}function Vp(M,Y,H){for(var ge=H+1;ge--;)if(M[ge]===Y)return ge;return ge}function gn(M){return pn(M)?Wp(M):Tp(M)}function zr(M){return pn(M)?Yp(M):Np(M)}function Bu(M){for(var Y=M.length;Y--&&At.test(M.charAt(Y)););return Y}var Gp=Da(te);function Wp(M){for(var Y=fn.lastIndex=0;fn.test(M);)++Y;return Y}function Yp(M){return M.match(fn)||[]}function Jp(M){return M.match(Ms)||[]}var Xp=function M(Y){Y=Y==null?Xe:vn.defaults(Xe.Object(),Y,vn.pick(Xe,js));var H=Y.Array,ge=Y.Date,Pe=Y.Error,rt=Y.Function,Ht=Y.Math,ut=Y.Object,Ca=Y.RegExp,Zp=Y.String,Ar=Y.TypeError,Hs=H.prototype,Qp=rt.prototype,yn=ut.prototype,Ks=Y["__core-js_shared__"],ks=Qp.toString,nt=yn.hasOwnProperty,eg=0,qu=function(){var e=/[^.]+$/.exec(Ks&&Ks.keys&&Ks.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Vs=yn.toString,tg=ks.call(ut),rg=Xe._,ig=Ca("^"+ks.call(nt).replace(St,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Gs=lr?Y.Buffer:r,Si=Y.Symbol,Ws=Y.Uint8Array,zu=Gs?Gs.allocUnsafe:r,Ys=ju(ut.getPrototypeOf,ut),Hu=ut.create,Ku=yn.propertyIsEnumerable,Js=Hs.splice,ku=Si?Si.isConcatSpreadable:r,Bn=Si?Si.iterator:r,zi=Si?Si.toStringTag:r,Xs=function(){try{var e=Gi(ut,"defineProperty");return e({},"",{}),e}catch{}}(),ng=Y.clearTimeout!==Xe.clearTimeout&&Y.clearTimeout,sg=ge&&ge.now!==Xe.Date.now&&ge.now,og=Y.setTimeout!==Xe.setTimeout&&Y.setTimeout,Zs=Ht.ceil,Qs=Ht.floor,Aa=ut.getOwnPropertySymbols,ag=Gs?Gs.isBuffer:r,Vu=Y.isFinite,cg=Hs.join,ug=ju(ut.keys,ut),Kt=Ht.max,Xt=Ht.min,hg=ge.now,lg=Y.parseInt,Gu=Ht.random,fg=Hs.reverse,Pa=Gi(Y,"DataView"),qn=Gi(Y,"Map"),Ta=Gi(Y,"Promise"),_n=Gi(Y,"Set"),zn=Gi(Y,"WeakMap"),Hn=Gi(ut,"create"),eo=zn&&new zn,bn={},dg=Wi(Pa),pg=Wi(qn),gg=Wi(Ta),vg=Wi(_n),yg=Wi(zn),to=Si?Si.prototype:r,Kn=to?to.valueOf:r,Wu=to?to.toString:r;function v(e){if(Ot(e)&&!Ne(e)&&!(e instanceof Ye)){if(e instanceof Pr)return e;if(nt.call(e,"__wrapped__"))return Yh(e)}return new Pr(e)}var mn=function(){function e(){}return function(i){if(!mt(i))return{};if(Hu)return Hu(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function ro(){}function Pr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}v.templateSettings={escape:Et,evaluate:Dt,interpolate:bt,variable:"",imports:{_:v}},v.prototype=ro.prototype,v.prototype.constructor=v,Pr.prototype=mn(ro.prototype),Pr.prototype.constructor=Pr;function Ye(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function _g(){var e=new Ye(this.__wrapped__);return e.__actions__=fr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=fr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=fr(this.__views__),e}function bg(){if(this.__filtered__){var e=new Ye(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function mg(){var e=this.__wrapped__.value(),i=this.__dir__,o=Ne(e),u=i<0,d=o?e.length:0,y=N0(0,d,this.__views__),S=y.start,A=y.end,$=A-S,Z=u?A:S-1,Q=this.__iteratees__,ie=Q.length,ue=0,ve=Xt($,this.__takeCount__);if(!o||!u&&d==$&&ve==$)return _h(e,this.__actions__);var Ee=[];e:for(;$--&&ue<ve;){Z+=i;for(var qe=-1,De=e[Z];++qe<ie;){var Ge=Q[qe],Ze=Ge.iteratee,Dr=Ge.type,sr=Ze(De);if(Dr==x)De=sr;else if(!sr){if(Dr==b)continue e;break e}}Ee[ue++]=De}return Ee}Ye.prototype=mn(ro.prototype),Ye.prototype.constructor=Ye;function Hi(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function wg(){this.__data__=Hn?Hn(null):{},this.size=0}function Eg(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Dg(e){var i=this.__data__;if(Hn){var o=i[e];return o===g?r:o}return nt.call(i,e)?i[e]:r}function Sg(e){var i=this.__data__;return Hn?i[e]!==r:nt.call(i,e)}function Ig(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Hn&&i===r?g:i,this}Hi.prototype.clear=wg,Hi.prototype.delete=Eg,Hi.prototype.get=Dg,Hi.prototype.has=Sg,Hi.prototype.set=Ig;function ai(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function xg(){this.__data__=[],this.size=0}function Og(e){var i=this.__data__,o=io(i,e);if(o<0)return!1;var u=i.length-1;return o==u?i.pop():Js.call(i,o,1),--this.size,!0}function Cg(e){var i=this.__data__,o=io(i,e);return o<0?r:i[o][1]}function Ag(e){return io(this.__data__,e)>-1}function Pg(e,i){var o=this.__data__,u=io(o,e);return u<0?(++this.size,o.push([e,i])):o[u][1]=i,this}ai.prototype.clear=xg,ai.prototype.delete=Og,ai.prototype.get=Cg,ai.prototype.has=Ag,ai.prototype.set=Pg;function ci(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function Tg(){this.size=0,this.__data__={hash:new Hi,map:new(qn||ai),string:new Hi}}function Ng(e){var i=vo(this,e).delete(e);return this.size-=i?1:0,i}function Rg(e){return vo(this,e).get(e)}function Fg(e){return vo(this,e).has(e)}function Ug(e,i){var o=vo(this,e),u=o.size;return o.set(e,i),this.size+=o.size==u?0:1,this}ci.prototype.clear=Tg,ci.prototype.delete=Ng,ci.prototype.get=Rg,ci.prototype.has=Fg,ci.prototype.set=Ug;function Ki(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new ci;++i<o;)this.add(e[i])}function Lg(e){return this.__data__.set(e,g),this}function Mg(e){return this.__data__.has(e)}Ki.prototype.add=Ki.prototype.push=Lg,Ki.prototype.has=Mg;function Hr(e){var i=this.__data__=new ai(e);this.size=i.size}function $g(){this.__data__=new ai,this.size=0}function jg(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function Bg(e){return this.__data__.get(e)}function qg(e){return this.__data__.has(e)}function zg(e,i){var o=this.__data__;if(o instanceof ai){var u=o.__data__;if(!qn||u.length<a-1)return u.push([e,i]),this.size=++o.size,this;o=this.__data__=new ci(u)}return o.set(e,i),this.size=o.size,this}Hr.prototype.clear=$g,Hr.prototype.delete=jg,Hr.prototype.get=Bg,Hr.prototype.has=qg,Hr.prototype.set=zg;function Yu(e,i){var o=Ne(e),u=!o&&Yi(e),d=!o&&!u&&Ai(e),y=!o&&!u&&!d&&Sn(e),S=o||u||d||y,A=S?Ia(e.length,Zp):[],$=A.length;for(var Z in e)(i||nt.call(e,Z))&&!(S&&(Z=="length"||d&&(Z=="offset"||Z=="parent")||y&&(Z=="buffer"||Z=="byteLength"||Z=="byteOffset")||fi(Z,$)))&&A.push(Z);return A}function Ju(e){var i=e.length;return i?e[za(0,i-1)]:r}function Hg(e,i){return yo(fr(e),ki(i,0,e.length))}function Kg(e){return yo(fr(e))}function Na(e,i,o){(o!==r&&!Kr(e[i],o)||o===r&&!(i in e))&&ui(e,i,o)}function kn(e,i,o){var u=e[i];(!(nt.call(e,i)&&Kr(u,o))||o===r&&!(i in e))&&ui(e,i,o)}function io(e,i){for(var o=e.length;o--;)if(Kr(e[o][0],i))return o;return-1}function kg(e,i,o,u){return Ii(e,function(d,y,S){i(u,d,o(d),S)}),u}function Xu(e,i){return e&&Zr(i,Vt(i),e)}function Vg(e,i){return e&&Zr(i,pr(i),e)}function ui(e,i,o){i=="__proto__"&&Xs?Xs(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function Ra(e,i){for(var o=-1,u=i.length,d=H(u),y=e==null;++o<u;)d[o]=y?r:dc(e,i[o]);return d}function ki(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Tr(e,i,o,u,d,y){var S,A=i&N,$=i&j,Z=i&R;if(o&&(S=d?o(e,u,d,y):o(e)),S!==r)return S;if(!mt(e))return e;var Q=Ne(e);if(Q){if(S=F0(e),!A)return fr(e,S)}else{var ie=Zt(e),ue=ie==ae||ie==fe;if(Ai(e))return wh(e,A);if(ie==Me||ie==le||ue&&!d){if(S=$||ue?{}:Bh(e),!A)return $?D0(e,Vg(S,e)):E0(e,Xu(S,e))}else{if(!st[ie])return d?e:{};S=U0(e,ie,A)}}y||(y=new Hr);var ve=y.get(e);if(ve)return ve;y.set(e,S),gl(e)?e.forEach(function(De){S.add(Tr(De,i,o,De,e,y))}):dl(e)&&e.forEach(function(De,Ge){S.set(Ge,Tr(De,i,o,Ge,e,y))});var Ee=Z?$?Qa:Za:$?pr:Vt,qe=Q?r:Ee(e);return Cr(qe||e,function(De,Ge){qe&&(Ge=De,De=e[Ge]),kn(S,Ge,Tr(De,i,o,Ge,e,y))}),S}function Gg(e){var i=Vt(e);return function(o){return Zu(o,e,i)}}function Zu(e,i,o){var u=o.length;if(e==null)return!u;for(e=ut(e);u--;){var d=o[u],y=i[d],S=e[d];if(S===r&&!(d in e)||!y(S))return!1}return!0}function Qu(e,i,o){if(typeof e!="function")throw new Ar(p);return Zn(function(){e.apply(r,o)},i)}function Vn(e,i,o,u){var d=-1,y=Bs,S=!0,A=e.length,$=[],Z=i.length;if(!A)return $;o&&(i=_t(i,mr(o))),u?(y=ba,S=!1):i.length>=a&&(y=jn,S=!1,i=new Ki(i));e:for(;++d<A;){var Q=e[d],ie=o==null?Q:o(Q);if(Q=u||Q!==0?Q:0,S&&ie===ie){for(var ue=Z;ue--;)if(i[ue]===ie)continue e;$.push(Q)}else y(i,ie,u)||$.push(Q)}return $}var Ii=xh(Xr),eh=xh(Ua,!0);function Wg(e,i){var o=!0;return Ii(e,function(u,d,y){return o=!!i(u,d,y),o}),o}function no(e,i,o){for(var u=-1,d=e.length;++u<d;){var y=e[u],S=i(y);if(S!=null&&(A===r?S===S&&!Er(S):o(S,A)))var A=S,$=y}return $}function Yg(e,i,o,u){var d=e.length;for(o=$e(o),o<0&&(o=-o>d?0:d+o),u=u===r||u>d?d:$e(u),u<0&&(u+=d),u=o>u?0:yl(u);o<u;)e[o++]=i;return e}function th(e,i){var o=[];return Ii(e,function(u,d,y){i(u,d,y)&&o.push(u)}),o}function Wt(e,i,o,u,d){var y=-1,S=e.length;for(o||(o=M0),d||(d=[]);++y<S;){var A=e[y];i>0&&o(A)?i>1?Wt(A,i-1,o,u,d):Ei(d,A):u||(d[d.length]=A)}return d}var Fa=Oh(),rh=Oh(!0);function Xr(e,i){return e&&Fa(e,i,Vt)}function Ua(e,i){return e&&rh(e,i,Vt)}function so(e,i){return wi(i,function(o){return di(e[o])})}function Vi(e,i){i=Oi(i,e);for(var o=0,u=i.length;e!=null&&o<u;)e=e[Qr(i[o++])];return o&&o==u?e:r}function ih(e,i,o){var u=i(e);return Ne(e)?u:Ei(u,o(e))}function ir(e){return e==null?e===r?Be:ke:zi&&zi in ut(e)?T0(e):K0(e)}function La(e,i){return e>i}function Jg(e,i){return e!=null&&nt.call(e,i)}function Xg(e,i){return e!=null&&i in ut(e)}function Zg(e,i,o){return e>=Xt(i,o)&&e<Kt(i,o)}function Ma(e,i,o){for(var u=o?ba:Bs,d=e[0].length,y=e.length,S=y,A=H(y),$=1/0,Z=[];S--;){var Q=e[S];S&&i&&(Q=_t(Q,mr(i))),$=Xt(Q.length,$),A[S]=!o&&(i||d>=120&&Q.length>=120)?new Ki(S&&Q):r}Q=e[0];var ie=-1,ue=A[0];e:for(;++ie<d&&Z.length<$;){var ve=Q[ie],Ee=i?i(ve):ve;if(ve=o||ve!==0?ve:0,!(ue?jn(ue,Ee):u(Z,Ee,o))){for(S=y;--S;){var qe=A[S];if(!(qe?jn(qe,Ee):u(e[S],Ee,o)))continue e}ue&&ue.push(Ee),Z.push(ve)}}return Z}function Qg(e,i,o,u){return Xr(e,function(d,y,S){i(u,o(d),y,S)}),u}function Gn(e,i,o){i=Oi(i,e),e=Kh(e,i);var u=e==null?e:e[Qr(Rr(i))];return u==null?r:kt(u,e,o)}function nh(e){return Ot(e)&&ir(e)==le}function e0(e){return Ot(e)&&ir(e)==Se}function t0(e){return Ot(e)&&ir(e)==F}function Wn(e,i,o,u,d){return e===i?!0:e==null||i==null||!Ot(e)&&!Ot(i)?e!==e&&i!==i:r0(e,i,o,u,Wn,d)}function r0(e,i,o,u,d,y){var S=Ne(e),A=Ne(i),$=S?_e:Zt(e),Z=A?_e:Zt(i);$=$==le?Me:$,Z=Z==le?Me:Z;var Q=$==Me,ie=Z==Me,ue=$==Z;if(ue&&Ai(e)){if(!Ai(i))return!1;S=!0,Q=!1}if(ue&&!Q)return y||(y=new Hr),S||Sn(e)?Mh(e,i,o,u,d,y):A0(e,i,$,o,u,d,y);if(!(o&T)){var ve=Q&&nt.call(e,"__wrapped__"),Ee=ie&&nt.call(i,"__wrapped__");if(ve||Ee){var qe=ve?e.value():e,De=Ee?i.value():i;return y||(y=new Hr),d(qe,De,o,u,y)}}return ue?(y||(y=new Hr),P0(e,i,o,u,d,y)):!1}function i0(e){return Ot(e)&&Zt(e)==Ie}function $a(e,i,o,u){var d=o.length,y=d,S=!u;if(e==null)return!y;for(e=ut(e);d--;){var A=o[d];if(S&&A[2]?A[1]!==e[A[0]]:!(A[0]in e))return!1}for(;++d<y;){A=o[d];var $=A[0],Z=e[$],Q=A[1];if(S&&A[2]){if(Z===r&&!($ in e))return!1}else{var ie=new Hr;if(u)var ue=u(Z,Q,$,e,i,ie);if(!(ue===r?Wn(Q,Z,T|z,u,ie):ue))return!1}}return!0}function sh(e){if(!mt(e)||j0(e))return!1;var i=di(e)?ig:ia;return i.test(Wi(e))}function n0(e){return Ot(e)&&ir(e)==je}function s0(e){return Ot(e)&&Zt(e)==xe}function o0(e){return Ot(e)&&Do(e.length)&&!!ot[ir(e)]}function oh(e){return typeof e=="function"?e:e==null?gr:typeof e=="object"?Ne(e)?uh(e[0],e[1]):ch(e):Cl(e)}function ja(e){if(!Xn(e))return ug(e);var i=[];for(var o in ut(e))nt.call(e,o)&&o!="constructor"&&i.push(o);return i}function a0(e){if(!mt(e))return H0(e);var i=Xn(e),o=[];for(var u in e)u=="constructor"&&(i||!nt.call(e,u))||o.push(u);return o}function Ba(e,i){return e<i}function ah(e,i){var o=-1,u=dr(e)?H(e.length):[];return Ii(e,function(d,y,S){u[++o]=i(d,y,S)}),u}function ch(e){var i=tc(e);return i.length==1&&i[0][2]?zh(i[0][0],i[0][1]):function(o){return o===e||$a(o,e,i)}}function uh(e,i){return ic(e)&&qh(i)?zh(Qr(e),i):function(o){var u=dc(o,e);return u===r&&u===i?pc(o,e):Wn(i,u,T|z)}}function oo(e,i,o,u,d){e!==i&&Fa(i,function(y,S){if(d||(d=new Hr),mt(y))c0(e,i,S,o,oo,u,d);else{var A=u?u(sc(e,S),y,S+"",e,i,d):r;A===r&&(A=y),Na(e,S,A)}},pr)}function c0(e,i,o,u,d,y,S){var A=sc(e,o),$=sc(i,o),Z=S.get($);if(Z){Na(e,o,Z);return}var Q=y?y(A,$,o+"",e,i,S):r,ie=Q===r;if(ie){var ue=Ne($),ve=!ue&&Ai($),Ee=!ue&&!ve&&Sn($);Q=$,ue||ve||Ee?Ne(A)?Q=A:Tt(A)?Q=fr(A):ve?(ie=!1,Q=wh($,!0)):Ee?(ie=!1,Q=Eh($,!0)):Q=[]:Qn($)||Yi($)?(Q=A,Yi(A)?Q=_l(A):(!mt(A)||di(A))&&(Q=Bh($))):ie=!1}ie&&(S.set($,Q),d(Q,$,u,y,S),S.delete($)),Na(e,o,Q)}function hh(e,i){var o=e.length;if(o)return i+=i<0?o:0,fi(i,o)?e[i]:r}function lh(e,i,o){i.length?i=_t(i,function(y){return Ne(y)?function(S){return Vi(S,y.length===1?y[0]:y)}:y}):i=[gr];var u=-1;i=_t(i,mr(be()));var d=ah(e,function(y,S,A){var $=_t(i,function(Z){return Z(y)});return{criteria:$,index:++u,value:y}});return Up(d,function(y,S){return w0(y,S,o)})}function u0(e,i){return fh(e,i,function(o,u){return pc(e,u)})}function fh(e,i,o){for(var u=-1,d=i.length,y={};++u<d;){var S=i[u],A=Vi(e,S);o(A,S)&&Yn(y,Oi(S,e),A)}return y}function h0(e){return function(i){return Vi(i,e)}}function qa(e,i,o,u){var d=u?Fp:dn,y=-1,S=i.length,A=e;for(e===i&&(i=fr(i)),o&&(A=_t(e,mr(o)));++y<S;)for(var $=0,Z=i[y],Q=o?o(Z):Z;($=d(A,Q,$,u))>-1;)A!==e&&Js.call(A,$,1),Js.call(e,$,1);return e}function dh(e,i){for(var o=e?i.length:0,u=o-1;o--;){var d=i[o];if(o==u||d!==y){var y=d;fi(d)?Js.call(e,d,1):ka(e,d)}}return e}function za(e,i){return e+Qs(Gu()*(i-e+1))}function l0(e,i,o,u){for(var d=-1,y=Kt(Zs((i-e)/(o||1)),0),S=H(y);y--;)S[u?y:++d]=e,e+=o;return S}function Ha(e,i){var o="";if(!e||i<1||i>k)return o;do i%2&&(o+=e),i=Qs(i/2),i&&(e+=e);while(i);return o}function Ke(e,i){return oc(Hh(e,i,gr),e+"")}function f0(e){return Ju(In(e))}function d0(e,i){var o=In(e);return yo(o,ki(i,0,o.length))}function Yn(e,i,o,u){if(!mt(e))return e;i=Oi(i,e);for(var d=-1,y=i.length,S=y-1,A=e;A!=null&&++d<y;){var $=Qr(i[d]),Z=o;if($==="__proto__"||$==="constructor"||$==="prototype")return e;if(d!=S){var Q=A[$];Z=u?u(Q,$,A):r,Z===r&&(Z=mt(Q)?Q:fi(i[d+1])?[]:{})}kn(A,$,Z),A=A[$]}return e}var ph=eo?function(e,i){return eo.set(e,i),e}:gr,p0=Xs?function(e,i){return Xs(e,"toString",{configurable:!0,enumerable:!1,value:vc(i),writable:!0})}:gr;function g0(e){return yo(In(e))}function Nr(e,i,o){var u=-1,d=e.length;i<0&&(i=-i>d?0:d+i),o=o>d?d:o,o<0&&(o+=d),d=i>o?0:o-i>>>0,i>>>=0;for(var y=H(d);++u<d;)y[u]=e[u+i];return y}function v0(e,i){var o;return Ii(e,function(u,d,y){return o=i(u,d,y),!o}),!!o}function ao(e,i,o){var u=0,d=e==null?u:e.length;if(typeof i=="number"&&i===i&&d<=oe){for(;u<d;){var y=u+d>>>1,S=e[y];S!==null&&!Er(S)&&(o?S<=i:S<i)?u=y+1:d=y}return d}return Ka(e,i,gr,o)}function Ka(e,i,o,u){var d=0,y=e==null?0:e.length;if(y===0)return 0;i=o(i);for(var S=i!==i,A=i===null,$=Er(i),Z=i===r;d<y;){var Q=Qs((d+y)/2),ie=o(e[Q]),ue=ie!==r,ve=ie===null,Ee=ie===ie,qe=Er(ie);if(S)var De=u||Ee;else Z?De=Ee&&(u||ue):A?De=Ee&&ue&&(u||!ve):$?De=Ee&&ue&&!ve&&(u||!qe):ve||qe?De=!1:De=u?ie<=i:ie<i;De?d=Q+1:y=Q}return Xt(y,me)}function gh(e,i){for(var o=-1,u=e.length,d=0,y=[];++o<u;){var S=e[o],A=i?i(S):S;if(!o||!Kr(A,$)){var $=A;y[d++]=S===0?0:S}}return y}function vh(e){return typeof e=="number"?e:Er(e)?J:+e}function wr(e){if(typeof e=="string")return e;if(Ne(e))return _t(e,wr)+"";if(Er(e))return Wu?Wu.call(e):"";var i=e+"";return i=="0"&&1/e==-X?"-0":i}function xi(e,i,o){var u=-1,d=Bs,y=e.length,S=!0,A=[],$=A;if(o)S=!1,d=ba;else if(y>=a){var Z=i?null:O0(e);if(Z)return zs(Z);S=!1,d=jn,$=new Ki}else $=i?[]:A;e:for(;++u<y;){var Q=e[u],ie=i?i(Q):Q;if(Q=o||Q!==0?Q:0,S&&ie===ie){for(var ue=$.length;ue--;)if($[ue]===ie)continue e;i&&$.push(ie),A.push(Q)}else d($,ie,o)||($!==A&&$.push(ie),A.push(Q))}return A}function ka(e,i){return i=Oi(i,e),e=Kh(e,i),e==null||delete e[Qr(Rr(i))]}function yh(e,i,o,u){return Yn(e,i,o(Vi(e,i)),u)}function co(e,i,o,u){for(var d=e.length,y=u?d:-1;(u?y--:++y<d)&&i(e[y],y,e););return o?Nr(e,u?0:y,u?y+1:d):Nr(e,u?y+1:0,u?d:y)}function _h(e,i){var o=e;return o instanceof Ye&&(o=o.value()),ma(i,function(u,d){return d.func.apply(d.thisArg,Ei([u],d.args))},o)}function Va(e,i,o){var u=e.length;if(u<2)return u?xi(e[0]):[];for(var d=-1,y=H(u);++d<u;)for(var S=e[d],A=-1;++A<u;)A!=d&&(y[d]=Vn(y[d]||S,e[A],i,o));return xi(Wt(y,1),i,o)}function bh(e,i,o){for(var u=-1,d=e.length,y=i.length,S={};++u<d;){var A=u<y?i[u]:r;o(S,e[u],A)}return S}function Ga(e){return Tt(e)?e:[]}function Wa(e){return typeof e=="function"?e:gr}function Oi(e,i){return Ne(e)?e:ic(e,i)?[e]:Wh(it(e))}var y0=Ke;function Ci(e,i,o){var u=e.length;return o=o===r?u:o,!i&&o>=u?e:Nr(e,i,o)}var mh=ng||function(e){return Xe.clearTimeout(e)};function wh(e,i){if(i)return e.slice();var o=e.length,u=zu?zu(o):new e.constructor(o);return e.copy(u),u}function Ya(e){var i=new e.constructor(e.byteLength);return new Ws(i).set(new Ws(e)),i}function _0(e,i){var o=i?Ya(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function b0(e){var i=new e.constructor(e.source,xr.exec(e));return i.lastIndex=e.lastIndex,i}function m0(e){return Kn?ut(Kn.call(e)):{}}function Eh(e,i){var o=i?Ya(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function Dh(e,i){if(e!==i){var o=e!==r,u=e===null,d=e===e,y=Er(e),S=i!==r,A=i===null,$=i===i,Z=Er(i);if(!A&&!Z&&!y&&e>i||y&&S&&$&&!A&&!Z||u&&S&&$||!o&&$||!d)return 1;if(!u&&!y&&!Z&&e<i||Z&&o&&d&&!u&&!y||A&&o&&d||!S&&d||!$)return-1}return 0}function w0(e,i,o){for(var u=-1,d=e.criteria,y=i.criteria,S=d.length,A=o.length;++u<S;){var $=Dh(d[u],y[u]);if($){if(u>=A)return $;var Z=o[u];return $*(Z=="desc"?-1:1)}}return e.index-i.index}function Sh(e,i,o,u){for(var d=-1,y=e.length,S=o.length,A=-1,$=i.length,Z=Kt(y-S,0),Q=H($+Z),ie=!u;++A<$;)Q[A]=i[A];for(;++d<S;)(ie||d<y)&&(Q[o[d]]=e[d]);for(;Z--;)Q[A++]=e[d++];return Q}function Ih(e,i,o,u){for(var d=-1,y=e.length,S=-1,A=o.length,$=-1,Z=i.length,Q=Kt(y-A,0),ie=H(Q+Z),ue=!u;++d<Q;)ie[d]=e[d];for(var ve=d;++$<Z;)ie[ve+$]=i[$];for(;++S<A;)(ue||d<y)&&(ie[ve+o[S]]=e[d++]);return ie}function fr(e,i){var o=-1,u=e.length;for(i||(i=H(u));++o<u;)i[o]=e[o];return i}function Zr(e,i,o,u){var d=!o;o||(o={});for(var y=-1,S=i.length;++y<S;){var A=i[y],$=u?u(o[A],e[A],A,o,e):r;$===r&&($=e[A]),d?ui(o,A,$):kn(o,A,$)}return o}function E0(e,i){return Zr(e,rc(e),i)}function D0(e,i){return Zr(e,$h(e),i)}function uo(e,i){return function(o,u){var d=Ne(o)?Cp:kg,y=i?i():{};return d(o,e,be(u,2),y)}}function wn(e){return Ke(function(i,o){var u=-1,d=o.length,y=d>1?o[d-1]:r,S=d>2?o[2]:r;for(y=e.length>3&&typeof y=="function"?(d--,y):r,S&&nr(o[0],o[1],S)&&(y=d<3?r:y,d=1),i=ut(i);++u<d;){var A=o[u];A&&e(i,A,u,y)}return i})}function xh(e,i){return function(o,u){if(o==null)return o;if(!dr(o))return e(o,u);for(var d=o.length,y=i?d:-1,S=ut(o);(i?y--:++y<d)&&u(S[y],y,S)!==!1;);return o}}function Oh(e){return function(i,o,u){for(var d=-1,y=ut(i),S=u(i),A=S.length;A--;){var $=S[e?A:++d];if(o(y[$],$,y)===!1)break}return i}}function S0(e,i,o){var u=i&K,d=Jn(e);function y(){var S=this&&this!==Xe&&this instanceof y?d:e;return S.apply(u?o:this,arguments)}return y}function Ch(e){return function(i){i=it(i);var o=pn(i)?zr(i):r,u=o?o[0]:i.charAt(0),d=o?Ci(o,1).join(""):i.slice(1);return u[e]()+d}}function En(e){return function(i){return ma(xl(Il(i).replace(Mn,"")),e,"")}}function Jn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=mn(e.prototype),u=e.apply(o,i);return mt(u)?u:o}}function I0(e,i,o){var u=Jn(e);function d(){for(var y=arguments.length,S=H(y),A=y,$=Dn(d);A--;)S[A]=arguments[A];var Z=y<3&&S[0]!==$&&S[y-1]!==$?[]:Di(S,$);if(y-=Z.length,y<o)return Rh(e,i,ho,d.placeholder,r,S,Z,r,r,o-y);var Q=this&&this!==Xe&&this instanceof d?u:e;return kt(Q,this,S)}return d}function Ah(e){return function(i,o,u){var d=ut(i);if(!dr(i)){var y=be(o,3);i=Vt(i),o=function(A){return y(d[A],A,d)}}var S=e(i,o,u);return S>-1?d[y?i[S]:S]:r}}function Ph(e){return li(function(i){var o=i.length,u=o,d=Pr.prototype.thru;for(e&&i.reverse();u--;){var y=i[u];if(typeof y!="function")throw new Ar(p);if(d&&!S&&go(y)=="wrapper")var S=new Pr([],!0)}for(u=S?u:o;++u<o;){y=i[u];var A=go(y),$=A=="wrapper"?ec(y):r;$&&nc($[0])&&$[1]==(c|L|C|_)&&!$[4].length&&$[9]==1?S=S[go($[0])].apply(S,$[3]):S=y.length==1&&nc(y)?S[A]():S.thru(y)}return function(){var Z=arguments,Q=Z[0];if(S&&Z.length==1&&Ne(Q))return S.plant(Q).value();for(var ie=0,ue=o?i[ie].apply(this,Z):Q;++ie<o;)ue=i[ie].call(this,ue);return ue}})}function ho(e,i,o,u,d,y,S,A,$,Z){var Q=i&c,ie=i&K,ue=i&se,ve=i&(L|D),Ee=i&G,qe=ue?r:Jn(e);function De(){for(var Ge=arguments.length,Ze=H(Ge),Dr=Ge;Dr--;)Ze[Dr]=arguments[Dr];if(ve)var sr=Dn(De),Sr=Mp(Ze,sr);if(u&&(Ze=Sh(Ze,u,d,ve)),y&&(Ze=Ih(Ze,y,S,ve)),Ge-=Sr,ve&&Ge<Z){var Nt=Di(Ze,sr);return Rh(e,i,ho,De.placeholder,o,Ze,Nt,A,$,Z-Ge)}var kr=ie?o:this,gi=ue?kr[e]:e;return Ge=Ze.length,A?Ze=k0(Ze,A):Ee&&Ge>1&&Ze.reverse(),Q&&$<Ge&&(Ze.length=$),this&&this!==Xe&&this instanceof De&&(gi=qe||Jn(gi)),gi.apply(kr,Ze)}return De}function Th(e,i){return function(o,u){return Qg(o,e,i(u),{})}}function lo(e,i){return function(o,u){var d;if(o===r&&u===r)return i;if(o!==r&&(d=o),u!==r){if(d===r)return u;typeof o=="string"||typeof u=="string"?(o=wr(o),u=wr(u)):(o=vh(o),u=vh(u)),d=e(o,u)}return d}}function Ja(e){return li(function(i){return i=_t(i,mr(be())),Ke(function(o){var u=this;return e(i,function(d){return kt(d,u,o)})})})}function fo(e,i){i=i===r?" ":wr(i);var o=i.length;if(o<2)return o?Ha(i,e):i;var u=Ha(i,Zs(e/gn(i)));return pn(i)?Ci(zr(u),0,e).join(""):u.slice(0,e)}function x0(e,i,o,u){var d=i&K,y=Jn(e);function S(){for(var A=-1,$=arguments.length,Z=-1,Q=u.length,ie=H(Q+$),ue=this&&this!==Xe&&this instanceof S?y:e;++Z<Q;)ie[Z]=u[Z];for(;$--;)ie[Z++]=arguments[++A];return kt(ue,d?o:this,ie)}return S}function Nh(e){return function(i,o,u){return u&&typeof u!="number"&&nr(i,o,u)&&(o=u=r),i=pi(i),o===r?(o=i,i=0):o=pi(o),u=u===r?i<o?1:-1:pi(u),l0(i,o,u,e)}}function po(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Fr(i),o=Fr(o)),e(i,o)}}function Rh(e,i,o,u,d,y,S,A,$,Z){var Q=i&L,ie=Q?S:r,ue=Q?r:S,ve=Q?y:r,Ee=Q?r:y;i|=Q?C:m,i&=~(Q?m:C),i&P||(i&=~(K|se));var qe=[e,i,d,ve,ie,Ee,ue,A,$,Z],De=o.apply(r,qe);return nc(e)&&kh(De,qe),De.placeholder=u,Vh(De,e,i)}function Xa(e){var i=Ht[e];return function(o,u){if(o=Fr(o),u=u==null?0:Xt($e(u),292),u&&Vu(o)){var d=(it(o)+"e").split("e"),y=i(d[0]+"e"+(+d[1]+u));return d=(it(y)+"e").split("e"),+(d[0]+"e"+(+d[1]-u))}return i(o)}}var O0=_n&&1/zs(new _n([,-0]))[1]==X?function(e){return new _n(e)}:bc;function Fh(e){return function(i){var o=Zt(i);return o==Ie?Oa(i):o==xe?Kp(i):Lp(i,e(i))}}function hi(e,i,o,u,d,y,S,A){var $=i&se;if(!$&&typeof e!="function")throw new Ar(p);var Z=u?u.length:0;if(Z||(i&=~(C|m),u=d=r),S=S===r?S:Kt($e(S),0),A=A===r?A:$e(A),Z-=d?d.length:0,i&m){var Q=u,ie=d;u=d=r}var ue=$?r:ec(e),ve=[e,i,o,u,d,Q,ie,y,S,A];if(ue&&z0(ve,ue),e=ve[0],i=ve[1],o=ve[2],u=ve[3],d=ve[4],A=ve[9]=ve[9]===r?$?0:e.length:Kt(ve[9]-Z,0),!A&&i&(L|D)&&(i&=~(L|D)),!i||i==K)var Ee=S0(e,i,o);else i==L||i==D?Ee=I0(e,i,A):(i==C||i==(K|C))&&!d.length?Ee=x0(e,i,o,u):Ee=ho.apply(r,ve);var qe=ue?ph:kh;return Vh(qe(Ee,ve),e,i)}function Uh(e,i,o,u){return e===r||Kr(e,yn[o])&&!nt.call(u,o)?i:e}function Lh(e,i,o,u,d,y){return mt(e)&&mt(i)&&(y.set(i,e),oo(e,i,r,Lh,y),y.delete(i)),e}function C0(e){return Qn(e)?r:e}function Mh(e,i,o,u,d,y){var S=o&T,A=e.length,$=i.length;if(A!=$&&!(S&&$>A))return!1;var Z=y.get(e),Q=y.get(i);if(Z&&Q)return Z==i&&Q==e;var ie=-1,ue=!0,ve=o&z?new Ki:r;for(y.set(e,i),y.set(i,e);++ie<A;){var Ee=e[ie],qe=i[ie];if(u)var De=S?u(qe,Ee,ie,i,e,y):u(Ee,qe,ie,e,i,y);if(De!==r){if(De)continue;ue=!1;break}if(ve){if(!wa(i,function(Ge,Ze){if(!jn(ve,Ze)&&(Ee===Ge||d(Ee,Ge,o,u,y)))return ve.push(Ze)})){ue=!1;break}}else if(!(Ee===qe||d(Ee,qe,o,u,y))){ue=!1;break}}return y.delete(e),y.delete(i),ue}function A0(e,i,o,u,d,y,S){switch(o){case Ae:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Se:return!(e.byteLength!=i.byteLength||!y(new Ws(e),new Ws(i)));case B:case F:case ze:return Kr(+e,+i);case O:return e.name==i.name&&e.message==i.message;case je:case Re:return e==i+"";case Ie:var A=Oa;case xe:var $=u&T;if(A||(A=zs),e.size!=i.size&&!$)return!1;var Z=S.get(e);if(Z)return Z==i;u|=z,S.set(e,i);var Q=Mh(A(e),A(i),u,d,y,S);return S.delete(e),Q;case Fe:if(Kn)return Kn.call(e)==Kn.call(i)}return!1}function P0(e,i,o,u,d,y){var S=o&T,A=Za(e),$=A.length,Z=Za(i),Q=Z.length;if($!=Q&&!S)return!1;for(var ie=$;ie--;){var ue=A[ie];if(!(S?ue in i:nt.call(i,ue)))return!1}var ve=y.get(e),Ee=y.get(i);if(ve&&Ee)return ve==i&&Ee==e;var qe=!0;y.set(e,i),y.set(i,e);for(var De=S;++ie<$;){ue=A[ie];var Ge=e[ue],Ze=i[ue];if(u)var Dr=S?u(Ze,Ge,ue,i,e,y):u(Ge,Ze,ue,e,i,y);if(!(Dr===r?Ge===Ze||d(Ge,Ze,o,u,y):Dr)){qe=!1;break}De||(De=ue=="constructor")}if(qe&&!De){var sr=e.constructor,Sr=i.constructor;sr!=Sr&&"constructor"in e&&"constructor"in i&&!(typeof sr=="function"&&sr instanceof sr&&typeof Sr=="function"&&Sr instanceof Sr)&&(qe=!1)}return y.delete(e),y.delete(i),qe}function li(e){return oc(Hh(e,r,Zh),e+"")}function Za(e){return ih(e,Vt,rc)}function Qa(e){return ih(e,pr,$h)}var ec=eo?function(e){return eo.get(e)}:bc;function go(e){for(var i=e.name+"",o=bn[i],u=nt.call(bn,i)?o.length:0;u--;){var d=o[u],y=d.func;if(y==null||y==e)return d.name}return i}function Dn(e){var i=nt.call(v,"placeholder")?v:e;return i.placeholder}function be(){var e=v.iteratee||yc;return e=e===yc?oh:e,arguments.length?e(arguments[0],arguments[1]):e}function vo(e,i){var o=e.__data__;return $0(i)?o[typeof i=="string"?"string":"hash"]:o.map}function tc(e){for(var i=Vt(e),o=i.length;o--;){var u=i[o],d=e[u];i[o]=[u,d,qh(d)]}return i}function Gi(e,i){var o=qp(e,i);return sh(o)?o:r}function T0(e){var i=nt.call(e,zi),o=e[zi];try{e[zi]=r;var u=!0}catch{}var d=Vs.call(e);return u&&(i?e[zi]=o:delete e[zi]),d}var rc=Aa?function(e){return e==null?[]:(e=ut(e),wi(Aa(e),function(i){return Ku.call(e,i)}))}:mc,$h=Aa?function(e){for(var i=[];e;)Ei(i,rc(e)),e=Ys(e);return i}:mc,Zt=ir;(Pa&&Zt(new Pa(new ArrayBuffer(1)))!=Ae||qn&&Zt(new qn)!=Ie||Ta&&Zt(Ta.resolve())!=pt||_n&&Zt(new _n)!=xe||zn&&Zt(new zn)!=Ce)&&(Zt=function(e){var i=ir(e),o=i==Me?e.constructor:r,u=o?Wi(o):"";if(u)switch(u){case dg:return Ae;case pg:return Ie;case gg:return pt;case vg:return xe;case yg:return Ce}return i});function N0(e,i,o){for(var u=-1,d=o.length;++u<d;){var y=o[u],S=y.size;switch(y.type){case"drop":e+=S;break;case"dropRight":i-=S;break;case"take":i=Xt(i,e+S);break;case"takeRight":e=Kt(e,i-S);break}}return{start:e,end:i}}function R0(e){var i=e.match(ht);return i?i[1].split($t):[]}function jh(e,i,o){i=Oi(i,e);for(var u=-1,d=i.length,y=!1;++u<d;){var S=Qr(i[u]);if(!(y=e!=null&&o(e,S)))break;e=e[S]}return y||++u!=d?y:(d=e==null?0:e.length,!!d&&Do(d)&&fi(S,d)&&(Ne(e)||Yi(e)))}function F0(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&nt.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function Bh(e){return typeof e.constructor=="function"&&!Xn(e)?mn(Ys(e)):{}}function U0(e,i,o){var u=e.constructor;switch(i){case Se:return Ya(e);case B:case F:return new u(+e);case Ae:return _0(e,o);case He:case Oe:case Ve:case We:case et:case tt:case Je:case er:case hr:return Eh(e,o);case Ie:return new u;case ze:case Re:return new u(e);case je:return b0(e);case xe:return new u;case Fe:return m0(e)}}function L0(e,i){var o=i.length;if(!o)return e;var u=o-1;return i[u]=(o>1?"& ":"")+i[u],i=i.join(o>2?", ":" "),e.replace(xt,`{
/* [wrapped with `+i+`] */
`)}function M0(e){return Ne(e)||Yi(e)||!!(ku&&e&&e[ku])}function fi(e,i){var o=typeof e;return i=i??k,!!i&&(o=="number"||o!="symbol"&&sa.test(e))&&e>-1&&e%1==0&&e<i}function nr(e,i,o){if(!mt(o))return!1;var u=typeof i;return(u=="number"?dr(o)&&fi(i,o.length):u=="string"&&i in o)?Kr(o[i],e):!1}function ic(e,i){if(Ne(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||Er(e)?!0:Ut.test(e)||!yt.test(e)||i!=null&&e in ut(i)}function $0(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function nc(e){var i=go(e),o=v[i];if(typeof o!="function"||!(i in Ye.prototype))return!1;if(e===o)return!0;var u=ec(o);return!!u&&e===u[0]}function j0(e){return!!qu&&qu in e}var B0=Ks?di:wc;function Xn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||yn;return e===o}function qh(e){return e===e&&!mt(e)}function zh(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in ut(o))}}function q0(e){var i=wo(e,function(u){return o.size===E&&o.clear(),u}),o=i.cache;return i}function z0(e,i){var o=e[1],u=i[1],d=o|u,y=d<(K|se|c),S=u==c&&o==L||u==c&&o==_&&e[7].length<=i[8]||u==(c|_)&&i[7].length<=i[8]&&o==L;if(!(y||S))return e;u&K&&(e[2]=i[2],d|=o&K?0:P);var A=i[3];if(A){var $=e[3];e[3]=$?Sh($,A,i[4]):A,e[4]=$?Di(e[3],I):i[4]}return A=i[5],A&&($=e[5],e[5]=$?Ih($,A,i[6]):A,e[6]=$?Di(e[5],I):i[6]),A=i[7],A&&(e[7]=A),u&c&&(e[8]=e[8]==null?i[8]:Xt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=d,e}function H0(e){var i=[];if(e!=null)for(var o in ut(e))i.push(o);return i}function K0(e){return Vs.call(e)}function Hh(e,i,o){return i=Kt(i===r?e.length-1:i,0),function(){for(var u=arguments,d=-1,y=Kt(u.length-i,0),S=H(y);++d<y;)S[d]=u[i+d];d=-1;for(var A=H(i+1);++d<i;)A[d]=u[d];return A[i]=o(S),kt(e,this,A)}}function Kh(e,i){return i.length<2?e:Vi(e,Nr(i,0,-1))}function k0(e,i){for(var o=e.length,u=Xt(i.length,o),d=fr(e);u--;){var y=i[u];e[u]=fi(y,o)?d[y]:r}return e}function sc(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var kh=Gh(ph),Zn=og||function(e,i){return Xe.setTimeout(e,i)},oc=Gh(p0);function Vh(e,i,o){var u=i+"";return oc(e,L0(u,V0(R0(u),o)))}function Gh(e){var i=0,o=0;return function(){var u=hg(),d=de-(u-o);if(o=u,d>0){if(++i>=ce)return arguments[0]}else i=0;return e.apply(r,arguments)}}function yo(e,i){var o=-1,u=e.length,d=u-1;for(i=i===r?u:i;++o<i;){var y=za(o,d),S=e[y];e[y]=e[o],e[o]=S}return e.length=i,e}var Wh=q0(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Lt,function(o,u,d,y){i.push(d?y.replace(Qo,"$1"):u||o)}),i});function Qr(e){if(typeof e=="string"||Er(e))return e;var i=e+"";return i=="0"&&1/e==-X?"-0":i}function Wi(e){if(e!=null){try{return ks.call(e)}catch{}try{return e+""}catch{}}return""}function V0(e,i){return Cr(we,function(o){var u="_."+o[0];i&o[1]&&!Bs(e,u)&&e.push(u)}),e.sort()}function Yh(e){if(e instanceof Ye)return e.clone();var i=new Pr(e.__wrapped__,e.__chain__);return i.__actions__=fr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function G0(e,i,o){(o?nr(e,i,o):i===r)?i=1:i=Kt($e(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var d=0,y=0,S=H(Zs(u/i));d<u;)S[y++]=Nr(e,d,d+=i);return S}function W0(e){for(var i=-1,o=e==null?0:e.length,u=0,d=[];++i<o;){var y=e[i];y&&(d[u++]=y)}return d}function Y0(){var e=arguments.length;if(!e)return[];for(var i=H(e-1),o=arguments[0],u=e;u--;)i[u-1]=arguments[u];return Ei(Ne(o)?fr(o):[o],Wt(i,1))}var J0=Ke(function(e,i){return Tt(e)?Vn(e,Wt(i,1,Tt,!0)):[]}),X0=Ke(function(e,i){var o=Rr(i);return Tt(o)&&(o=r),Tt(e)?Vn(e,Wt(i,1,Tt,!0),be(o,2)):[]}),Z0=Ke(function(e,i){var o=Rr(i);return Tt(o)&&(o=r),Tt(e)?Vn(e,Wt(i,1,Tt,!0),r,o):[]});function Q0(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:$e(i),Nr(e,i<0?0:i,u)):[]}function e1(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:$e(i),i=u-i,Nr(e,0,i<0?0:i)):[]}function t1(e,i){return e&&e.length?co(e,be(i,3),!0,!0):[]}function r1(e,i){return e&&e.length?co(e,be(i,3),!0):[]}function i1(e,i,o,u){var d=e==null?0:e.length;return d?(o&&typeof o!="number"&&nr(e,i,o)&&(o=0,u=d),Yg(e,i,o,u)):[]}function Jh(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var d=o==null?0:$e(o);return d<0&&(d=Kt(u+d,0)),qs(e,be(i,3),d)}function Xh(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var d=u-1;return o!==r&&(d=$e(o),d=o<0?Kt(u+d,0):Xt(d,u-1)),qs(e,be(i,3),d,!0)}function Zh(e){var i=e==null?0:e.length;return i?Wt(e,1):[]}function n1(e){var i=e==null?0:e.length;return i?Wt(e,X):[]}function s1(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:$e(i),Wt(e,i)):[]}function o1(e){for(var i=-1,o=e==null?0:e.length,u={};++i<o;){var d=e[i];u[d[0]]=d[1]}return u}function Qh(e){return e&&e.length?e[0]:r}function a1(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var d=o==null?0:$e(o);return d<0&&(d=Kt(u+d,0)),dn(e,i,d)}function c1(e){var i=e==null?0:e.length;return i?Nr(e,0,-1):[]}var u1=Ke(function(e){var i=_t(e,Ga);return i.length&&i[0]===e[0]?Ma(i):[]}),h1=Ke(function(e){var i=Rr(e),o=_t(e,Ga);return i===Rr(o)?i=r:o.pop(),o.length&&o[0]===e[0]?Ma(o,be(i,2)):[]}),l1=Ke(function(e){var i=Rr(e),o=_t(e,Ga);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?Ma(o,r,i):[]});function f1(e,i){return e==null?"":cg.call(e,i)}function Rr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function d1(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var d=u;return o!==r&&(d=$e(o),d=d<0?Kt(u+d,0):Xt(d,u-1)),i===i?Vp(e,i,d):qs(e,Ru,d,!0)}function p1(e,i){return e&&e.length?hh(e,$e(i)):r}var g1=Ke(el);function el(e,i){return e&&e.length&&i&&i.length?qa(e,i):e}function v1(e,i,o){return e&&e.length&&i&&i.length?qa(e,i,be(o,2)):e}function y1(e,i,o){return e&&e.length&&i&&i.length?qa(e,i,r,o):e}var _1=li(function(e,i){var o=e==null?0:e.length,u=Ra(e,i);return dh(e,_t(i,function(d){return fi(d,o)?+d:d}).sort(Dh)),u});function b1(e,i){var o=[];if(!(e&&e.length))return o;var u=-1,d=[],y=e.length;for(i=be(i,3);++u<y;){var S=e[u];i(S,u,e)&&(o.push(S),d.push(u))}return dh(e,d),o}function ac(e){return e==null?e:fg.call(e)}function m1(e,i,o){var u=e==null?0:e.length;return u?(o&&typeof o!="number"&&nr(e,i,o)?(i=0,o=u):(i=i==null?0:$e(i),o=o===r?u:$e(o)),Nr(e,i,o)):[]}function w1(e,i){return ao(e,i)}function E1(e,i,o){return Ka(e,i,be(o,2))}function D1(e,i){var o=e==null?0:e.length;if(o){var u=ao(e,i);if(u<o&&Kr(e[u],i))return u}return-1}function S1(e,i){return ao(e,i,!0)}function I1(e,i,o){return Ka(e,i,be(o,2),!0)}function x1(e,i){var o=e==null?0:e.length;if(o){var u=ao(e,i,!0)-1;if(Kr(e[u],i))return u}return-1}function O1(e){return e&&e.length?gh(e):[]}function C1(e,i){return e&&e.length?gh(e,be(i,2)):[]}function A1(e){var i=e==null?0:e.length;return i?Nr(e,1,i):[]}function P1(e,i,o){return e&&e.length?(i=o||i===r?1:$e(i),Nr(e,0,i<0?0:i)):[]}function T1(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:$e(i),i=u-i,Nr(e,i<0?0:i,u)):[]}function N1(e,i){return e&&e.length?co(e,be(i,3),!1,!0):[]}function R1(e,i){return e&&e.length?co(e,be(i,3)):[]}var F1=Ke(function(e){return xi(Wt(e,1,Tt,!0))}),U1=Ke(function(e){var i=Rr(e);return Tt(i)&&(i=r),xi(Wt(e,1,Tt,!0),be(i,2))}),L1=Ke(function(e){var i=Rr(e);return i=typeof i=="function"?i:r,xi(Wt(e,1,Tt,!0),r,i)});function M1(e){return e&&e.length?xi(e):[]}function $1(e,i){return e&&e.length?xi(e,be(i,2)):[]}function j1(e,i){return i=typeof i=="function"?i:r,e&&e.length?xi(e,r,i):[]}function cc(e){if(!(e&&e.length))return[];var i=0;return e=wi(e,function(o){if(Tt(o))return i=Kt(o.length,i),!0}),Ia(i,function(o){return _t(e,Ea(o))})}function tl(e,i){if(!(e&&e.length))return[];var o=cc(e);return i==null?o:_t(o,function(u){return kt(i,r,u)})}var B1=Ke(function(e,i){return Tt(e)?Vn(e,i):[]}),q1=Ke(function(e){return Va(wi(e,Tt))}),z1=Ke(function(e){var i=Rr(e);return Tt(i)&&(i=r),Va(wi(e,Tt),be(i,2))}),H1=Ke(function(e){var i=Rr(e);return i=typeof i=="function"?i:r,Va(wi(e,Tt),r,i)}),K1=Ke(cc);function k1(e,i){return bh(e||[],i||[],kn)}function V1(e,i){return bh(e||[],i||[],Yn)}var G1=Ke(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,tl(e,o)});function rl(e){var i=v(e);return i.__chain__=!0,i}function W1(e,i){return i(e),e}function _o(e,i){return i(e)}var Y1=li(function(e){var i=e.length,o=i?e[0]:0,u=this.__wrapped__,d=function(y){return Ra(y,e)};return i>1||this.__actions__.length||!(u instanceof Ye)||!fi(o)?this.thru(d):(u=u.slice(o,+o+(i?1:0)),u.__actions__.push({func:_o,args:[d],thisArg:r}),new Pr(u,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function J1(){return rl(this)}function X1(){return new Pr(this.value(),this.__chain__)}function Z1(){this.__values__===r&&(this.__values__=vl(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function Q1(){return this}function ev(e){for(var i,o=this;o instanceof ro;){var u=Yh(o);u.__index__=0,u.__values__=r,i?d.__wrapped__=u:i=u;var d=u;o=o.__wrapped__}return d.__wrapped__=e,i}function tv(){var e=this.__wrapped__;if(e instanceof Ye){var i=e;return this.__actions__.length&&(i=new Ye(this)),i=i.reverse(),i.__actions__.push({func:_o,args:[ac],thisArg:r}),new Pr(i,this.__chain__)}return this.thru(ac)}function rv(){return _h(this.__wrapped__,this.__actions__)}var iv=uo(function(e,i,o){nt.call(e,o)?++e[o]:ui(e,o,1)});function nv(e,i,o){var u=Ne(e)?Tu:Wg;return o&&nr(e,i,o)&&(i=r),u(e,be(i,3))}function sv(e,i){var o=Ne(e)?wi:th;return o(e,be(i,3))}var ov=Ah(Jh),av=Ah(Xh);function cv(e,i){return Wt(bo(e,i),1)}function uv(e,i){return Wt(bo(e,i),X)}function hv(e,i,o){return o=o===r?1:$e(o),Wt(bo(e,i),o)}function il(e,i){var o=Ne(e)?Cr:Ii;return o(e,be(i,3))}function nl(e,i){var o=Ne(e)?Ap:eh;return o(e,be(i,3))}var lv=uo(function(e,i,o){nt.call(e,o)?e[o].push(i):ui(e,o,[i])});function fv(e,i,o,u){e=dr(e)?e:In(e),o=o&&!u?$e(o):0;var d=e.length;return o<0&&(o=Kt(d+o,0)),So(e)?o<=d&&e.indexOf(i,o)>-1:!!d&&dn(e,i,o)>-1}var dv=Ke(function(e,i,o){var u=-1,d=typeof i=="function",y=dr(e)?H(e.length):[];return Ii(e,function(S){y[++u]=d?kt(i,S,o):Gn(S,i,o)}),y}),pv=uo(function(e,i,o){ui(e,o,i)});function bo(e,i){var o=Ne(e)?_t:ah;return o(e,be(i,3))}function gv(e,i,o,u){return e==null?[]:(Ne(i)||(i=i==null?[]:[i]),o=u?r:o,Ne(o)||(o=o==null?[]:[o]),lh(e,i,o))}var vv=uo(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function yv(e,i,o){var u=Ne(e)?ma:Uu,d=arguments.length<3;return u(e,be(i,4),o,d,Ii)}function _v(e,i,o){var u=Ne(e)?Pp:Uu,d=arguments.length<3;return u(e,be(i,4),o,d,eh)}function bv(e,i){var o=Ne(e)?wi:th;return o(e,Eo(be(i,3)))}function mv(e){var i=Ne(e)?Ju:f0;return i(e)}function wv(e,i,o){(o?nr(e,i,o):i===r)?i=1:i=$e(i);var u=Ne(e)?Hg:d0;return u(e,i)}function Ev(e){var i=Ne(e)?Kg:g0;return i(e)}function Dv(e){if(e==null)return 0;if(dr(e))return So(e)?gn(e):e.length;var i=Zt(e);return i==Ie||i==xe?e.size:ja(e).length}function Sv(e,i,o){var u=Ne(e)?wa:v0;return o&&nr(e,i,o)&&(i=r),u(e,be(i,3))}var Iv=Ke(function(e,i){if(e==null)return[];var o=i.length;return o>1&&nr(e,i[0],i[1])?i=[]:o>2&&nr(i[0],i[1],i[2])&&(i=[i[0]]),lh(e,Wt(i,1),[])}),mo=sg||function(){return Xe.Date.now()};function xv(e,i){if(typeof i!="function")throw new Ar(p);return e=$e(e),function(){if(--e<1)return i.apply(this,arguments)}}function sl(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,hi(e,c,r,r,r,r,i)}function ol(e,i){var o;if(typeof i!="function")throw new Ar(p);return e=$e(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var uc=Ke(function(e,i,o){var u=K;if(o.length){var d=Di(o,Dn(uc));u|=C}return hi(e,u,i,o,d)}),al=Ke(function(e,i,o){var u=K|se;if(o.length){var d=Di(o,Dn(al));u|=C}return hi(i,u,e,o,d)});function cl(e,i,o){i=o?r:i;var u=hi(e,L,r,r,r,r,r,i);return u.placeholder=cl.placeholder,u}function ul(e,i,o){i=o?r:i;var u=hi(e,D,r,r,r,r,r,i);return u.placeholder=ul.placeholder,u}function hl(e,i,o){var u,d,y,S,A,$,Z=0,Q=!1,ie=!1,ue=!0;if(typeof e!="function")throw new Ar(p);i=Fr(i)||0,mt(o)&&(Q=!!o.leading,ie="maxWait"in o,y=ie?Kt(Fr(o.maxWait)||0,i):y,ue="trailing"in o?!!o.trailing:ue);function ve(Nt){var kr=u,gi=d;return u=d=r,Z=Nt,S=e.apply(gi,kr),S}function Ee(Nt){return Z=Nt,A=Zn(Ge,i),Q?ve(Nt):S}function qe(Nt){var kr=Nt-$,gi=Nt-Z,Al=i-kr;return ie?Xt(Al,y-gi):Al}function De(Nt){var kr=Nt-$,gi=Nt-Z;return $===r||kr>=i||kr<0||ie&&gi>=y}function Ge(){var Nt=mo();if(De(Nt))return Ze(Nt);A=Zn(Ge,qe(Nt))}function Ze(Nt){return A=r,ue&&u?ve(Nt):(u=d=r,S)}function Dr(){A!==r&&mh(A),Z=0,u=$=d=A=r}function sr(){return A===r?S:Ze(mo())}function Sr(){var Nt=mo(),kr=De(Nt);if(u=arguments,d=this,$=Nt,kr){if(A===r)return Ee($);if(ie)return mh(A),A=Zn(Ge,i),ve($)}return A===r&&(A=Zn(Ge,i)),S}return Sr.cancel=Dr,Sr.flush=sr,Sr}var Ov=Ke(function(e,i){return Qu(e,1,i)}),Cv=Ke(function(e,i,o){return Qu(e,Fr(i)||0,o)});function Av(e){return hi(e,G)}function wo(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Ar(p);var o=function(){var u=arguments,d=i?i.apply(this,u):u[0],y=o.cache;if(y.has(d))return y.get(d);var S=e.apply(this,u);return o.cache=y.set(d,S)||y,S};return o.cache=new(wo.Cache||ci),o}wo.Cache=ci;function Eo(e){if(typeof e!="function")throw new Ar(p);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Pv(e){return ol(2,e)}var Tv=y0(function(e,i){i=i.length==1&&Ne(i[0])?_t(i[0],mr(be())):_t(Wt(i,1),mr(be()));var o=i.length;return Ke(function(u){for(var d=-1,y=Xt(u.length,o);++d<y;)u[d]=i[d].call(this,u[d]);return kt(e,this,u)})}),hc=Ke(function(e,i){var o=Di(i,Dn(hc));return hi(e,C,r,i,o)}),ll=Ke(function(e,i){var o=Di(i,Dn(ll));return hi(e,m,r,i,o)}),Nv=li(function(e,i){return hi(e,_,r,r,r,i)});function Rv(e,i){if(typeof e!="function")throw new Ar(p);return i=i===r?i:$e(i),Ke(e,i)}function Fv(e,i){if(typeof e!="function")throw new Ar(p);return i=i==null?0:Kt($e(i),0),Ke(function(o){var u=o[i],d=Ci(o,0,i);return u&&Ei(d,u),kt(e,this,d)})}function Uv(e,i,o){var u=!0,d=!0;if(typeof e!="function")throw new Ar(p);return mt(o)&&(u="leading"in o?!!o.leading:u,d="trailing"in o?!!o.trailing:d),hl(e,i,{leading:u,maxWait:i,trailing:d})}function Lv(e){return sl(e,1)}function Mv(e,i){return hc(Wa(i),e)}function $v(){if(!arguments.length)return[];var e=arguments[0];return Ne(e)?e:[e]}function jv(e){return Tr(e,R)}function Bv(e,i){return i=typeof i=="function"?i:r,Tr(e,R,i)}function qv(e){return Tr(e,N|R)}function zv(e,i){return i=typeof i=="function"?i:r,Tr(e,N|R,i)}function Hv(e,i){return i==null||Zu(e,i,Vt(i))}function Kr(e,i){return e===i||e!==e&&i!==i}var Kv=po(La),kv=po(function(e,i){return e>=i}),Yi=nh(function(){return arguments}())?nh:function(e){return Ot(e)&&nt.call(e,"callee")&&!Ku.call(e,"callee")},Ne=H.isArray,Vv=rr?mr(rr):e0;function dr(e){return e!=null&&Do(e.length)&&!di(e)}function Tt(e){return Ot(e)&&dr(e)}function Gv(e){return e===!0||e===!1||Ot(e)&&ir(e)==B}var Ai=ag||wc,Wv=qr?mr(qr):t0;function Yv(e){return Ot(e)&&e.nodeType===1&&!Qn(e)}function Jv(e){if(e==null)return!0;if(dr(e)&&(Ne(e)||typeof e=="string"||typeof e.splice=="function"||Ai(e)||Sn(e)||Yi(e)))return!e.length;var i=Zt(e);if(i==Ie||i==xe)return!e.size;if(Xn(e))return!ja(e).length;for(var o in e)if(nt.call(e,o))return!1;return!0}function Xv(e,i){return Wn(e,i)}function Zv(e,i,o){o=typeof o=="function"?o:r;var u=o?o(e,i):r;return u===r?Wn(e,i,r,o):!!u}function lc(e){if(!Ot(e))return!1;var i=ir(e);return i==O||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Qn(e)}function Qv(e){return typeof e=="number"&&Vu(e)}function di(e){if(!mt(e))return!1;var i=ir(e);return i==ae||i==fe||i==q||i==gt}function fl(e){return typeof e=="number"&&e==$e(e)}function Do(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=k}function mt(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function Ot(e){return e!=null&&typeof e=="object"}var dl=Or?mr(Or):i0;function ey(e,i){return e===i||$a(e,i,tc(i))}function ty(e,i,o){return o=typeof o=="function"?o:r,$a(e,i,tc(i),o)}function ry(e){return pl(e)&&e!=+e}function iy(e){if(B0(e))throw new Pe(l);return sh(e)}function ny(e){return e===null}function sy(e){return e==null}function pl(e){return typeof e=="number"||Ot(e)&&ir(e)==ze}function Qn(e){if(!Ot(e)||ir(e)!=Me)return!1;var i=Ys(e);if(i===null)return!0;var o=nt.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&ks.call(o)==tg}var fc=Jr?mr(Jr):n0;function oy(e){return fl(e)&&e>=-k&&e<=k}var gl=$n?mr($n):s0;function So(e){return typeof e=="string"||!Ne(e)&&Ot(e)&&ir(e)==Re}function Er(e){return typeof e=="symbol"||Ot(e)&&ir(e)==Fe}var Sn=qi?mr(qi):o0;function ay(e){return e===r}function cy(e){return Ot(e)&&Zt(e)==Ce}function uy(e){return Ot(e)&&ir(e)==Ue}var hy=po(Ba),ly=po(function(e,i){return e<=i});function vl(e){if(!e)return[];if(dr(e))return So(e)?zr(e):fr(e);if(Bn&&e[Bn])return Hp(e[Bn]());var i=Zt(e),o=i==Ie?Oa:i==xe?zs:In;return o(e)}function pi(e){if(!e)return e===0?e:0;if(e=Fr(e),e===X||e===-X){var i=e<0?-1:1;return i*V}return e===e?e:0}function $e(e){var i=pi(e),o=i%1;return i===i?o?i-o:i:0}function yl(e){return e?ki($e(e),0,re):0}function Fr(e){if(typeof e=="number")return e;if(Er(e))return J;if(mt(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=mt(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Lu(e);var o=ra.test(e);return o||na.test(e)?Te(e.slice(2),o?2:8):ta.test(e)?J:+e}function _l(e){return Zr(e,pr(e))}function fy(e){return e?ki($e(e),-k,k):e===0?e:0}function it(e){return e==null?"":wr(e)}var dy=wn(function(e,i){if(Xn(i)||dr(i)){Zr(i,Vt(i),e);return}for(var o in i)nt.call(i,o)&&kn(e,o,i[o])}),bl=wn(function(e,i){Zr(i,pr(i),e)}),Io=wn(function(e,i,o,u){Zr(i,pr(i),e,u)}),py=wn(function(e,i,o,u){Zr(i,Vt(i),e,u)}),gy=li(Ra);function vy(e,i){var o=mn(e);return i==null?o:Xu(o,i)}var yy=Ke(function(e,i){e=ut(e);var o=-1,u=i.length,d=u>2?i[2]:r;for(d&&nr(i[0],i[1],d)&&(u=1);++o<u;)for(var y=i[o],S=pr(y),A=-1,$=S.length;++A<$;){var Z=S[A],Q=e[Z];(Q===r||Kr(Q,yn[Z])&&!nt.call(e,Z))&&(e[Z]=y[Z])}return e}),_y=Ke(function(e){return e.push(r,Lh),kt(ml,r,e)});function by(e,i){return Nu(e,be(i,3),Xr)}function my(e,i){return Nu(e,be(i,3),Ua)}function wy(e,i){return e==null?e:Fa(e,be(i,3),pr)}function Ey(e,i){return e==null?e:rh(e,be(i,3),pr)}function Dy(e,i){return e&&Xr(e,be(i,3))}function Sy(e,i){return e&&Ua(e,be(i,3))}function Iy(e){return e==null?[]:so(e,Vt(e))}function xy(e){return e==null?[]:so(e,pr(e))}function dc(e,i,o){var u=e==null?r:Vi(e,i);return u===r?o:u}function Oy(e,i){return e!=null&&jh(e,i,Jg)}function pc(e,i){return e!=null&&jh(e,i,Xg)}var Cy=Th(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Vs.call(i)),e[i]=o},vc(gr)),Ay=Th(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Vs.call(i)),nt.call(e,i)?e[i].push(o):e[i]=[o]},be),Py=Ke(Gn);function Vt(e){return dr(e)?Yu(e):ja(e)}function pr(e){return dr(e)?Yu(e,!0):a0(e)}function Ty(e,i){var o={};return i=be(i,3),Xr(e,function(u,d,y){ui(o,i(u,d,y),u)}),o}function Ny(e,i){var o={};return i=be(i,3),Xr(e,function(u,d,y){ui(o,d,i(u,d,y))}),o}var Ry=wn(function(e,i,o){oo(e,i,o)}),ml=wn(function(e,i,o,u){oo(e,i,o,u)}),Fy=li(function(e,i){var o={};if(e==null)return o;var u=!1;i=_t(i,function(y){return y=Oi(y,e),u||(u=y.length>1),y}),Zr(e,Qa(e),o),u&&(o=Tr(o,N|j|R,C0));for(var d=i.length;d--;)ka(o,i[d]);return o});function Uy(e,i){return wl(e,Eo(be(i)))}var Ly=li(function(e,i){return e==null?{}:u0(e,i)});function wl(e,i){if(e==null)return{};var o=_t(Qa(e),function(u){return[u]});return i=be(i),fh(e,o,function(u,d){return i(u,d[0])})}function My(e,i,o){i=Oi(i,e);var u=-1,d=i.length;for(d||(d=1,e=r);++u<d;){var y=e==null?r:e[Qr(i[u])];y===r&&(u=d,y=o),e=di(y)?y.call(e):y}return e}function $y(e,i,o){return e==null?e:Yn(e,i,o)}function jy(e,i,o,u){return u=typeof u=="function"?u:r,e==null?e:Yn(e,i,o,u)}var El=Fh(Vt),Dl=Fh(pr);function By(e,i,o){var u=Ne(e),d=u||Ai(e)||Sn(e);if(i=be(i,4),o==null){var y=e&&e.constructor;d?o=u?new y:[]:mt(e)?o=di(y)?mn(Ys(e)):{}:o={}}return(d?Cr:Xr)(e,function(S,A,$){return i(o,S,A,$)}),o}function qy(e,i){return e==null?!0:ka(e,i)}function zy(e,i,o){return e==null?e:yh(e,i,Wa(o))}function Hy(e,i,o,u){return u=typeof u=="function"?u:r,e==null?e:yh(e,i,Wa(o),u)}function In(e){return e==null?[]:xa(e,Vt(e))}function Ky(e){return e==null?[]:xa(e,pr(e))}function ky(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Fr(o),o=o===o?o:0),i!==r&&(i=Fr(i),i=i===i?i:0),ki(Fr(e),i,o)}function Vy(e,i,o){return i=pi(i),o===r?(o=i,i=0):o=pi(o),e=Fr(e),Zg(e,i,o)}function Gy(e,i,o){if(o&&typeof o!="boolean"&&nr(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=pi(e),i===r?(i=e,e=0):i=pi(i)),e>i){var u=e;e=i,i=u}if(o||e%1||i%1){var d=Gu();return Xt(e+d*(i-e+at("1e-"+((d+"").length-1))),i)}return za(e,i)}var Wy=En(function(e,i,o){return i=i.toLowerCase(),e+(o?Sl(i):i)});function Sl(e){return gc(it(e).toLowerCase())}function Il(e){return e=it(e),e&&e.replace(si,$p).replace(ya,"")}function Yy(e,i,o){e=it(e),i=wr(i);var u=e.length;o=o===r?u:ki($e(o),0,u);var d=o;return o-=i.length,o>=0&&e.slice(o,d)==i}function Jy(e){return e=it(e),e&&vt.test(e)?e.replace(Li,jp):e}function Xy(e){return e=it(e),e&&Mt.test(e)?e.replace(St,"\\$&"):e}var Zy=En(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),Qy=En(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),e_=Ch("toLowerCase");function t_(e,i,o){e=it(e),i=$e(i);var u=i?gn(e):0;if(!i||u>=i)return e;var d=(i-u)/2;return fo(Qs(d),o)+e+fo(Zs(d),o)}function r_(e,i,o){e=it(e),i=$e(i);var u=i?gn(e):0;return i&&u<i?e+fo(i-u,o):e}function i_(e,i,o){e=it(e),i=$e(i);var u=i?gn(e):0;return i&&u<i?fo(i-u,o)+e:e}function n_(e,i,o){return o||i==null?i=0:i&&(i=+i),lg(it(e).replace(It,""),i||0)}function s_(e,i,o){return(o?nr(e,i,o):i===r)?i=1:i=$e(i),Ha(it(e),i)}function o_(){var e=arguments,i=it(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var a_=En(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function c_(e,i,o){return o&&typeof o!="number"&&nr(e,i,o)&&(i=o=r),o=o===r?re:o>>>0,o?(e=it(e),e&&(typeof i=="string"||i!=null&&!fc(i))&&(i=wr(i),!i&&pn(e))?Ci(zr(e),0,o):e.split(i,o)):[]}var u_=En(function(e,i,o){return e+(o?" ":"")+gc(i)});function h_(e,i,o){return e=it(e),o=o==null?0:ki($e(o),0,e.length),i=wr(i),e.slice(o,o+i.length)==i}function l_(e,i,o){var u=v.templateSettings;o&&nr(e,i,o)&&(i=r),e=it(e),i=Io({},i,u,Uh);var d=Io({},i.imports,u.imports,Uh),y=Vt(d),S=xa(d,y),A,$,Z=0,Q=i.interpolate||on,ie="__p += '",ue=Ca((i.escape||on).source+"|"+Q.source+"|"+(Q===bt?ea:on).source+"|"+(i.evaluate||on).source+"|$","g"),ve="//# sourceURL="+(nt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++_a+"]")+`
`;e.replace(ue,function(De,Ge,Ze,Dr,sr,Sr){return Ze||(Ze=Dr),ie+=e.slice(Z,Sr).replace(oa,Bp),Ge&&(A=!0,ie+=`' +
__e(`+Ge+`) +
'`),sr&&($=!0,ie+=`';
`+sr+`;
__p += '`),Ze&&(ie+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),Z=Sr+De.length,De}),ie+=`';
`;var Ee=nt.call(i,"variable")&&i.variable;if(!Ee)ie=`with (obj) {
`+ie+`
}
`;else if(Zo.test(Ee))throw new Pe(f);ie=($?ie.replace(Wr,""):ie).replace(tr,"$1").replace(ni,"$1;"),ie="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(A?", __e = _.escape":"")+($?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ie+`return __p
}`;var qe=Ol(function(){return rt(y,ve+"return "+ie).apply(r,S)});if(qe.source=ie,lc(qe))throw qe;return qe}function f_(e){return it(e).toLowerCase()}function d_(e){return it(e).toUpperCase()}function p_(e,i,o){if(e=it(e),e&&(o||i===r))return Lu(e);if(!e||!(i=wr(i)))return e;var u=zr(e),d=zr(i),y=Mu(u,d),S=$u(u,d)+1;return Ci(u,y,S).join("")}function g_(e,i,o){if(e=it(e),e&&(o||i===r))return e.slice(0,Bu(e)+1);if(!e||!(i=wr(i)))return e;var u=zr(e),d=$u(u,zr(i))+1;return Ci(u,0,d).join("")}function v_(e,i,o){if(e=it(e),e&&(o||i===r))return e.replace(It,"");if(!e||!(i=wr(i)))return e;var u=zr(e),d=Mu(u,zr(i));return Ci(u,d).join("")}function y_(e,i){var o=W,u=ne;if(mt(i)){var d="separator"in i?i.separator:d;o="length"in i?$e(i.length):o,u="omission"in i?wr(i.omission):u}e=it(e);var y=e.length;if(pn(e)){var S=zr(e);y=S.length}if(o>=y)return e;var A=o-gn(u);if(A<1)return u;var $=S?Ci(S,0,A).join(""):e.slice(0,A);if(d===r)return $+u;if(S&&(A+=$.length-A),fc(d)){if(e.slice(A).search(d)){var Z,Q=$;for(d.global||(d=Ca(d.source,it(xr.exec(d))+"g")),d.lastIndex=0;Z=d.exec(Q);)var ie=Z.index;$=$.slice(0,ie===r?A:ie)}}else if(e.indexOf(wr(d),A)!=A){var ue=$.lastIndexOf(d);ue>-1&&($=$.slice(0,ue))}return $+u}function __(e){return e=it(e),e&&wt.test(e)?e.replace(bi,Gp):e}var b_=En(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),gc=Ch("toUpperCase");function xl(e,i,o){return e=it(e),i=o?r:i,i===r?zp(e)?Jp(e):Rp(e):e.match(i)||[]}var Ol=Ke(function(e,i){try{return kt(e,r,i)}catch(o){return lc(o)?o:new Pe(o)}}),m_=li(function(e,i){return Cr(i,function(o){o=Qr(o),ui(e,o,uc(e[o],e))}),e});function w_(e){var i=e==null?0:e.length,o=be();return e=i?_t(e,function(u){if(typeof u[1]!="function")throw new Ar(p);return[o(u[0]),u[1]]}):[],Ke(function(u){for(var d=-1;++d<i;){var y=e[d];if(kt(y[0],this,u))return kt(y[1],this,u)}})}function E_(e){return Gg(Tr(e,N))}function vc(e){return function(){return e}}function D_(e,i){return e==null||e!==e?i:e}var S_=Ph(),I_=Ph(!0);function gr(e){return e}function yc(e){return oh(typeof e=="function"?e:Tr(e,N))}function x_(e){return ch(Tr(e,N))}function O_(e,i){return uh(e,Tr(i,N))}var C_=Ke(function(e,i){return function(o){return Gn(o,e,i)}}),A_=Ke(function(e,i){return function(o){return Gn(e,o,i)}});function _c(e,i,o){var u=Vt(i),d=so(i,u);o==null&&!(mt(i)&&(d.length||!u.length))&&(o=i,i=e,e=this,d=so(i,Vt(i)));var y=!(mt(o)&&"chain"in o)||!!o.chain,S=di(e);return Cr(d,function(A){var $=i[A];e[A]=$,S&&(e.prototype[A]=function(){var Z=this.__chain__;if(y||Z){var Q=e(this.__wrapped__),ie=Q.__actions__=fr(this.__actions__);return ie.push({func:$,args:arguments,thisArg:e}),Q.__chain__=Z,Q}return $.apply(e,Ei([this.value()],arguments))})}),e}function P_(){return Xe._===this&&(Xe._=rg),this}function bc(){}function T_(e){return e=$e(e),Ke(function(i){return hh(i,e)})}var N_=Ja(_t),R_=Ja(Tu),F_=Ja(wa);function Cl(e){return ic(e)?Ea(Qr(e)):h0(e)}function U_(e){return function(i){return e==null?r:Vi(e,i)}}var L_=Nh(),M_=Nh(!0);function mc(){return[]}function wc(){return!1}function $_(){return{}}function j_(){return""}function B_(){return!0}function q_(e,i){if(e=$e(e),e<1||e>k)return[];var o=re,u=Xt(e,re);i=be(i),e-=re;for(var d=Ia(u,i);++o<e;)i(o);return d}function z_(e){return Ne(e)?_t(e,Qr):Er(e)?[e]:fr(Wh(it(e)))}function H_(e){var i=++eg;return it(e)+i}var K_=lo(function(e,i){return e+i},0),k_=Xa("ceil"),V_=lo(function(e,i){return e/i},1),G_=Xa("floor");function W_(e){return e&&e.length?no(e,gr,La):r}function Y_(e,i){return e&&e.length?no(e,be(i,2),La):r}function J_(e){return Fu(e,gr)}function X_(e,i){return Fu(e,be(i,2))}function Z_(e){return e&&e.length?no(e,gr,Ba):r}function Q_(e,i){return e&&e.length?no(e,be(i,2),Ba):r}var eb=lo(function(e,i){return e*i},1),tb=Xa("round"),rb=lo(function(e,i){return e-i},0);function ib(e){return e&&e.length?Sa(e,gr):0}function nb(e,i){return e&&e.length?Sa(e,be(i,2)):0}return v.after=xv,v.ary=sl,v.assign=dy,v.assignIn=bl,v.assignInWith=Io,v.assignWith=py,v.at=gy,v.before=ol,v.bind=uc,v.bindAll=m_,v.bindKey=al,v.castArray=$v,v.chain=rl,v.chunk=G0,v.compact=W0,v.concat=Y0,v.cond=w_,v.conforms=E_,v.constant=vc,v.countBy=iv,v.create=vy,v.curry=cl,v.curryRight=ul,v.debounce=hl,v.defaults=yy,v.defaultsDeep=_y,v.defer=Ov,v.delay=Cv,v.difference=J0,v.differenceBy=X0,v.differenceWith=Z0,v.drop=Q0,v.dropRight=e1,v.dropRightWhile=t1,v.dropWhile=r1,v.fill=i1,v.filter=sv,v.flatMap=cv,v.flatMapDeep=uv,v.flatMapDepth=hv,v.flatten=Zh,v.flattenDeep=n1,v.flattenDepth=s1,v.flip=Av,v.flow=S_,v.flowRight=I_,v.fromPairs=o1,v.functions=Iy,v.functionsIn=xy,v.groupBy=lv,v.initial=c1,v.intersection=u1,v.intersectionBy=h1,v.intersectionWith=l1,v.invert=Cy,v.invertBy=Ay,v.invokeMap=dv,v.iteratee=yc,v.keyBy=pv,v.keys=Vt,v.keysIn=pr,v.map=bo,v.mapKeys=Ty,v.mapValues=Ny,v.matches=x_,v.matchesProperty=O_,v.memoize=wo,v.merge=Ry,v.mergeWith=ml,v.method=C_,v.methodOf=A_,v.mixin=_c,v.negate=Eo,v.nthArg=T_,v.omit=Fy,v.omitBy=Uy,v.once=Pv,v.orderBy=gv,v.over=N_,v.overArgs=Tv,v.overEvery=R_,v.overSome=F_,v.partial=hc,v.partialRight=ll,v.partition=vv,v.pick=Ly,v.pickBy=wl,v.property=Cl,v.propertyOf=U_,v.pull=g1,v.pullAll=el,v.pullAllBy=v1,v.pullAllWith=y1,v.pullAt=_1,v.range=L_,v.rangeRight=M_,v.rearg=Nv,v.reject=bv,v.remove=b1,v.rest=Rv,v.reverse=ac,v.sampleSize=wv,v.set=$y,v.setWith=jy,v.shuffle=Ev,v.slice=m1,v.sortBy=Iv,v.sortedUniq=O1,v.sortedUniqBy=C1,v.split=c_,v.spread=Fv,v.tail=A1,v.take=P1,v.takeRight=T1,v.takeRightWhile=N1,v.takeWhile=R1,v.tap=W1,v.throttle=Uv,v.thru=_o,v.toArray=vl,v.toPairs=El,v.toPairsIn=Dl,v.toPath=z_,v.toPlainObject=_l,v.transform=By,v.unary=Lv,v.union=F1,v.unionBy=U1,v.unionWith=L1,v.uniq=M1,v.uniqBy=$1,v.uniqWith=j1,v.unset=qy,v.unzip=cc,v.unzipWith=tl,v.update=zy,v.updateWith=Hy,v.values=In,v.valuesIn=Ky,v.without=B1,v.words=xl,v.wrap=Mv,v.xor=q1,v.xorBy=z1,v.xorWith=H1,v.zip=K1,v.zipObject=k1,v.zipObjectDeep=V1,v.zipWith=G1,v.entries=El,v.entriesIn=Dl,v.extend=bl,v.extendWith=Io,_c(v,v),v.add=K_,v.attempt=Ol,v.camelCase=Wy,v.capitalize=Sl,v.ceil=k_,v.clamp=ky,v.clone=jv,v.cloneDeep=qv,v.cloneDeepWith=zv,v.cloneWith=Bv,v.conformsTo=Hv,v.deburr=Il,v.defaultTo=D_,v.divide=V_,v.endsWith=Yy,v.eq=Kr,v.escape=Jy,v.escapeRegExp=Xy,v.every=nv,v.find=ov,v.findIndex=Jh,v.findKey=by,v.findLast=av,v.findLastIndex=Xh,v.findLastKey=my,v.floor=G_,v.forEach=il,v.forEachRight=nl,v.forIn=wy,v.forInRight=Ey,v.forOwn=Dy,v.forOwnRight=Sy,v.get=dc,v.gt=Kv,v.gte=kv,v.has=Oy,v.hasIn=pc,v.head=Qh,v.identity=gr,v.includes=fv,v.indexOf=a1,v.inRange=Vy,v.invoke=Py,v.isArguments=Yi,v.isArray=Ne,v.isArrayBuffer=Vv,v.isArrayLike=dr,v.isArrayLikeObject=Tt,v.isBoolean=Gv,v.isBuffer=Ai,v.isDate=Wv,v.isElement=Yv,v.isEmpty=Jv,v.isEqual=Xv,v.isEqualWith=Zv,v.isError=lc,v.isFinite=Qv,v.isFunction=di,v.isInteger=fl,v.isLength=Do,v.isMap=dl,v.isMatch=ey,v.isMatchWith=ty,v.isNaN=ry,v.isNative=iy,v.isNil=sy,v.isNull=ny,v.isNumber=pl,v.isObject=mt,v.isObjectLike=Ot,v.isPlainObject=Qn,v.isRegExp=fc,v.isSafeInteger=oy,v.isSet=gl,v.isString=So,v.isSymbol=Er,v.isTypedArray=Sn,v.isUndefined=ay,v.isWeakMap=cy,v.isWeakSet=uy,v.join=f1,v.kebabCase=Zy,v.last=Rr,v.lastIndexOf=d1,v.lowerCase=Qy,v.lowerFirst=e_,v.lt=hy,v.lte=ly,v.max=W_,v.maxBy=Y_,v.mean=J_,v.meanBy=X_,v.min=Z_,v.minBy=Q_,v.stubArray=mc,v.stubFalse=wc,v.stubObject=$_,v.stubString=j_,v.stubTrue=B_,v.multiply=eb,v.nth=p1,v.noConflict=P_,v.noop=bc,v.now=mo,v.pad=t_,v.padEnd=r_,v.padStart=i_,v.parseInt=n_,v.random=Gy,v.reduce=yv,v.reduceRight=_v,v.repeat=s_,v.replace=o_,v.result=My,v.round=tb,v.runInContext=M,v.sample=mv,v.size=Dv,v.snakeCase=a_,v.some=Sv,v.sortedIndex=w1,v.sortedIndexBy=E1,v.sortedIndexOf=D1,v.sortedLastIndex=S1,v.sortedLastIndexBy=I1,v.sortedLastIndexOf=x1,v.startCase=u_,v.startsWith=h_,v.subtract=rb,v.sum=ib,v.sumBy=nb,v.template=l_,v.times=q_,v.toFinite=pi,v.toInteger=$e,v.toLength=yl,v.toLower=f_,v.toNumber=Fr,v.toSafeInteger=fy,v.toString=it,v.toUpper=d_,v.trim=p_,v.trimEnd=g_,v.trimStart=v_,v.truncate=y_,v.unescape=__,v.uniqueId=H_,v.upperCase=b_,v.upperFirst=gc,v.each=il,v.eachRight=nl,v.first=Qh,_c(v,function(){var e={};return Xr(v,function(i,o){nt.call(v.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),v.VERSION=s,Cr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){v[e].placeholder=v}),Cr(["drop","take"],function(e,i){Ye.prototype[e]=function(o){o=o===r?1:Kt($e(o),0);var u=this.__filtered__&&!i?new Ye(this):this.clone();return u.__filtered__?u.__takeCount__=Xt(o,u.__takeCount__):u.__views__.push({size:Xt(o,re),type:e+(u.__dir__<0?"Right":"")}),u},Ye.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),Cr(["filter","map","takeWhile"],function(e,i){var o=i+1,u=o==b||o==ee;Ye.prototype[e]=function(d){var y=this.clone();return y.__iteratees__.push({iteratee:be(d,3),type:o}),y.__filtered__=y.__filtered__||u,y}}),Cr(["head","last"],function(e,i){var o="take"+(i?"Right":"");Ye.prototype[e]=function(){return this[o](1).value()[0]}}),Cr(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Ye.prototype[e]=function(){return this.__filtered__?new Ye(this):this[o](1)}}),Ye.prototype.compact=function(){return this.filter(gr)},Ye.prototype.find=function(e){return this.filter(e).head()},Ye.prototype.findLast=function(e){return this.reverse().find(e)},Ye.prototype.invokeMap=Ke(function(e,i){return typeof e=="function"?new Ye(this):this.map(function(o){return Gn(o,e,i)})}),Ye.prototype.reject=function(e){return this.filter(Eo(be(e)))},Ye.prototype.slice=function(e,i){e=$e(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Ye(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=$e(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Ye.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ye.prototype.toArray=function(){return this.take(re)},Xr(Ye.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),d=v[u?"take"+(i=="last"?"Right":""):i],y=u||/^find/.test(i);d&&(v.prototype[i]=function(){var S=this.__wrapped__,A=u?[1]:arguments,$=S instanceof Ye,Z=A[0],Q=$||Ne(S),ie=function(Ge){var Ze=d.apply(v,Ei([Ge],A));return u&&ue?Ze[0]:Ze};Q&&o&&typeof Z=="function"&&Z.length!=1&&($=Q=!1);var ue=this.__chain__,ve=!!this.__actions__.length,Ee=y&&!ue,qe=$&&!ve;if(!y&&Q){S=qe?S:new Ye(this);var De=e.apply(S,A);return De.__actions__.push({func:_o,args:[ie],thisArg:r}),new Pr(De,ue)}return Ee&&qe?e.apply(this,A):(De=this.thru(ie),Ee?u?De.value()[0]:De.value():De)})}),Cr(["pop","push","shift","sort","splice","unshift"],function(e){var i=Hs[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);v.prototype[e]=function(){var d=arguments;if(u&&!this.__chain__){var y=this.value();return i.apply(Ne(y)?y:[],d)}return this[o](function(S){return i.apply(Ne(S)?S:[],d)})}}),Xr(Ye.prototype,function(e,i){var o=v[i];if(o){var u=o.name+"";nt.call(bn,u)||(bn[u]=[]),bn[u].push({name:i,func:o})}}),bn[ho(r,se).name]=[{name:"wrapper",func:r}],Ye.prototype.clone=_g,Ye.prototype.reverse=bg,Ye.prototype.value=mg,v.prototype.at=Y1,v.prototype.chain=J1,v.prototype.commit=X1,v.prototype.next=Z1,v.prototype.plant=ev,v.prototype.reverse=tv,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=rv,v.prototype.first=v.prototype.head,Bn&&(v.prototype[Bn]=Q1),v},vn=Xp();Pt?((Pt.exports=vn)._=vn,ct._=vn):Xe._=vn}).call(ls)})(ru,ru.exports);var V2=Object.defineProperty,G2=Object.defineProperties,W2=Object.getOwnPropertyDescriptors,nd=Object.getOwnPropertySymbols,Y2=Object.prototype.hasOwnProperty,J2=Object.prototype.propertyIsEnumerable,sd=(n,t,r)=>t in n?V2(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Oo=(n,t)=>{for(var r in t||(t={}))Y2.call(t,r)&&sd(n,r,t[r]);if(nd)for(var r of nd(t))J2.call(t,r)&&sd(n,r,t[r]);return n},X2=(n,t)=>G2(n,W2(t));function Mr(n,t,r){let s;const a=iu(n);return t.rpcMap&&(s=t.rpcMap[a]),s||(s=`${k2}?chainId=eip155:${a}&projectId=${r}`),s}function iu(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function xp(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function Z2(n,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const l=t.namespaces[a].accounts;s.push(...l)}),s}function Q2(n={},t={}){const r=od(n),s=od(t);return ru.exports.merge(r,s)}function od(n){var t,r,s,a;const l={};if(!Pn(n))return l;for(const[p,f]of Object.entries(n)){const g=_u(p)?[p]:f.chains,E=f.methods||[],I=f.events||[],N=f.rpcMap||{},j=Po(p);l[j]=X2(Oo(Oo({},l[j]),f),{chains:Oc(g,(t=l[j])==null?void 0:t.chains),methods:Oc(E,(r=l[j])==null?void 0:r.methods),events:Oc(I,(s=l[j])==null?void 0:s.events),rpcMap:Oo(Oo({},N),(a=l[j])==null?void 0:a.rpcMap)})}return l}function e5(n){return n.includes(":")?n.split(":")[2]:n}function t5(n){const t={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],l=s.events||[],p=s.accounts||[],f=_u(r)?[r]:s.chains?s.chains:xp(s.accounts);t[r]={chains:f,methods:a,events:l,accounts:p}}return t}const Op={},Ft=n=>Op[n],jc=(n,t)=>{Op[n]=t};class r5{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Mr(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Mr(t,this.namespace);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}}class i5{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){const s=iu(t);if(!this.httpProviders[s]){const a=r||Mr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.chainId=s,this.events.emit(Ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Mr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=iu(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const l=parseInt(a,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class n5{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Mr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Mr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}}class s5{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Mr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Mr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}}class o5{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(Ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);t[r]=this.createHttpProvider(r,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}}class a5{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Mr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Mr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}}class c5{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(!this.httpProviders[t]){const s=r||Mr(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(Ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Mr(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}}var u5=Object.defineProperty,h5=Object.defineProperties,l5=Object.getOwnPropertyDescriptors,ad=Object.getOwnPropertySymbols,f5=Object.prototype.hasOwnProperty,d5=Object.prototype.propertyIsEnumerable,cd=(n,t,r)=>t in n?u5(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Co=(n,t)=>{for(var r in t||(t={}))f5.call(t,r)&&cd(n,r,t[r]);if(ad)for(var r of ad(t))d5.call(t,r)&&cd(n,r,t[r]);return n},Bc=(n,t)=>h5(n,l5(t));class Au{constructor(t){this.events=new ou,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Qe.pino(Qe.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||rd})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Au(t);return await r.initialize(),r}async request(t,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Co({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Rt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(l=>{this.session=l,this.namespaces||(this.namespaces=t5(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==Sp)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(ii(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await $2.init({logger:this.providerOpts.logger||rd,relayUrl:this.providerOpts.relayUrl||z2,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Po(r)))];jc("client",this.client),jc("events",this.events),jc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=Z2(r,this.session),a=xp(s),l=Q2(this.namespaces,this.optionalNamespaces),p=Bc(Co({},l[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new i5({namespace:p});break;case"solana":this.rpcProviders[r]=new n5({namespace:p});break;case"cosmos":this.rpcProviders[r]=new s5({namespace:p});break;case"polkadot":this.rpcProviders[r]=new r5({namespace:p});break;case"cip34":this.rpcProviders[r]=new o5({namespace:p});break;case"elrond":this.rpcProviders[r]=new a5({namespace:p});break;case"multiversx":this.rpcProviders[r]=new c5({namespace:p});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&ii(a)&&this.events.emit("accountsChanged",a.map(e5))}else s.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:a}=r,l=(s=this.client)==null?void 0:s.session.get(t);this.session=Bc(Co({},l),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Bc(Co({},Rt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Ui.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(p=>Po(p)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=Po(Object.keys(this.namespaces)[0]),l=this.rpcProviders[a].getDefaultChain();return[a,l]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[a,l]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(l),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${id}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${id}/${t}`)}}const p5=Au,g5="wc",v5="ethereum_provider",y5=`${g5}@2:${v5}:`,_5="https://rpc.walletconnect.com/v1/",nu=["eth_sendTransaction","personal_sign"],b5=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],su=["chainChanged","accountsChanged"],m5=["message","disconnect","connect"];var w5=Object.defineProperty,E5=Object.defineProperties,D5=Object.getOwnPropertyDescriptors,ud=Object.getOwnPropertySymbols,S5=Object.prototype.hasOwnProperty,I5=Object.prototype.propertyIsEnumerable,hd=(n,t,r)=>t in n?w5(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,fs=(n,t)=>{for(var r in t||(t={}))S5.call(t,r)&&hd(n,r,t[r]);if(ud)for(var r of ud(t))I5.call(t,r)&&hd(n,r,t[r]);return n},ld=(n,t)=>E5(n,D5(t));function jo(n){return Number(n[0].split(":")[1])}function qc(n){return`0x${n.toString(16)}`}function x5(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:a,events:l,optionalEvents:p,rpcMap:f}=n;if(!ii(t))throw new Error("Invalid chains");const g={chains:t,methods:s||nu,events:l||su,rpcMap:fs({},t.length?{[jo(t)]:f[jo(t)]}:{})},E=l==null?void 0:l.filter(R=>!su.includes(R)),I=s==null?void 0:s.filter(R=>!nu.includes(R));if(!r&&!p&&!a&&!(E!=null&&E.length)&&!(I!=null&&I.length))return{required:t.length?g:void 0};const N=(E==null?void 0:E.length)&&(I==null?void 0:I.length)||!r,j={chains:[...new Set(N?g.chains.concat(r||[]):r)],methods:[...new Set(g.methods.concat(a!=null&&a.length?a:b5))],events:[...new Set(g.events.concat(p||m5))],rpcMap:f};return{required:t.length?g:void 0,optional:r.length?j:void 0}}class Pu{constructor(){this.events=new $r.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=y5,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Pu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=x5(this.rpc);try{const a=await new Promise(async(p,f)=>{var g;this.rpc.showQrModal&&((g=this.modal)==null||g.subscribeModal(E=>{!E.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(ld(fs({namespaces:fs({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(E=>{p(E)}).catch(E=>{f(new Error(E.message))})});if(!a)return;this.setChainIds(this.rpc.chains);const l=Pw(a.namespaces,[this.namespace]);this.setAccounts(l),this.events.emit("connect",{chainId:qc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",qc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",ld(fs({},Rt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",qc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,a]=t.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const a=(r=t==null?void 0:t.chains)!=null?r:[],l=(s=t==null?void 0:t.optionalChains)!=null?s:[],p=a.concat(l);if(!p.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=a.length?(t==null?void 0:t.methods)||nu:[],g=a.length?(t==null?void 0:t.events)||su:[],E=(t==null?void 0:t.optionalMethods)||[],I=(t==null?void 0:t.optionalEvents)||[],N=(t==null?void 0:t.rpcMap)||this.buildRpcMap(p,t.projectId),j=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(R=>this.formatChainId(R)),optionalChains:l.map(R=>this.formatChainId(R)),methods:f,events:g,optionalMethods:E,optionalEvents:I,rpcMap:N,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:j,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?jo(this.rpc.chains):jo(this.rpc.optionalChains),this.signer=await p5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await ob(()=>import("./index-245ec7f8.js").then(a=>a.i),["assets/index-245ec7f8.js","assets/index-7f456532.js","assets/index-d7b7333f.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(fs({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:a}=t;r&&ii(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)})),s&&ii(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(l=>this.formatChainId(l)),s.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${_5}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const M5=Pu;export{M5 as EthereumProvider,m5 as OPTIONAL_EVENTS,b5 as OPTIONAL_METHODS,su as REQUIRED_EVENTS,nu as REQUIRED_METHODS,Pu as default};
